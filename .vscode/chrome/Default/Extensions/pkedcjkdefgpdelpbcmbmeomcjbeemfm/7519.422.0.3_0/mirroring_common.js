'use strict';var ei;var fi=chrome.i18n.getMessage("545449835455981095");w("mr.IssueSeverity",{Yt:"fatal",Ty:"warning",ew:"notification"});w("mr.IssueAction",{Lt:"dismiss",lv:"learn_more"});
var gi=function(a,c){this.sinkId=this.routeId=null;this.severity=c;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},ii=function(){var a=new gi(hi,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},ji=function(a){a.isBlocking=!0;return a},ki=function(a,c){a.routeId=c;return a},li=function(a,c){a.sinkId=c;return a};var mi=function(a,c){var b=this;this.f=void 0===c?null:c;this.b=new Promise(function(d,e){var f=function(g){b.f=null;e(g)};b.g=f;a(function(g){b.f=null;d(g)},f)})};mi.prototype.cancel=function(a){this.g(a);if(this.f){var c=this.f;this.f=null;setTimeout(function(){return c(a)},0)}};var ni=function(a,c,b){b=void 0===b?null:b;return new mi(function(d,e){a.b.then(function(f){if(c)try{d(c(f))}catch(g){e(g)}else d(f)},function(f){if(b)try{d(b(f))}catch(g){e(g)}else e(f)})},function(d){a.cancel(d)})};
mi.prototype.then=function(a,c){return ni(this,a,void 0===c?null:c)};mi.prototype.catch=function(a){return ni(this,null,a)};var oi=function(a){return new mi(function(c){c(a)})},pi=function(a){return new mi(function(c,b){b(a)})},qi=function(a){return new mi(function(c,b){a.then(c,b)})},ri=function(a,c){var b=!1,d=null;return new mi(function(e,f){a.then(function(g){b||(d=c(g),d.b.then(e,f))},f)},function(e){d?d.cancel(e):b=!0})};var si={Ws:0,Us:1,Ys:2,Vs:3,ys:4,Xs:5,Fu:6,uy:7,Gt:8,lo:9},ti=function(a,c){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=c&&9>=c?c:9};q(ti,Error);var vi=function(){var a=l(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},wi=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var xi=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=wi()),yi=["ChromeOS","Windows"].includes(wi());var zi=function(a,c,b,d){this.f=a;this.b=c;this.g=b||null;this.presentationId=d||null},Ci=function(a,c){if("tab"==a.f)a=Ai(a);else if("offscreen_tab"==a.f)c=Ai(a),c.presentationId=a.presentationId,a=c;else{var b={audio:!1,video:!1};a.b.shouldCaptureVideo?(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}},Bi(a,b.video.mandatory),yi&&a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:c}})):a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system"}});
a=b}return a},Ai=function(a){var c={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(c.videoConstraints={mandatory:{enableAutoThrottling:!0}},Bi(a,c.videoConstraints.mandatory));return c},Bi=function(a,c){var b=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){b=a.b;if(0==b.minHeight||0==b.maxHeight?0:Math.floor(100*b.minWidth/b.minHeight)==Math.floor(100*b.maxWidth/b.maxHeight))b={width:b.minWidth,height:b.minHeight};else{d=b.maxWidth;for(var e=b.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=b.maxWidth/d;d=b.maxHeight/d;if(e<b.minWidth||d<b.minHeight)if(f=Math.max(b.minWidth/e,b.minHeight/d),e*=f,d*=f,e>b.maxWidth||d>b.maxHeight)e=b.maxWidth,d=b.maxHeight;e=Math.round(e);d=Math.round(d);b={width:e,height:d}}d=b;b=d.width;d=d.height}Object.assign(c,{minWidth:b,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var Di=function(a){this.b=a;this.f=this.If=null;this.l=hb("mr.mirror.MirrorMediaStream")};Di.prototype.start=function(){return"tab"==this.b.f?Ei(this):"offscreen_tab"==this.b.f?Fi(this):Gi(this)};var Ei=function(a){var c=Ci(a.b);a.l.info("Starting tab capture with constraints "+JSON.stringify(c));return new Promise(function(b,d){chrome.tabCapture.capture(c,function(e){e?(Hi(a,e),b(a)):d(Ii())});window.setTimeout(function(){d(new ti("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Di.prototype.g=function(a){a&&this.l.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var Ii=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new ti(chrome.runtime.lastError.message,7):new ti("empty_stream",0)},Ji=function(a){var c=void 0===c?6E4:c;return new Promise(function(b,d){var e=["screen","audio"];"Linux"==wi()&&e.push("window");var f=window.setTimeout(function(){g&&chrome.desktopCapture.cancelChooseDesktopMedia(g);d(new ti("timeout",1))},c);var g=chrome.desktopCapture.chooseDesktopMedia(e,a||null,function(k){window.clearTimeout(f);k?b(k):d(new ti("User cancelled capture dialog",
3))})})},Ki=function(a,c){return new Promise(function(b,d){a.l.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});navigator.mediaDevices.getUserMedia(c).then(function(e){e||d(new ti("empty_stream",8));Hi(a,e);b(e)},function(e){var f=8;"NotAllowedError"==e.name&&(f=3);d(new ti(e.name+" "+e.constraintName+": "+e.message,f))})})},Gi=function(a){return yi&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?Ki(a,Ci(a.b)).then(function(){return a}):Ji().then(function(c){c=
Ci(a.b,c);return Ki(a,c).then(function(){return a})})},Fi=function(a){var c=Ci(a.b);a.l.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(c)});return new Promise(function(b,d){chrome.tabCapture.captureOffscreenTab(a.b.g.toString(),c,function(e){e?(Hi(a,e),b(a)):d(Ii())})})},Hi=function(a,c){a.f=c;c.getAudioTracks().length||c.getVideoTracks();c.getTracks().forEach(function(b){b.onended=a.g.bind(a)})};
Di.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.If&&this.If())};var Li=function(){},Pi=function(a){var c=Mi.get(a)||null;if(c)return Promise.resolve(c);c=Ni.get(a);c||(c=new Db,Ni.set(a,c),Oi(a,c));return c.b},Oi=function(a,c){var b=Qi.get(a)||null;if(!b)c.reject(Error("No corresponding bundle for "+a));else if(!Ri.has(b)){var d=Si.get(b);d||(Ti.info("Loading bundle "+b+" for module "+a),d=Ui(b),Si.set(b,d));d.catch(function(e){c.reject(e)})}},Ui=function(a){var c=new Db;c.b.then(function(){Ti.info("Bundle "+a+" loaded")},function(d){Ti.error("Failed to load bundle "+
a);throw d;});var b=document.createElement("script");b.src=chrome.extension.getURL(a);b.setAttribute("type","text/javascript");b.async=!0;b.onload=function(){return c.resolve(void 0)};b.onerror=function(){return c.reject(Error("Failed to load bundle "+a))};document.head.appendChild(b);return c.b},Vi=function(a,c){if(Mi.has(a))throw Error("Duplicate module "+a);Mi.set(a,c);(a=Ni.get(a))&&a.resolve(c)};
Li.prototype.handleEvent=function(a,c){for(var b=1;b<arguments.length;++b);throw Error("Not implemented");};
var Qi=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),Ri=new Set(["background_script.js"]),Ti=hb("mr.Module"),Mi=new Map,Ni=new Map,Si=new Map;var Wi,Xi={uv:0,Zs:1,at:2,Ht:3,It:4,ku:5,Hu:6,sv:7,Uv:8,Vv:9,fx:10,Px:11,Qx:12,fy:13,ty:14},Yi=function(a){void 0==Wi&&(Cb("MediaRouter.Provider.WakeEvent",a,Xi),Wi=a)};var aj=function(a){return Zi(a)||$i(a)},bj=function(a){try{var c=new URL(a);return"http:"!=c.protocol&&"https:"!=c.protocol?!1:-1==c.hash.indexOf("__castAppId__")}catch(b){return!1}},cj=["https://docs.google.com"],Zi=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},$i=function(a){return"urn:x-org.chromium.media:source:desktop"==a},dj=function(a){var c=a.search("urn:x-org.chromium.media:source:tab:");return-1==c?null:parseInt(a.substr(c+36),10)||null};var ej=function(a,c){this.ga=a;this.g=c||null;this.f=this.b=null;this.O=hb("mr.mirror.Service."+a);this.T=this.ca.bind(this);this.D=!1};q(ej,Li);h=ej.prototype;h.initialize=function(a,c){this.D||(this.g=a,this.D=!0,this.lg(c))};h.lg=function(){};h.getName=function(){return this.ga};
h.cj=function(a,c,b,d,e){var f=this;this.O.info("Start mirroring on route "+a.id);if(!this.D)return pi(Error("Not initialized"));var g=new Promise(function(k,m){f.w().then(function(){var p=fj(c,b,d);return(new Di(p)).start()}).then(function(p){if(f.f)throw p.stop(),new ti("Cannot start multiple streams");f.f=p;p=f.C.bind(f);f.f.If=p;return e?e(a).b:a}).then(function(p){if(f.b)throw new ti("Cannot start multiple sessions");if(!f.f)throw new ti("Media stream ended before session could start.");f.b=
f.kh(b,p);p.nb.lc=f.b.lc;p=f.g.Ci.bind(f.g);f.b.H=p;gj(f.b);return f.b.start(f.f.f)}).then(function(){Zi(c)&&!chrome.tabs.onUpdated.hasListener(f.T)&&chrome.tabs.onUpdated.addListener(f.T);return f.Za(a,c,b)}).then(function(){k(a)}).catch(function(p){hj(f,p);return f.C().then(function(){m(p)})})});return qi(g)};h.dj=function(a,c,b,d,e,f){this.O.info("Update mirroring on route "+a.id);return this.D?qi(ij(this,a,c,b,d,f)):pi(Error("Not initialized"))};
var ij=function(a,c,b,d,e,f){if(!a.b)return Promise.reject(new ti("No session to update streams on",7));if(!a.b.Cm())return Promise.reject(new ti("Session does not support updating stream",7));var g=!1;return new Promise(function(k,m){var p=fj(b,d,e);(new Di(p)).start().then(function(v){a.f&&(a.f.If=null,a.f.stop(),a.Mg());a.f=v;v=a.C.bind(a);a.f.If=v;g=!0;return f?f(c).b:c}).then(function(){if(!a.b)throw new ti("Session ended while updating stream");if(!a.f)throw new ti("Media stream ended before session could be updated.");
return a.b.Jm(a.f.f)}).then(a.Za.bind(a,c,b,d)).then(function(){return k(c)}).catch(function(v){hj(a,v);if(g)return a.C().then(function(){m(v)});m(v)})})};
ej.prototype.Za=function(a,c,b){var d=this;return new Promise(function(e,f){if(d.b){Zi(c)?(jj(d.b,a.nb.tabId),d.Ng()):bj(c)?(jj(d.b,a.nb.tabId),d.Lh()):d.Kg();f=d.f;var g=a.sinkId;b.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.g.Ke(li(new gi(fi,"notification"),g));gj(d.b);e()}else f(new ti("Session gone before executing post-startup steps",7))})};
var hj=function(a,c){c.reason=null!=c.reason?c.reason:9;a.O.error("Failed to start mirroring: "+c.message+(",  reason = "+c.reason+": "+c.stack));a.Kh(c.reason)};ej.prototype.w=function(){var a=this;return this.D?this.C().then(function(c){c&&a.Lg();return c}):Promise.reject("Not initialized")};
ej.prototype.C=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.T);var c=this.f;this.f=null;c&&(c.If=null);var b=this.b;this.b=null;var d;b?d=this.hi(b).catch(function(e){return a.O.error("Error in before-cleanup steps",e)}).then(function(){return b.stop()}).catch(function(e){return a.O.error("Error stopping session",e)}).then(function(){a.g.Hh(b.f.id)}).catch(function(e){return a.O.error("Error in ended callbacks",e)}).then(function(){return!0}):d=Promise.resolve(!1);c&&(d=d.then(function(e){c.stop();
a.Mg();return e}));return d};ej.prototype.hi=function(){return Promise.resolve()};ej.prototype.ca=function(a,c,b){Yi(14);this.b&&kj(this.b,a,c,b)};var fj=function(a,c,b){if(Zi(a))return new zi("tab",c);if($i(a))return new zi("desktop",c);if(bj(a)){if(!b)throw new ti("Missing offscreen tab presentation id");return new zi("offscreen_tab",c,a,b)}throw new ti("Source URN does not suggest a known capture type.");};h=ej.prototype;h.kh=function(){};h.Ng=function(){};h.Kg=function(){};h.Lh=function(){};
h.Lg=function(){};h.Kh=function(){};h.Mg=function(){};h.bj=function(){return eb()};h.createMediaRouteController=function(){return eb()};var lj=function(a,c,b){this.f=a;this.h=c;this.b=void 0===b?null:b;this.g=null},mj=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},nj=function(a){if(a.h)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var oj=function(a){return(new Promise(function(c){chrome.tabs.get(a,c)})).then(function(c){if(!c)throw Error("No such tab "+a);return c})};var pj=function(a,c){this.f=a;this.H=void 0===c?null:c;c=null;var b=a.mediaSource;if(bj(b)){var d="presentation";c=(new URL(b)).origin}else Zi(b)?d="mirror_tab":$i(b)&&(d="mirror_desktop");this.lc=new lj(d,a.offTheRecord,c);this.j=this.tabId=null;this.F=!1},jj=function(a,c){a.tabId!=c?(a.tabId=c,oj(c).then(function(b){a.j=b;gj(a)})):Promise.resolve()},kj=function(a,c,b,d){c==a.tabId&&("complete"==b.status||b.favIconUrl&&"complete"==d.status)&&(a.j=d,gj(a))},gj=function(a){if(a.j){a.lc.g=a.j.title;
a.lc.h=a.j.incognito;var c=new URL(a.j.url);"file:"==c.protocol?(a.lc.f="mirror_file",a.lc.b=null):(a.lc.f=a.F?"media_remoting":"mirror_tab",a.lc.b="https:"==c.protocol?c.origin.substr(8):c.origin)}a.f.description=mj(a.lc);a.H&&a.H(a.f,a.lc);a.mm()};h=pj.prototype;h.start=function(){};h.Cm=function(){return!1};h.Jm=function(){};h.stop=function(){return Promise.resolve()};h.mm=function(){};var tj=function(){var a=this;this.f=1920;this.b=1080;this.maxWidth=this.f;this.maxHeight=this.b;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.animatedLatencyMillis=this.minLatencyMillis=this.maxLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(wi())||vi();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var c=
window.localStorage?window.localStorage.getItem(qj):null;if(c)try{var b=JSON.parse(String(c));if(b instanceof Object)rj(this,b),hb("mr.mirror.Settings").G(function(){return"Initial mr.mirror.Settings overridden to: "+sj(a)});else throw Error("localStorage["+qj+"] "+("does not parse as an Object: "+c));}catch(d){throw hb("mr.mirror.Settings").error(qj+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
tj.prototype.clone=function(){var a=new tj;rj(a,this);return a};
var sj=function(a){return JSON.stringify(a,function(c,b){if(0==c.length||!c.endsWith("_"))return b})},rj=function(a,c){for(var b=l(Object.keys(c)),d=b.next();!d.done;d=b.next())d=d.value,d.endsWith("_")||typeof c[d]!==typeof a[d]||(a[d]=c[d])},uj=function(a){var c=Math.round(screen.width*window.devicePixelRatio),b=Math.round(screen.height*window.devicePixelRatio);b>c&&(b=l([b,c]),c=b.next().value,b=b.next().value);a.maxHeight*c<a.maxWidth*b?(c=Math.min(a.maxWidth,c),c-=c%160,b=90*c/160):(b=Math.min(a.maxHeight,
b),b-=b%90,c=160*b/90);if(c<Math.max(160,a.minWidth)||b<Math.max(90,a.minHeight))c=Math.max(160,a.minWidth),b=Math.max(90,a.minHeight);a.maxWidth=c;a.maxHeight=b},qj="mr.mirror.Settings.Overrides";var vj=function(a,c){this.type=a;this.data=c},wj=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new vj(a.type,a.data)},xj=function(a,c,b,d,e){this.description=a;this.settings=c||null;this.mediaConstraints=b||null;this.presentationUrl=d||null;this.presentationId=e||null};var Aj=function(a,c){this.l=hb("cv2.PeerConnection");this.H=yj;this.ia=zj(this,c);this.h=this.ia.createDataChannel(a,{reliable:!1});this.F=new Db;this.m=!1;this.g=0;this.f=null;this.o=this.j=0;this.b=!1;this.C=function(){};this.w=function(){};this.D=function(){};this.u=function(){}},Bj=function(a,c){a.w=c},Cj=function(a,c){a.D=c},Dj=function(a,c){a.u=c},Ej=function(a,c){a.C=c},Fj=function(a,c){a.h.onmessage=function(b){c(b.data)}},Gj=function(a){var c={};c.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return c},zj=function(a,c){var b=Gj(c);c=new webkitRTCPeerConnection(b);c.onicecandidate=a.J.bind(a);c.onicegatheringstatechange=a.T.bind(a);c.oniceconnectionstatechange=a.R.bind(a);a.l.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return c};Aj.prototype.start=function(){this.b||(this.b=!0,Hj(this))};Aj.prototype.stop=function(){this.l.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.ia.signalingState&&this.ia.close());this.ia=null};
var Hj=function(a){a.l.info("Sending offer to peer.");a.j=Date.now();a.ia.createOffer(a.N.bind(a),function(c){a.l.G("Error creating offer.",c)},a.H);a.F.b.then(function(c){a.C(c)})};Aj.prototype.N=function(a){var c=this;this.l.info(function(){return"Setting local description: "+JSON.stringify(a)});this.ia.setLocalDescription(a,function(){c.l.info("Local description set successfully")},function(b){c.l.G("Error setting local description.",b)})};
var Ij=function(a,c){ob(a.l,function(){return"<===: "+JSON.stringify(c)});var b=new RTCSessionDescription(c);a.l.info(function(){return"Setting remote description: "+JSON.stringify(b)});a.ia.setRemoteDescription(b,function(){a.l.info("Remote description set successfully.")},function(d){a.l.G("Error setting remote description.",d)})};
Aj.prototype.J=function(a){var c=this;a.candidate?(this.g++,this.o=Date.now(),1==this.g?this.f=setTimeout(function(){c.l.info("ICE candidate gathering timed out.");c.f=null;Jj(c)},5E3):this.m&&this.l.G("Received ICE candidate after resolving session description.")):(this.l.info("End of ICE candidates."),ub("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.j),Jj(this),0<this.g&&ub("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.o-this.j))};
Aj.prototype.T=function(){"completed"==this.ia.iceGatheringState&&Jj(this)};var Jj=function(a){clearTimeout(a.f);a.f=null;if(!a.m){a.l.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var c=a.ia.localDescription;a.F.resolve({type:c.type,sdp:c.sdp});a.m=!0}};
Aj.prototype.R=function(a){var c=this;if(this.ia){var b=this.ia.iceConnectionState;this.l.info("New ICE connection state: "+b+".");"connected"==b?this.w("iceconnected"):"completed"==b?this.w("icecompleted"):"failed"==b?(this.l.G(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.D("icefailed")):"closed"==b?this.u("iceclosed"):"disconnected"==b&&(this.l.G("Ice connection state is bad."),this.b&&(this.l.info("Restarting ICE."),this.ia.createOffer(this.N.bind(this),function(d){c.l.G("Error creating new offer.",
d)},Kj)))}};var yj={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Kj={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var Lj=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Nb(a,function(c){c=c.toString(16);return 1<c.length?c:"0"+c}).join("")},Mj=function(a){for(var c=[],b=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?c[b++]=e:(2048>e?c[b++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),c[b++]=e>>18|240,c[b++]=e>>12&63|128):c[b++]=e>>12|224,c[b++]=e>>6&63|128),c[b++]=e&63|128)}return c},Nj=function(a){for(var c=
[],b=0,d=0;b<a.length;){var e=a[b++];if(128>e)c[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[b++];c[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[b++];var g=a[b++],k=a[b++];e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;c[d++]=String.fromCharCode(55296+(e>>10));c[d++]=String.fromCharCode(56320+(e&1023))}else f=a[b++],g=a[b++],c[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return c.join("")};var Oj=null,Pj=null,Rj=function(a){Qj();for(var c=Oj,b=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,p=e>>2;e=(e&3)<<4|g>>4;g=(g&15)<<2|m>>6;m&=63;k||(m=64,f||(g=64));b.push(c[p],c[e],c[g],c[m])}return b.join("")},Tj=function(a){var c=a.length,b=0;"="===a[c-2]?b=2:"="===a[c-1]&&(b=1);var d=new Uint8Array(Math.ceil(3*c/4)-b),e=0;Sj(a,function(f){d[e++]=f});return d.subarray(0,e)},Sj=function(a,c){function b(m){for(;d<a.length;){var p=a.charAt(d++),v=Pj[p];
if(null!=v)return v;if(!jd(p))throw Error("Unknown base64 encoding at char: "+p);}return m}Qj();for(var d=0;;){var e=b(-1),f=b(0),g=b(64),k=b(64);if(64===k&&-1===e)break;c(e<<2|f>>4);64!=g&&(c(f<<4&240|g>>2),64!=k&&c(g<<6&192|k))}},Qj=function(){if(!Oj){Oj={};Pj={};for(var a=0;65>a;a++)Oj[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Pj[Oj[a]]=a,62<=a&&(Pj["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var Uj=0,Vj=0,Wj=function(a){var c=0>a;a=Math.abs(a);var b=a>>>0;a=Math.floor((a-b)/4294967296);a>>>=0;c&&(a=~a>>>0,b=(~b>>>0)+1,4294967295<b&&(b=0,a++,4294967295<a&&(a=0)));Uj=b;Vj=a},Xj=function(a){var c=0>a?1:0;a=c?-a:a;if(0===a)0<1/a?Uj=Vj=0:(Vj=0,Uj=2147483648);else if(isNaN(a))Vj=0,Uj=2147483647;else if(3.4028234663852886E38<a)Vj=0,Uj=(c<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),Vj=0,Uj=(c<<31|a)>>>0;else{var b=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-b);a=Math.round(8388608*a)&8388607;Vj=0;Uj=(c<<31|b+127<<23|a)>>>0}},Yj="0123456789abcdef".split(""),Zj=function(a,c){function b(k){for(var m=1E7,p=0;7>p;p++){m/=10;var v=k/m%10>>>0;if(0!=v||f)f=!0,g+=e[v]}}if(2097151>=c)return""+(4294967296*c+a);var d=(a>>>24|c<<8)>>>0&16777215;c=c>>16&65535;a=(a&16777215)+6777216*d+6710656*c;d+=8147497*c;c*=2;1E7<=a&&(d+=Math.floor(a/1E7),a%=1E7);1E7<=d&&(c+=Math.floor(d/1E7),d%=1E7);var e=Yj,f=!1,g="";(c||f)&&b(c);(d||f)&&b(d);(a||f)&&b(a);return g},
ak=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return Tj(a);Hb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var ck=function(a,c,b){this.f=null;this.m=this.o=this.b=this.g=this.j=0;this.u=!1;a&&bk(this,a,c,b)},dk=[],ek=function(a,c,b){if(dk.length){var d=dk.pop();a&&bk(d,a,c,b);return d}return new ck(a,c,b)};ck.prototype.clone=function(){return ek(this.f,this.j,this.g-this.j)};ck.prototype.clear=function(){this.f=null;this.b=this.g=this.j=0;this.u=!1};var bk=function(a,c,b,d){a.f=ak(c);a.j=Ia(b)?b:0;a.g=Ia(d)?a.j+d:a.f.length;a.b=a.j};ck.prototype.reset=function(){this.b=this.j};
var fk=function(a){for(var c,b=0,d,e=0;4>e;e++)if(c=a.f[a.b++],b|=(c&127)<<7*e,128>c){a.o=b>>>0;a.m=0;return}c=a.f[a.b++];b|=(c&127)<<28;d=0|(c&127)>>4;if(128>c)a.o=b>>>0,a.m=d>>>0;else{for(e=0;5>e;e++)if(c=a.f[a.b++],d|=(c&127)<<7*e+3,128>c){a.o=b>>>0;a.m=d>>>0;return}Hb("Failed to read varint, encoding is invalid.");a.u=!0}};
ck.prototype.h=function(){var a=this.f;var c=a[this.b+0];var b=c&127;if(128>c)return this.b+=1,b;c=a[this.b+1];b|=(c&127)<<7;if(128>c)return this.b+=2,b;c=a[this.b+2];b|=(c&127)<<14;if(128>c)return this.b+=3,b;c=a[this.b+3];b|=(c&127)<<21;if(128>c)return this.b+=4,b;c=a[this.b+4];b|=(c&15)<<28;if(128>c)return this.b+=5,b>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return b};ck.prototype.w=ck.prototype.h;
var gk=function(a){fk(a);return 4294967296*a.m+a.o},hk=function(a){fk(a);var c=a.o,b=a.m;if(a=b&2147483648)c=~c+1>>>0,b=~b>>>0,0==c&&(b=b+1>>>0);c=4294967296*b+c;return a?-c:c},ik=function(a){var c=a.f[a.b+0];var b=a.f[a.b+1];var d=a.f[a.b+2],e=a.f[a.b+3];a.b+=4;b=(c<<0|b<<8|d<<16|e<<24)>>>0;a=2*(b>>31)+1;c=b>>>23&255;b&=8388607;return 255==c?b?NaN:Infinity*a:0==c?a*Math.pow(2,-149)*b:a*Math.pow(2,c-150)*(b+Math.pow(2,23))};ck.prototype.D=function(){return this.w()};var jk=function(a){this.b=ek(a,void 0,void 0);this.w=this.b.b;this.h=this.f=-1;this.j=!1},kk=function(a){return 4==a.h};jk.prototype.reset=function(){this.b.reset();this.h=this.f=-1};
var lk=function(a){var c=a.b;if(c.b==c.g)return!1;(c=a.j)||(c=a.b,c=c.u||0>c.b||c.b>c.g);if(c)return Hb("Decoder hit an error"),!1;a.w=a.b.b;var b=a.b.h();c=b>>>3;b&=7;if(0!=b&&5!=b&&1!=b&&2!=b&&3!=b&&4!=b)return Hb("Invalid wire type: %s (at position %s)",b,a.w),a.j=!0,!1;a.f=c;a.h=b;return!0},mk=function(a){switch(a.h){case 0:if(0!=a.h)Hb("Invalid wire type for skipVarintField"),mk(a);else{for(a=a.b;a.f[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.h?(Hb("Invalid wire type for skipFixed64Field"),mk(a)):
(a=a.b,a.b+=8);break;case 2:if(2!=a.h)Hb("Invalid wire type for skipDelimitedField"),mk(a);else{var c=a.b.h();a=a.b;a.b+=c}break;case 5:5!=a.h?(Hb("Invalid wire type for skipFixed32Field"),mk(a)):(a=a.b,a.b+=4);break;case 3:c=a.f;do{if(!lk(a)){Hb("Unmatched start-group tag: stream EOF");a.j=!0;break}if(4==a.h){a.f!=c&&(Hb("Unmatched end-group tag"),a.j=!0);break}mk(a)}while(1);break;default:Hb("Invalid wire encoding for field.")}};
jk.prototype.g=function(a,c){var b=this.b.g,d=this.b.h();d=this.b.b+d;this.b.g=d;c(a,this);this.b.b=d;this.b.g=b};
var nk=function(a){return!!a.b.h()},ok=function(a){return hk(a.b)},pk=function(a){var c=a.b.h();a=a.b;var b=a.f,d=a.b,e=d+c,f=[];for(c="";d<e;){var g=b[d++];if(128>g)f.push(g);else if(192>g)continue;else if(224>g){var k=b[d++];f.push((g&31)<<6|k&63)}else if(240>g){k=b[d++];var m=b[d++];f.push((g&15)<<12|(k&63)<<6|m&63)}else if(248>g){k=b[d++];m=b[d++];var p=b[d++];g=(g&7)<<18|(k&63)<<12|(m&63)<<6|p&63;g-=65536;f.push((g>>10&1023)+55296,(g&1023)+56320)}8192<=f.length&&(c+=String.fromCharCode.apply(null,
f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{b="";for(e=0;e<f.length;e+=8192)b+=String.fromCharCode.apply(null,gc(f,e,e+8192));f=b}a.b=d;return c+f},qk=function(a,c){var b=a.b.h();b=a.b.b+b;for(var d=[];a.b.b<b;)d.push(c.call(a.b));return d};var rk=function(a,c){this.b=a;this.f=c},sk=function(a){return new rk((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},tk=function(a){return new rk(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};rk.prototype.add=function(a){return new rk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};rk.prototype.sub=function(a){return new rk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var uk=function(a){var c=a&65535,b=a>>>16;a=10*c+65536*(0*c&65535)+65536*(10*b&65535);for(c=0*b+(0*c>>>16)+(10*b>>>16);4294967296<=a;)a-=4294967296,c+=1;return new rk(a>>>0,c>>>0)};
rk.prototype.toString=function(){for(var a="",c=this;0!=c.b||0!=c.f;){var b=new rk(0,0);c=new rk(c.b,c.f);for(var d=new rk(10,0),e=new rk(1,0);!(d.f&2147483648);)d=tk(d),e=tk(e);for(;0!=e.b||0!=e.f;)0>=(d.f<c.f||d.f==c.f&&d.b<c.b?-1:d.f==c.f&&d.b==c.b?0:1)&&(b=b.add(e),c=c.sub(d)),d=sk(d),e=sk(e);b=[b,c];c=b[0];a=b[1].b+a}""==a&&(a="0");return a};
var vk=function(a){for(var c=new rk(0,0),b=new rk(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;b.b=parseInt(a[d],10);var e=uk(c.b);c=uk(c.f);c.f=c.b;c.b=0;c=e.add(c).add(b)}return c};rk.prototype.clone=function(){return new rk(this.b,this.f)};var wk=function(a,c){this.b=a;this.f=c};wk.prototype.add=function(a){return new wk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
wk.prototype.sub=function(a){return new wk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};wk.prototype.clone=function(){return new wk(this.b,this.f)};wk.prototype.toString=function(){var a=0!=(this.f&2147483648),c=new rk(this.b,this.f);a&&(c=(new rk(0,0)).sub(c));return(a?"-":"")+c.toString()};var xk=function(){this.b=[]};xk.prototype.length=function(){return this.b.length};xk.prototype.end=function(){var a=this.b;this.b=[];return a};
var yk=function(a,c,b){for(;0<b||127<c;)a.b.push(c&127|128),c=(c>>>7|b<<25)>>>0,b>>>=7;a.b.push(c)},zk=function(a,c){for(;127<c;)a.b.push(c&127|128),c>>>=7;a.b.push(c)},Ak=function(a,c){if(0<=c)zk(a,c);else{for(var b=0;9>b;b++)a.b.push(c&127|128),c>>=7;a.b.push(1)}},Bk=function(a,c){a.b.push(c>>>0&255);a.b.push(c>>>8&255);a.b.push(c>>>16&255);a.b.push(c>>>24&255)};var D=function(){this.w=[];this.j=0;this.g=new xk},Dk=function(a,c){Ck(a,c,2);c=a.g.end();a.w.push(c);a.j+=c.length;c.push(a.j);return c},Ek=function(a,c){var b=c.pop();for(b=a.j+a.g.length()-b;127<b;)c.push(b&127|128),b>>>=7,a.j++;c.push(b);a.j++};D.prototype.reset=function(){this.w=[];this.g.end();this.j=0};
var F=function(a){for(var c=new Uint8Array(a.j+a.g.length()),b=a.w,d=b.length,e=0,f=0;f<d;f++){var g=b[f];c.set(g,e);e+=g.length}b=a.g.end();c.set(b,e);a.w=[c];return c},Ck=function(a,c,b){zk(a.g,8*c+b)};D.prototype.f=function(a,c){null!=c&&null!=c&&(Ck(this,a,0),Ak(this.g,c))};
var G=function(a,c,b){null!=b&&null!=b&&(Ck(a,c,0),a=a.g,Wj(b),yk(a,Uj,Vj))},Fk=function(a,c,b){if(null!=b){var d=b;(b=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=vk(d);null===d?b=null:(b&&(d=(new rk(0,0)).sub(d)),b=new wk(d.b,d.f));Ck(a,c,0);yk(a.g,b.b,b.f)}};D.prototype.h=function(a,c){null!=c&&null!=c&&(Ck(this,a,0),zk(this.g,c))};
var Gk=function(a,c,b){null!=b&&null!=b&&(Ck(a,c,0),a=a.g,Wj(b),yk(a,Uj,Vj))},Hk=function(a,c,b){null!=b&&(b=vk(b),Ck(a,c,0),yk(a.g,b.b,b.f))},Ik=function(a,c,b){null!=b&&(Ck(a,c,5),Bk(a.g,b))},Jk=function(a,c,b){null!=b&&(Ck(a,c,5),a=a.g,Xj(b),Bk(a,Uj))},Kk=function(a,c,b){if(null!=b){Ck(a,c,1);a=a.g;var d=b;d=(b=0>d?1:0)?-d:d;0===d?(Vj=0<1/d?0:2147483648,Uj=0):isNaN(d)?(Vj=2147483647,Uj=4294967295):1.7976931348623157E308<d?(Vj=(b<<31|2146435072)>>>0,Uj=0):2.2250738585072014E-308>d?(d/=Math.pow(2,
-1074),Vj=(b<<31|d/4294967296)>>>0,Uj=d>>>0):(c=Math.floor(Math.log(d)/Math.LN2),1024==c&&(c=1023),d*=Math.pow(2,-c),Vj=(b<<31|c+1023<<20|1048576*d&1048575)>>>0,Uj=4503599627370496*d>>>0);Bk(a,Uj);Bk(a,Vj)}},I=function(a,c,b){null!=b&&(Ck(a,c,0),a.g.b.push(b?1:0))},J=function(a,c,b){null!=b&&(Ck(a,c,0),Ak(a.g,b))},K=function(a,c,b){if(null!=b){c=Dk(a,c);for(var d=a.g,e=0;e<b.length;e++){var f=b.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=
f&&56319>=f&&e+1<b.length){var g=b.charCodeAt(e+1);56320<=g&&57343>=g&&(f=1024*(f-55296)+g-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}Ek(a,c)}},Lk=function(a,c,b){null!=b&&(b=ak(b),Ck(a,c,2),zk(a.g,b.length),c=a.g.end(),a.w.push(c),a.w.push(b),a.j+=c.length+b.length)};D.prototype.b=function(a,c,b){null!=c&&(a=Dk(this,a),b(c,this),Ek(this,a))};
var Mk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Ck(e,c,0),Ak(e.g,f))}},Nk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Ck(e,c,0),e=e.g,Wj(f),yk(e,Uj,Vj))}},Ok=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Ck(e,c,0),zk(e.g,f))}},Pk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Ik(a,c,b[d])},Qk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)J(a,c,b[d])},Rk=function(a,c,b){if(null!=
b)for(var d=0;d<b.length;d++)K(a,c,b[d])},Sk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Lk(a,c,b[d])},L=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++){var f=Dk(a,c);d(b[e],a);Ek(a,f)}},Tk=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++)Ck(a,c,3),d(b[e],a),Ck(a,c,4)},Uk=function(a,c,b){if(null!=b&&b.length){c=Dk(a,c);for(var d=0;d<b.length;d++)Ak(a.g,b[d]);Ek(a,c)}},Vk=function(a,c,b){if(null!=b&&b.length){c=Dk(a,c);for(var d=0;d<b.length;d++)Ak(a.g,b[d]);Ek(a,c)}};var M=function(){},Wk="function"==typeof Uint8Array,N=function(a,c,b,d,e,f){a.b=null;c||(c=b?[b]:[]);a.Yf=b?String(b):void 0;a.j=0===b?-1:0;a.f=c;a:{b=a.f.length;c=-1;if(b&&(c=b-1,b=a.f[c],!(null===b||"object"!=typeof b||Va(b)||Wk&&b instanceof Uint8Array))){a.m=c-a.j;a.g=b;break a}-1<d?(a.m=Math.max(d,c+1-a.j),a.g=null):a.m=Number.MAX_VALUE}a.o={};if(e)for(d=0;d<e.length;d++)c=e[d],c<a.m?(c+=a.j,a.f[c]=a.f[c]||Xk):(Yk(a),a.g[c]=a.g[c]||Xk);if(f&&f.length)for(d=0;d<f.length;d++)Zk(a,f[d])},Xk=Object.freeze?
Object.freeze([]):[],Yk=function(a){var c=a.m+a.j;a.f[c]||(a.g=a.f[c]={})},$k=function(a,c,b,d){for(var e in b){var f=b[e],g=f.hp;if(!f.ji)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,g);if(null!=k)if(g.gg)if(f.Bk)f.ji.call(c,g.Mk,k,f.Bk);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.ji.call(c,g.Mk,k)}},O=function(a,c){if(c<a.m){c+=
a.j;var b=a.f[c];return b===Xk?a.f[c]=[]:b}if(a.g)return b=a.g[c],b===Xk?a.g[c]=[]:b},al=function(a,c){a=O(a,c);return null==a?a:+a},bl=function(a,c){a=O(a,c);return null==a?a:!!a},cl=function(a,c){var b=O(a,c);a.o||(a.o={});if(!a.o[c]){for(var d=0;d<b.length;d++)b[d]=+b[d];a.o[c]=!0}return b},dl=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ja(a))return Tj(a);Hb("Cannot coerce to Uint8Array: "+Sa(a));return null},fl=function(a){el(a);return!a.length||a[0]instanceof Uint8Array?a:Nb(a,
dl)},el=function(a){if(a&&1<a.length){var c=Sa(a[0]);y(a,function(b){Sa(b)!=c&&Hb("Inconsistent type in JSPB repeated field array. Got "+Sa(b)+" expected "+c)})}},P=function(a,c,b){a=O(a,c);return null==a?b:a},gl=function(a,c,b){a=bl(a,c);return null==a?b:a},hl=function(a,c){a=al(a,c);return null==a?0:a},S=function(a,c,b){c<a.m?a.f[c+a.j]=b:(Yk(a),a.g[c]=b)},T=function(a,c,b){il(a,c,b,"")},jl=function(a,c,b){il(a,c,b,0)},il=function(a,c,b,d){b!==d?S(a,c,b):a.f[c+a.j]=null},kl=function(a,c,b,d){(b=
Zk(a,b))&&b!==c&&void 0!==d&&(a.b&&b in a.b&&(a.b[b]=void 0),S(a,b,void 0));S(a,c,d)},Zk=function(a,c){for(var b,d,e=0;e<c.length;e++){var f=c[e],g=O(a,f);null!=g&&(b=f,d=g,S(a,f,void 0))}return b?(S(a,b,d),b):0},U=function(a,c,b,d){a.b||(a.b={});if(!a.b[b]){var e=O(a,b);if(d||e)a.b[b]=new c(e)}return a.b[b]},V=function(a,c,b){ll(a,c,b);c=a.b[b];c==Xk&&(c=a.b[b]=[]);return c},ll=function(a,c,b){a.b||(a.b={});if(!a.b[b]){for(var d=O(a,b),e=[],f=0;f<d.length;f++)e[f]=new c(d[f]);a.b[b]=e}},W=function(a,
c,b){a.b||(a.b={});var d=b?b.Ec():b;a.b[c]=b;S(a,c,d)},nl=function(a,c,b){var d=ml[0];a.b||(a.b={});var e=b?b.Ec():b;a.b[c]=b;kl(a,c,d,e)},ol=function(a,c,b){a.b||(a.b={});b=b||[];for(var d=[],e=0;e<b.length;e++)d[e]=b[e].Ec();a.b[c]=b;S(a,c,d)},pl=function(a,c,b,d,e){ll(a,d,c);var f=a.b[c];f||(f=a.b[c]=[]);b=b?b:new d;a=O(a,c);void 0!=e?(f.splice(e,0,b),a.splice(e,0,b.Ec())):(f.push(b),a.push(b.Ec()));return b},ql=function(a){if(a.b)for(var c in a.b){var b=a.b[c];if(Va(b))for(var d=0;d<b.length;d++)b[d]&&
b[d].Ec();else b&&b.Ec()}};M.prototype.Ec=function(){ql(this);return this.f};M.prototype.Ba=Wk?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Rj(this)};try{return JSON.stringify(this.f&&this.Ec(),rl)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&this.Ec(),rl)};
var rl=function(a,c){return r(c)&&(isNaN(c)||Infinity===c||-Infinity===c)?String(c):c},tl=function(a){var c=sl[a[0]];if(!c)throw Error("Unknown JsPb message type: "+a[0]);return new c(a)};M.prototype.toString=function(){ql(this);return this.f.toString()};M.prototype.w=function(a){if(this.g)return this.b||(this.b={}),a.gg?(!this.b[175237375]&&this.g[175237375]&&(this.b[175237375]=new a.gg(this.g[175237375])),this.b[175237375]):this.g[175237375]};
var vl=function(a,c){a=a||{};c=c||{};var b={},d;for(d in a)b[d]=0;for(d in c)b[d]=0;for(d in b)if(!ul(a[d],c[d]))return!1;return!0},ul=function(a,c){if(a==c)return!0;if(!Ya(a)||!Ya(c))return r(a)&&isNaN(a)||r(c)&&isNaN(c)?String(a)==String(c):!1;if(a.constructor!=c.constructor)return!1;if(Wk&&a.constructor===Uint8Array){if(a.length!=c.length)return!1;for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,c.length);for(b=0;b<f;b++){var g=
a[b],k=c[b];g&&g.constructor==Object&&(d=g,g=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!ul(g,k))return!1}return d||e?(d=d||{},e=e||{},vl(d,e)):!0}if(a.constructor===Object)return vl(a,c);throw Error("Invalid type in JSPB array");};M.prototype.clone=function(){return wl(this)};
var wl=function(a){return new a.constructor(xl(a.Ec()))},xl=function(a){if(Va(a)){for(var c=Array(a.length),b=0;b<a.length;b++){var d=a[b];null!=d&&(c[b]="object"==typeof d?xl(d):d)}return c}if(Wk&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(b in a)d=a[b],null!=d&&(c[b]="object"==typeof d?xl(d):d);return c},yl=function(a,c){sl[a]=c;c.messageId=a},sl={};var zl=function(a){N(this,a,0,-1,null,null)};x(zl,M);var Al=function(a){N(this,a,0,-1,null,null)};x(Al,M);var Cl=function(a,c){for(;lk(c)&&!kk(c);)switch(c.f){case 1:var b=hk(c.b);S(a,1,b);break;case 2:b=pk(c);S(a,2,b);break;case 3:b=new Al;c.g(b,Bl);W(a,3,b);break;default:mk(c)}return a};zl.prototype.s=function(){var a=new D;Dl(this,a);return F(a)};
var Dl=function(a,c){var b=O(a,1);null!=b&&G(c,1,b);b=O(a,2);null!=b&&K(c,2,b);b=U(a,Al,3);null!=b&&c.b(3,b,El)},Bl=function(a,c){for(;lk(c)&&!kk(c);)switch(c.f){case 1:var b=pk(c);S(a,1,b);break;case 2:b=hk(c.b);S(a,2,b);break;default:mk(c)}return a};Al.prototype.s=function(){var a=new D;El(this,a);return F(a)};var El=function(a,c){var b=O(a,1);null!=b&&K(c,1,b);b=O(a,2);null!=b&&G(c,2,b)};zl.prototype.Hb=function(){return O(this,1)};var Fl=function(a,c){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=c;this.logRecord=this.deviceJustSetUp=void 0};w("castApp.eventPage.Message",Fl);var Gl=function(a,c,b){this.ipAddress=a;this.appId=c;this.sessionId=b};Fl.DeviceData=Gl;Fl.DeviceJustSetUp=function(a,c,b,d){this.ipAddress=a;this.name=c;this.udn=b;this.modelName=d};Fl.DeviceCapabilities=function(){};
Fl.LogRecord=function(a,c,b,d){this.levelValue=a;this.msg=c;this.loggerName=b;this.time=d};var Hl=function(a,c){this.type=a;this.entryPoint=c};w("castApp.frontEnd.ExtensionMessage",Hl);var Il=function(a){return"urn:x-cast:com.google.cast."+a},Jl=Il("tp.connection"),Kl=Il("receiver"),Ll=Il("remoting"),Ml=Il("media"),Nl=Il("webrtc"),Ol=Il("broadcast"),Pl=Mc({zy:Jl,Ay:Il("tp.heartbeat"),mx:Kl,rx:Ll,tv:Ml,wv:Il("media.universalRemote.optIn"),Vy:Nl,Is:Ol});var Ql=function(a){return"available"==a||"available_rescan"==a};var Rl=function(a,c,b,d,e){this.id=a;this.friendlyName=c;this.iconType=b||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var Sl=window.localStorage,Tl=0,Vl=function(a){return(a=window.localStorage.getItem(Ul(a,!1)))?JSON.parse(a):null},Wl=function(a){return(a=window.localStorage.getItem(Ul(a,!0)))?JSON.parse(a):null},Yl=function(a){if(Xl.has(a.Fa()))throw Error("Duplicate instance name "+a.Fa());Xl.set(a.Fa(),a);a.ib()},dm=function(a){for(var c=0,b=l(Object.keys(Sl)),d=b.next();!d.done;d=b.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?Tl+=e:c+=e}Zl=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||$l(a))&&am();bm.info("initialize: "+Tl+" chars used, "+c+" other chars");chrome.runtime.onSuspend.addListener(cm)},Zl=null,bm=hb("mr.PersistentDataManager"),Xl=new Map,Ul=function(a,c){return"mr."+(c?"persistent.":"temp.")+a.Fa()},$l=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},cm=function(){bm.info("onSuspend");em("version",chrome.runtime.getManifest().version);
Zl&&em("mrInstanceId",Zl);for(var a=Xl.get("LogManager"),c=l(Xl),b=c.next();!b.done;b=c.next())b=l(b.value),b.next(),b=b.next().value,b!=a&&fm(b);a&&fm(a)},fm=function(a){try{var c=a.jb();c&&void 0!=c[0]&&em(Ul(a,!1),JSON.stringify(c[0]));c&&void 0!=c[1]&&em(Ul(a,!0),JSON.stringify(c[1]))}catch(b){bm.error("Error while saving data for "+a.Fa()+": "+b.message)}},em=function(a,c){var b=window.localStorage.getItem(a);b=null!=b?c.length-b.length:a.length+c.length;52E5<Tl+b&&(bm.G("Unable to write "+b+
" chars"),am());if(52E5<Tl+b)throw bm.error("Unable to write "+b+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,c)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}Tl+=b},gm=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(c,b){var d=new FileReader;d.onloadend=function(){if(d.error)b(d.error);
else try{for(var e=d.result,f=[],g=0,k=e.byteLength;g<k;g+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(e,g,Math.min(k-g,8192)/2)));em("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));c()}catch(m){b(m)}};d.readAsArrayBuffer(a)})},am=function(){for(var a=l(Object.keys(Sl)),c=a.next();!c.done;c=a.next())c=c.value,c.startsWith("mr.temp.")&&(Tl-=c.length+window.localStorage.getItem(c).length,delete window.localStorage[c]);bm.info("removeTemporary_: "+Tl+" chars used")};var hm=(new Map).set("+","-").set("/","_").set("=","."),im=(new Map).set("-","+").set("_","/").set(".","="),jm=function(a){return atob(a.replace(/[-_.]/g,function(c){return im.get(c)}))},km=function(a){return btoa(String.fromCharCode.apply(String,n(a))).replace(/[+/=]/g,function(c){return hm.get(c)})};var lm=function(){this.b=[];this.j=[];this.w=[];this.g=[];this.g[0]=128;for(var a=1;64>a;++a)this.g[a]=0;this.h=this.f=0;this.reset()};lm.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.h=this.f=0};
var mm=function(a,c,b){b=void 0===b?0:b;var d=a.w;if("string"===typeof c)for(var e=0;16>e;e++)d[e]=c.charCodeAt(b)<<24|c.charCodeAt(b+1)<<16|c.charCodeAt(b+2)<<8|c.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)d[e]=c[b]<<24|c[b+1]<<16|c[b+2]<<8|c[b+3],b+=4;for(c=16;80>c;c++)b=d[c-3]^d[c-8]^d[c-14]^d[c-16],d[c]=(b<<1|b>>>31)&4294967295;c=a.b[0];b=a.b[1];e=a.b[2];for(var f=a.b[3],g=a.b[4],k,m,p=0;80>p;p++)40>p?20>p?(k=f^b&(e^f),m=1518500249):(k=b^e^f,m=1859775393):60>p?(k=b&e|f&(b|e),m=2400959708):(k=
b^e^f,m=3395469782),k=(c<<5|c>>>27)+k+g+m+d[p]&4294967295,g=f,f=e,e=(b<<30|b>>>2)&4294967295,b=c,c=k;a.b[0]=a.b[0]+c&4294967295;a.b[1]=a.b[1]+b&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+g&4294967295};
lm.prototype.update=function(a,c){c=void 0===c?a.length:c;for(var b=c-64,d=0,e=this.j,f=this.f;d<c;){if(0==f)for(;d<=b;)mm(this,a,d),d+=64;if("string"===typeof a)for(;d<c;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){mm(this,e);f=0;break}}else for(;d<c;)if(e[f]=a[d],++f,++d,64==f){mm(this,e);f=0;break}}this.f=f;this.h+=c};
lm.prototype.digest=function(){var a=[],c=8*this.h;56>this.f?this.update(this.g,56-this.f):this.update(this.g,64-(this.f-56));for(var b=63;56<=b;b--)this.j[b]=c&255,c/=256;mm(this,this.j);for(b=c=0;5>b;b++)for(var d=24;0<=d;d-=8)a[c]=this.b[b]>>d&255,++c;return a};var nm=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var pm=function(){this.j=nm();this.f=new om(null,null);this.b=new om(null,null);this.w=[];this.g=this.h=0;Yl(this)},rm=function(){qm||(qm=new pm);return qm},sm=function(a,c){c=c.toLowerCase();var b=new lm;b.update(c);b.update(a.j);return"r"+km(b.digest())},tm=function(){var a=rm();return a.f.model?a.f:a.b.model?a.b:new om(null,null)};pm.prototype.Fa=function(){return"SinkUtils"};
pm.prototype.jb=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.j,fixedIpList:this.w.join(","),castControlPort:this.h,lastCloudSinkCheckTimeMillis:this.g}]};
pm.prototype.ib=function(){var a=Vl(this);a&&(this.f=a.recentLaunchedDevice||new om(null,null),this.b=a.recentDiscoveredDevice||new om(null,null));if(a=Wl(this))this.j=a.receiverIdToken||nm(),this.w=a.fixedIpList&&a.fixedIpList.split(",")||[],this.h=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var qm=null,om=function(a,c){this.model=a;this.ip=c};var um=function(a,c){this.uc=this.ff=this.Jd=this.La=this.fc=null;this.vc=new Rl(c,a);this.bc={};this.vh={};this.re=!1};um.prototype.getId=function(){return this.vc.id};um.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var c=!1;this.vc.friendlyName!=a.vc.friendlyName&&(this.vc.friendlyName=a.vc.friendlyName,c=!0);this.Jd!=a.Jd&&(this.Jd=a.Jd,c=!0);this.ff!=a.ff&&(this.ff=a.ff,c=!0);this.fc!=a.fc&&(this.fc=a.fc,c=!0);this.La!=a.La&&(this.La=a.La,c=!0);return c};um.prototype.Rb=function(){return this.fc};
um.prototype.yb=function(){return this.La};var vm=function(a,c){return a.bc[c]||"unknown"},wm=function(a){var c=new um(a.vc.friendlyName,"");c.vc.id=a.vc.id;c.fc=a.fc;c.La=a.La;c.Jd=a.Jd;c.ff=a.ff;c.uc=a.uc;c.bc=a.bc;c.vh=a.vh;c.re=a.re;return c};var xm=function(a,c,b,d,e,f){this.f=new Rl(a,c,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.uc=b||null;this.b=d||null;this.fc=e||null;this.La=f||null;this.bc={};this.ni=!1};xm.prototype.update=function(a,c,b,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=c&&this.fc!=c&&(this.fc=c,e=!0);null!=b&&this.La!=b&&(this.La=b,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};xm.prototype.getId=function(){return this.f.id};xm.prototype.Rb=function(){return this.fc};
xm.prototype.yb=function(){return this.La};var ym=function(a,c){return a.bc[c]||"unknown"};var zm="StopIteration"in Ha?Ha.StopIteration:{message:"StopIteration",stack:""},Am=function(){};Am.prototype.next=function(){throw zm;};Am.prototype.Jb=function(){return this};
var Bm=function(a){if(a instanceof Am)return a;if("function"==typeof a.Jb)return a.Jb(!1);if(Wa(a)){var c=0,b=new Am;b.next=function(){for(;;){if(c>=a.length)throw zm;if(c in a)return a[c++];c++}};return b}throw Error("Not implemented");},Cm=function(a,c,b){if(Wa(a))try{y(a,c,b)}catch(d){if(d!==zm)throw d;}else{a=Bm(a);try{for(;;)c.call(b,a.next(),void 0,a)}catch(d){if(d!==zm)throw d;}}},Dm=function(a,c){a=Bm(a);try{for(;!c.call(void 0,a.next(),void 0,a););}catch(b){if(b!==zm)throw b;}},Em=function(a){if(Wa(a))return z(a);
a=Bm(a);var c=[];Cm(a,function(b){c.push(b)});return c};var Gm=function(a,c){this.f={};this.b=[];this.h=this.g=0;var b=arguments.length;if(1<b){if(b%2)throw Error("Uneven number of arguments");for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Fm(this,a)};Gm.prototype.Aa=function(){return this.g};Gm.prototype.ma=function(){Hm(this);for(var a=[],c=0;c<this.b.length;c++)a.push(this.f[this.b[c]]);return a};Gm.prototype.xb=function(){Hm(this);return this.b.concat()};var Jm=function(a,c){return Im(a.f,c)};
Gm.prototype.pf=function(a){for(var c=0;c<this.b.length;c++){var b=this.b[c];if(Im(this.f,b)&&this.f[b]==a)return!0}return!1};Gm.prototype.equals=function(a,c){if(this===a)return!0;if(this.g!=a.Aa())return!1;c=c||Km;Hm(this);for(var b,d=0;b=this.b[d];d++)if(!c(this.get(b),a.get(b)))return!1;return!0};var Km=function(a,c){return a===c};Gm.prototype.Nb=function(){return 0==this.g};Gm.prototype.clear=function(){this.f={};this.h=this.g=this.b.length=0};
Gm.prototype.remove=function(a){return Im(this.f,a)?(delete this.f[a],this.g--,this.h++,this.b.length>2*this.g&&Hm(this),!0):!1};var Hm=function(a){if(a.g!=a.b.length){for(var c=0,b=0;c<a.b.length;){var d=a.b[c];Im(a.f,d)&&(a.b[b++]=d);c++}a.b.length=b}if(a.g!=a.b.length){var e={};for(b=c=0;c<a.b.length;)d=a.b[c],Im(e,d)||(a.b[b++]=d,e[d]=1),c++;a.b.length=b}};Gm.prototype.get=function(a,c){return Im(this.f,a)?this.f[a]:c};
Gm.prototype.set=function(a,c){Im(this.f,a)||(this.g++,this.b.push(a),this.h++);this.f[a]=c};var Fm=function(a,c){if(c instanceof Gm)for(var b=c.xb(),d=0;d<b.length;d++)a.set(b[d],c.get(b[d]));else for(b in c)a.set(b,c[b])};Gm.prototype.forEach=function(a,c){for(var b=this.xb(),d=0;d<b.length;d++){var e=b[d],f=this.get(e);a.call(c,f,e,this)}};Gm.prototype.clone=function(){return new Gm(this)};var Lm=function(a){Hm(a);for(var c={},b=0;b<a.b.length;b++){var d=a.b[b];c[d]=a.f[d]}return c};
Gm.prototype.Jb=function(a){Hm(this);var c=0,b=this.h,d=this,e=new Am;e.next=function(){if(b!=d.h)throw Error("The map has changed since the iterator was created");if(c>=d.b.length)throw zm;var f=d.b[c++];return a?f:d.f[f]};return e};var Im=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};var Mm=function(a,c){this.h=c;this.f=a;this.f.qa=this.qa.bind(this);this.b=new Gm;this.j=new Gm;this.l=hb("mr.cast.SinkDiscoveryService");this.g={cg:0,sg:0}};q(Mm,Li);Mm.prototype.init=function(){Yl(this);Vi("mr.cast.SinkDiscoveryService",this)};
var Um=function(a,c){a.l.info("addSinks returned "+c.length+" sinks");ob(a.l,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.xb());c.forEach(function(e){var f=e.sink_id;var g=e.extra_data.cast_media_sink,k=g.ip_endpoint?g.ip_endpoint.address:g.ip_address,m=g.ip_endpoint?g.ip_endpoint.port:rm().h||8009;f=new xm(f,e.name,g.model_name,g.capabilities,k.address_bytes.join("."),m);g=a.b.get(f.getId());k=a.f;e=e.extra_data.cast_media_sink.cast_channel_id;m=f.getId();var p=k.f.get(m);
if(!p||p.channelId!=e){Nm.info("Added cast channel "+e+" to receiver: "+m);p&&k.b.remove(p.channelId);p={auth:"ssl_verified",ipAddress:f.Rb(),port:f.yb()};p={channelId:e,readyState:"open",keepAlive:!0,audioOnly:!(f.b&1),connectInfo:p};k.f.set(m,p);k.b.set(e,m);var v=k.h.get(m);v&&v.channelId!=e&&(Nm.info("Re-connected to receiver: "+f.getId()),Om(k.g,v,p),Pm(k.j.j,f,!0));k.h.set(m,p)}if(g){if(k=g.update(f.f.friendlyName,f.Rb(),f.yb(),f.b))g.ni=!1;k&&Qm(a.h,g)}else a.l.info("Adding sink "+f.getId()),
Rm(a,f),g=a.h,g.g.onSinkAvailabilityUpdated(g,1),Qm(g,f),Pm(g.j,f),rm().b=new om(f.uc,f.Rb());b.delete(f.getId())});b.forEach(function(e){var f=a.f,g=f.h.get(e);g&&(Sm(f.g,g),f.h.remove(e));Tm(a,e)});var d=a.b.Aa();a.g={cg:d,sg:d}};Mm.prototype.Fe=function(){return this.g};
var Rm=function(a,c){var b=a.b.get(c.getId()),d=null,e=c.Rb(),f=c.yb();null!=e&&null!=f&&(d=a.j.get(e+":"+f));if(b&&!d){var g=c.Rb(),k=c.yb();g&&k&&a.j.remove(g+":"+k)}d&&!b&&a.b.remove(d.getId());a.b.set(c.getId(),c);null!=e&&null!=f&&a.j.set(e+":"+f,c)},Tm=function(a,c){var b=a.b.get(c);if(b){a.l.info("Removing sink "+c);a.b.remove(c);c=b.Rb();var d=b.yb();null!=c&&null!=d&&a.j.remove(c+":"+d);a=a.h;if(0==a.b.b.Aa())a.g.onSinkAvailabilityUpdated(a,0);c=a.j;b=b.getId();(b=Vm(c.b,b))&&b.session&&
Wm(c,b.session.sessionId);Xm(a.F);a.g.Vc()}},Zm=function(a){a.l.info("Pruning inactive sinks.");var c=new Set;a.b.forEach(function(b){Ym(a.f,b)||c.add(b.getId())});c.forEach(function(b){return Tm(a,b)})};Mm.prototype.qa=function(a){return this.b.get(a,null)};var $m=function(a,c){var b=[];Cm(a.b.Jb(!1),function(d){Ql(ym(d,c))&&b.push(d)});return b};Mm.prototype.Fa=function(){return"cast.SinkDiscoveryService"};
Mm.prototype.jb=function(){var a=this,c={};Cm(this.b.Jb(!0),function(b){var d=a.b.get(b);d={id:d.getId(),ip:d.Rb(),port:d.yb(),friendlyName:d.f.friendlyName,modelName:d.uc,capabilities:d.b,discoveredByDial:d.ni,appStatusMap:d.bc};c[b]=d});return[new an(c,this.g)]};
Mm.prototype.ib=function(){var a=Vl(this);if(a&&4==a.version){this.g=a.deviceCounts;a=a.sinkMap;for(var c in a){var b=void 0,d=a[c],e=new xm("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.f.id=d.id;e.ni=d.discoveredByDial;e.bc=d.appStatusMap;for(b in e.bc)"unavailable"==e.bc[b]&&(e.bc[b]="unavailable_rescan");b=e;this.qa(b.getId())||Rm(this,b)}Zm(this)}};var an=function(a,c){this.sinkMap=a;this.deviceCounts=c;this.version=4};var bn={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var cn=function(){this.type="GET_STATUS";this.requestId=0};var dn=function(a,c){this.requestId=a;this.Qg=c;this.Em=null};dn.prototype.b=function(){};var en=function(){this.b=new Gm},fn=function(a,c){a.b.set(c.requestId,c);c.Em=setTimeout(function(){a.b.remove(c.requestId);c.b()},c.Qg)},gn=function(a,c){var b=a.b.get(c);if(!b)return null;clearTimeout(b.Em);a.b.remove(c);return b};var hn=function(a,c,b){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=c;this.message=b};var jn=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var kn=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var ln=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},mn=function(a){var c=a.b++;0==c&&(c=a.b++);return c};ln.prototype.Fa=function(){return"IdGenerator."+this.f};ln.prototype.jb=function(){return[this.b]};ln.prototype.ib=function(){var a=Vl(this);a&&(this.b=a)};var nn=function(a,c){this.f=a;this.g=c;this.b=new en;this.h=new ln("cast.RequestIdGenerator")};nn.prototype.init=function(){Yl(this.h)};var pn=function(a,c,b,d){var e=mn(a.h);c.requestId=e;c=new Db;b=new on(e,c,r(b)&&0<b?b:6E5,d);fn(a.b,b);return b};
nn.prototype.sendRequest=function(a,c,b,d,e,f){var g=this;if(!Pl.hasOwnProperty(b))return Promise.reject(Error("Custom namespace is not supported"));var k=pn(this,a,Ia(d)?d:3E3,e),m=k.vb;qn(this.f,c,b,a,e||this.g,f).then(null,function(){gn(g.b,k.requestId);m.reject(rn)});return m.b};
nn.prototype.sendMessage=function(a,c,b,d,e,f){var g=this,k=pn(this,a,Ia(d)?d:3E3,e),m=k.vb;qn(this.f,c,b,a,e||this.g,f).then(function(){gn(g.b,k.requestId);m.resolve(!0)},function(){gn(g.b,k.requestId);m.reject(rn)});return m.b};
var sn=function(a,c,b){var d=new jn(c.appId);d.language=c.language?c.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,b,Kl,c.requestSessionTimeout)},tn=Error("Timeout"),rn=Error("Failed to send message"),on=function(a,c,b,d){dn.call(this,a,b);this.vb=c;this.sourceId=d};q(on,dn);on.prototype.b=function(){this.vb.reject(tn)};var un=function(a){return a.Aa&&"function"==typeof a.Aa?a.Aa():Wa(a)||Ja(a)?a.length:Cc(a)},vn=function(a){if(a.ma&&"function"==typeof a.ma)return a.ma();if(Ja(a))return a.split("");if(Wa(a)){for(var c=[],b=a.length,d=0;d<b;d++)c.push(a[d]);return c}return Ec(a)},wn=function(a){if(a.xb&&"function"==typeof a.xb)return a.xb();if(!a.ma||"function"!=typeof a.ma){if(Wa(a)||Ja(a)){var c=[];a=a.length;for(var b=0;b<a;b++)c.push(b);return c}return Fc(a)}},xn=function(a){return a.Nb&&"function"==typeof a.Nb?
a.Nb():Wa(a)||Ja(a)?Vb(a):Ic(a)},yn=function(a,c,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(c,b);else if(Wa(a)||Ja(a))y(a,c,b);else for(var d=wn(a),e=vn(a),f=e.length,g=0;g<f;g++)c.call(b,e[g],d&&d[g],a)},zn=function(a,c,b){if("function"==typeof a.map)return a.map(c,b);if(Wa(a)||Ja(a))return Nb(a,c,b);var d=wn(a),e=vn(a),f=e.length;if(d){var g={};for(var k=0;k<f;k++)g[d[k]]=c.call(b,e[k],d[k],a)}else for(g=[],k=0;k<f;k++)g[k]=c.call(b,e[k],void 0,a);return g},An=function(a,c){if("function"==
typeof a.every)return a.every(c,void 0);if(Wa(a)||Ja(a))return Qb(a,c,void 0);for(var b=wn(a),d=vn(a),e=d.length,f=0;f<e;f++)if(!c.call(void 0,d[f],b&&b[f],a))return!1;return!0};var Cn=function(a){this.b=new Gm;a&&Bn(this,a)},Dn=function(a){var c=typeof a;return"object"==c&&a||"function"==c?"o"+(a[Za]||(a[Za]=++ab)):c.substr(0,1)+a};Cn.prototype.Aa=function(){return this.b.Aa()};Cn.prototype.add=function(a){this.b.set(Dn(a),a)};var Bn=function(a,c){c=vn(c);for(var b=c.length,d=0;d<b;d++)a.add(c[d])};h=Cn.prototype;h.removeAll=function(a){a=vn(a);for(var c=a.length,b=0;b<c;b++)this.remove(a[b])};h.remove=function(a){return this.b.remove(Dn(a))};h.clear=function(){this.b.clear()};
h.Nb=function(){return this.b.Nb()};h.contains=function(a){return Jm(this.b,Dn(a))};h.ma=function(){return this.b.ma()};h.clone=function(){return new Cn(this)};h.equals=function(a){return this.Aa()==un(a)&&En(this,a)};var En=function(a,c){var b=un(c);if(a.Aa()>b)return!1;!(c instanceof Cn)&&5<b&&(c=new Cn(c));return An(a,function(d){var e=c;return e.contains&&"function"==typeof e.contains?e.contains(d):e.pf&&"function"==typeof e.pf?e.pf(d):Wa(e)||Ja(e)?Ub(e,d):Hc(e,d)})};Cn.prototype.Jb=function(){return this.b.Jb(!1)};var Gn=function(a,c){this.h=a;this.g=c;this.f=new Gm;this.b=new Cn;this.j=0;this.o=new Gm("serviceCheck",this.vp.bind(this),"startDeviceMonitor",this.wp.bind(this),"releaseDeviceMonitor",this.up.bind(this),"deviceJustSetUp",this.rp.bind(this),"logRecord",this.sp.bind(this));chrome.runtime.onMessage.addListener(this.m.bind(this));chrome.runtime.onMessageExternal.addListener(this.w.bind(this));Fn(this,"serviceReady")};Gn.prototype.l=hb("castApp.eventPage.Service");
var Xm=function(a){if(Hn(a)){var c=new Cn;Cm(a.h.b.Jb(!1),function(d){var e=d.Rb();c.add(e);Jm(this.f,e)||this.g.sendRequest(new cn,d,Kl)}.bind(a));var b=!1;a.f.xb().forEach(function(d){c.contains(d)||(this.f.remove(d),b=!0)}.bind(a));b&&In(a)}},Hn=function(a){if(0===a.b.Aa())return!1;var c=u();3E4<c-a.j&&(a.j=c,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(b){0===b.length?(this.l.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.l.info(function(){return"Tab check found active tabs: "+b.map(function(d){return d.id})})}.bind(a)));c=a.b.Aa();a.l.info("Monitor client count: "+c);return 0<c};Gn.prototype.m=function(a,c,b){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.o.get(a.subtype);if(!d)return!1;if(!a.originId)return Hb("Missing origin ID in the incoming message."),!1;try{var e=d(a,c,b);e&&b(e)}catch(f){this.l.error("Error while handling request",f)}return!1};
var Fn=function(a,c,b){var d=new Fl(c,b);ob(a.l,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};h=Gn.prototype;h.vp=function(){Fn(this,"serviceReady")};h.wp=function(a){this.b.contains(a.originId)?this.l.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.l.info("Registering monitor client: "+a.originId),this.b.add(a.originId));In(this);Jn(this)};h.up=function(a){this.l.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
h.rp=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.l.info("Device just set up: "+a.slice(-4))};h.sp=function(a){a=a.logRecord;kb({level:rb(a.levelValue),O:a.loggerName,time:a.time,message:a.msg})};var In=function(a){var c=a.f.ma();Fn(a,"devices",c)},Jn=function(a){a.h.b.ma().forEach(function(c){this.g.sendRequest(new cn,c,Kl)}.bind(a))};
Gn.prototype.w=function(a,c,b){switch(a.type){case "handshake":b(new Hl("handshake"));break;case "launch":c=c.tab&&r(c.tab.id)?c.tab.id:null,null===c||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(c,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];w("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.ds=!0;w("chrome.cast.usingPresentationApi",chrome.cast.ds);chrome.cast.Error=function(a,c,b){this.code=a;this.description=c||null;this.details=b||null};w("chrome.cast.Error",chrome.cast.Error);chrome.cast.Yn=function(a){this.platform=a;this.packageId=this.url=null};w("chrome.cast.SenderApplication",chrome.cast.Yn);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};w("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,c){this.level=Ia(a)?a:null;this.muted=Ia(c)?c:null};w("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.ad={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};w("chrome.cast.AutoJoinPolicy",chrome.cast.ad);chrome.cast.Yg={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};w("chrome.cast.DefaultActionPolicy",chrome.cast.Yg);chrome.cast.Id={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
w("chrome.cast.Capability",chrome.cast.Id);chrome.cast.dd={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};w("chrome.cast.ErrorCode",chrome.cast.dd);chrome.cast.Ln={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
w("chrome.cast.ReceiverAvailability",chrome.cast.Ln);chrome.cast.Zn={CHROME:"chrome",IOS:"ios",ANDROID:"android"};w("chrome.cast.SenderPlatform",chrome.cast.Zn);chrome.cast.Zg={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};w("chrome.cast.ReceiverType",chrome.cast.Zg);chrome.cast.Ym={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};w("chrome.cast.DialAppState",chrome.cast.Ym);chrome.cast.Vf={CAST:"cast",STOP:"stop"};w("chrome.cast.ReceiverAction",chrome.cast.Vf);
chrome.cast.jk={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};w("chrome.cast.SessionStatus",chrome.cast.jk);chrome.cast.nk={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};w("chrome.cast.VolumeControlType",chrome.cast.nk);chrome.cast.Nm=function(a,c,b,d,e){this.sessionRequest=a;this.sessionListener=c;this.receiverListener=b;this.autoJoinPolicy=d||chrome.cast.ad.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.Yg.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};w("chrome.cast.ApiConfig",chrome.cast.Nm);chrome.cast.an=function(a,c){this.appName=a;this.launchParameter=c||null};w("chrome.cast.DialRequest",chrome.cast.an);
chrome.cast.Qj=function(a,c,b){this.receiver=a;this.appState=c;this.extraData=b||null};w("chrome.cast.DialLaunchData",chrome.cast.Qj);chrome.cast.Zm=function(a,c){this.doLaunch=a;this.launchParameter=c||null};w("chrome.cast.DialLaunchResponse",chrome.cast.Zm);chrome.cast.ik=function(a,c,b){this.appId=a;this.capabilities=Va(c)?c:[chrome.cast.Id.VIDEO_OUT,chrome.cast.Id.AUDIO_OUT];this.requestSessionTimeout=b||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
w("chrome.cast.SessionRequest",chrome.cast.ik);
chrome.cast.Uh=function(a,c,b,d){this.label=a;a=c;td.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(nd,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(od,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(pd,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(qd,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(rd,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(sd,"&#0;")));this.friendlyName=a;this.capabilities=b||[];this.volume=d||null;this.receiverType=chrome.cast.Zg.CAST;this.displayStatus=this.isActiveInput=null};
w("chrome.cast.Receiver",chrome.cast.Uh);chrome.cast.Mn=function(a,c){this.statusText=a;this.appImages=c;this.showStop=null};w("chrome.cast.ReceiverDisplayStatus",chrome.cast.Mn);chrome.cast.lk=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};w("chrome.cast.Timeout",chrome.cast.lk);chrome.cast.timeout=new chrome.cast.lk;w("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.Kj="auto-join";chrome.cast.ek="cast-session_";chrome.cast.media.gn={SDR:"sdr",HDR:"hdr",DV:"dv"};w("chrome.cast.media.HdrType",chrome.cast.media.gn);chrome.cast.media.hn={AAC:"aac",AC3:"ac3",MP3:"mp3",TS:"ts",TS_AAC:"ts_aac",E_AC3:"e_ac3",FMP4:"fmp4"};w("chrome.cast.media.HlsSegmentFormat",chrome.cast.media.hn);chrome.cast.media.jn={MPEG2_TS:"mpeg2_ts",FMP4:"fmp4"};w("chrome.cast.media.HlsVideoSegmentFormat",chrome.cast.media.jn);chrome.cast.media.le={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};
w("chrome.cast.media.MediaCommand",chrome.cast.media.le);chrome.cast.media.In={ALBUM:"ALBUM",PLAYLIST:"PLAYLIST",AUDIOBOOK:"AUDIOBOOK",RADIO_STATION:"RADIO_STATION",PODCAST_SERIES:"PODCAST_SERIES",TV_SERIES:"TV_SERIES",VIDEO_PLAYLIST:"VIDEO_PLAYLIST",LIVE_TV:"LIVE_TV",MOVIE:"MOVIE"};w("chrome.cast.media.QueueType",chrome.cast.media.In);chrome.cast.media.Ph={GENERIC_CONTAINER:0,AUDIOBOOK_CONTAINER:1};w("chrome.cast.media.ContainerType",chrome.cast.media.Ph);
chrome.cast.media.me={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4,AUDIOBOOK_CHAPTER:5};w("chrome.cast.media.MetadataType",chrome.cast.media.me);chrome.cast.media.PlayerState={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};w("chrome.cast.media.PlayerState",chrome.cast.media.PlayerState);chrome.cast.media.Vh={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};w("chrome.cast.media.RepeatMode",chrome.cast.media.Vh);
chrome.cast.media.Nn={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};w("chrome.cast.media.ResumeState",chrome.cast.media.Nn);chrome.cast.media.kk={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};w("chrome.cast.media.StreamType",chrome.cast.media.kk);chrome.cast.media.ln={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};w("chrome.cast.media.IdleReason",chrome.cast.media.ln);chrome.cast.media.ko={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};
w("chrome.cast.media.TrackType",chrome.cast.media.ko);chrome.cast.media.ho={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};w("chrome.cast.media.TextTrackType",chrome.cast.media.ho);chrome.cast.media.bo={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};w("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.bo);chrome.cast.media.io={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};
w("chrome.cast.media.TextTrackWindowType",chrome.cast.media.io);chrome.cast.media.co={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};w("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.co);chrome.cast.media.eo={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};w("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.eo);
chrome.cast.media.no={LIKE:"LIKE",DISLIKE:"DISLIKE",FOLLOW:"FOLLOW",UNFOLLOW:"UNFOLLOW"};w("chrome.cast.media.UserAction",chrome.cast.media.no);chrome.cast.media.en=function(){this.customData=null};w("chrome.cast.media.GetStatusRequest",chrome.cast.media.en);chrome.cast.media.xn=function(){this.customData=null};w("chrome.cast.media.PauseRequest",chrome.cast.media.xn);chrome.cast.media.yn=function(){this.customData=null};w("chrome.cast.media.PlayRequest",chrome.cast.media.yn);chrome.cast.media.Xn=function(){this.customData=this.resumeState=this.currentTime=null};w("chrome.cast.media.SeekRequest",chrome.cast.media.Xn);
chrome.cast.media.ao=function(){this.customData=null};w("chrome.cast.media.StopRequest",chrome.cast.media.ao);chrome.cast.media.ro=function(a){this.volume=a;this.customData=null};w("chrome.cast.media.VolumeRequest",chrome.cast.media.ro);chrome.cast.media.nn=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};w("chrome.cast.media.LoadRequest",chrome.cast.media.nn);
chrome.cast.media.jx=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.dn=function(a,c){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=c||null};w("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.dn);chrome.cast.media.Oh=function(a){this.containerType=a=void 0===a?chrome.cast.media.Ph.GENERIC_CONTAINER:a;this.containerDuration=this.containerImages=this.sections=this.title=void 0};w("chrome.cast.media.ContainerMetadata",chrome.cast.media.Oh);
chrome.cast.media.ic=function(a){this.metadataType=this.type=a;this.queueItemId=this.sectionStartTimeInContainer=this.sectionStartAbsoluteTime=this.sectionStartTimeInMedia=this.sectionDuration=void 0};w("chrome.cast.media.MediaMetadata",chrome.cast.media.ic);chrome.cast.media.Wj=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.GENERIC);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=void 0};q(chrome.cast.media.Wj,chrome.cast.media.ic);
w("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Wj);chrome.cast.media.Yj=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.MOVIE);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=void 0};q(chrome.cast.media.Yj,chrome.cast.media.ic);w("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Yj);
chrome.cast.media.mk=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.TV_SHOW);this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=void 0};q(chrome.cast.media.mk,chrome.cast.media.ic);w("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.mk);
chrome.cast.media.Zj=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.MUSIC_TRACK);this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=void 0};q(chrome.cast.media.Zj,chrome.cast.media.ic);w("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Zj);
chrome.cast.media.fk=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.PHOTO);this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=void 0};q(chrome.cast.media.fk,chrome.cast.media.ic);w("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.fk);chrome.cast.media.Mj=function(){chrome.cast.media.Oh.call(this,chrome.cast.media.Ph.AUDIOBOOK_CONTAINER);this.releaseDate=this.publisher=this.narrators=this.authors=void 0};
q(chrome.cast.media.Mj,chrome.cast.media.Oh);w("chrome.cast.media.AudiobookContainerMetadata",chrome.cast.media.Mj);chrome.cast.media.Lj=function(){chrome.cast.media.ic.call(this,chrome.cast.media.me.AUDIOBOOK_CHAPTER);this.images=this.subtitle=this.bookTitle=this.chapterNumber=this.title=this.chapterTitle=void 0};q(chrome.cast.media.Lj,chrome.cast.media.ic);w("chrome.cast.media.AudiobookChapterMediaMetadata",chrome.cast.media.Lj);
chrome.cast.media.qn=function(a,c){this.contentId=a;this.contentUrl=void 0;this.streamType=chrome.cast.media.kk.BUFFERED;this.contentType=c;this.metadata=null;this.entity=void 0;this.duration=null;this.startAbsoluteTime=void 0;this.customData=this.textTrackStyle=this.tracks=null;this.userActionStates=this.hlsVideoSegmentFormat=this.hlsSegmentFormat=this.vmapAdsRequest=this.breakClips=this.breaks=void 0};w("chrome.cast.media.MediaInfo",chrome.cast.media.qn);
chrome.cast.media.Cn=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};w("chrome.cast.media.QueueItem",chrome.cast.media.Cn);chrome.cast.media.Wm="CC1AD845";w("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.Wm);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;w("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Ua=0;w("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Ua);chrome.cast.media.timeout.play=0;w("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;w("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;w("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;w("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.setVolume=0;w("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.setVolume);chrome.cast.media.timeout.pi=0;w("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.pi);chrome.cast.media.timeout.dr=0;w("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.dr);chrome.cast.media.jo=function(a,c){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=c;this.customData=this.subtype=this.language=this.name=null};
w("chrome.cast.media.Track",chrome.cast.media.jo);chrome.cast.media.fo=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};w("chrome.cast.media.TextTrackStyle",chrome.cast.media.fo);
chrome.cast.media.En=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Vh.OFF;this.customData=null};w("chrome.cast.media.QueueLoadRequest",chrome.cast.media.En);chrome.cast.media.Bn=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.Bn);
chrome.cast.media.Jn=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};w("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.Jn);chrome.cast.media.Dn=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueJumpRequest",chrome.cast.media.Dn);
chrome.cast.media.Hn=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Hn);chrome.cast.media.Fn=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};w("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.Fn);
chrome.cast.media.Gn=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.Gn);chrome.cast.media.Qm=function(a,c,b){this.id=a;this.breakClipIds=c;this.position=b;this.duration=void 0;this.isWatched=!1;this.isEmbedded=void 0};w("chrome.cast.media.Break",chrome.cast.media.Qm);
chrome.cast.media.Rm=function(a){this.id=a;this.vastAdsRequest=this.customData=this.hlsSegmentFormat=this.clickThroughUrl=this.posterUrl=this.whenSkippable=this.duration=this.title=this.contentType=this.contentUrl=this.contentId=void 0};w("chrome.cast.media.BreakClip",chrome.cast.media.Rm);chrome.cast.media.po=function(){this.adsResponse=this.adTagUrl=void 0};w("chrome.cast.media.VastAdsRequest",chrome.cast.media.po);
chrome.cast.media.Sm=function(){this.whenSkippable=this.breakClipId=this.breakId=this.currentBreakClipTime=this.currentBreakTime=void 0};w("chrome.cast.media.BreakStatus",chrome.cast.media.Sm);chrome.cast.media.mn=function(a,c,b,d){this.start=a;this.end=c;this.isMovingWindow=b;this.isLiveDone=d};w("chrome.cast.media.LiveSeekableRange",chrome.cast.media.mn);
chrome.cast.media.An=function(a,c,b,d,e,f,g){this.id=a;this.queueType=this.entity=void 0;this.name=c;this.description=b;this.repeatMode=d;this.shuffle=!1;this.items=e;this.startIndex=f;this.startTime=g;this.containerMetadata=void 0};w("chrome.cast.media.QueueData",chrome.cast.media.An);chrome.cast.media.oo=function(a){this.userAction=a;this.customData=void 0};w("chrome.cast.media.UserActionState",chrome.cast.media.oo);chrome.cast.media.qo=function(a,c,b){this.width=a;this.height=c;this.hdrType=b};
w("chrome.cast.media.VideoInformation",chrome.cast.media.qo);chrome.cast.media.W=function(a,c){this.sessionId=a;this.mediaSessionId=c;this.media=null;this.videoInfo=this.queueData=void 0;this.playbackRate=1;this.playerState=chrome.cast.media.PlayerState.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Vh.OFF;this.liveSeekableRange=this.breakStatus=void 0};
w("chrome.cast.media.Media",chrome.cast.media.W);chrome.cast.media.W.prototype.Ua=function(){};chrome.cast.media.W.prototype.getStatus=chrome.cast.media.W.prototype.Ua;chrome.cast.media.W.prototype.play=function(){};chrome.cast.media.W.prototype.play=chrome.cast.media.W.prototype.play;chrome.cast.media.W.prototype.Vq=function(){};chrome.cast.media.W.prototype.playWithContext=chrome.cast.media.W.prototype.Vq;chrome.cast.media.W.prototype.pause=function(){};chrome.cast.media.W.prototype.pause=chrome.cast.media.W.prototype.pause;
chrome.cast.media.W.prototype.Tq=function(){};chrome.cast.media.W.prototype.pauseWithContext=chrome.cast.media.W.prototype.Tq;chrome.cast.media.W.prototype.seek=function(){};chrome.cast.media.W.prototype.seek=chrome.cast.media.W.prototype.seek;chrome.cast.media.W.prototype.stop=function(){};chrome.cast.media.W.prototype.stop=chrome.cast.media.W.prototype.stop;chrome.cast.media.W.prototype.setVolume=function(){};chrome.cast.media.W.prototype.setVolume=chrome.cast.media.W.prototype.setVolume;
chrome.cast.media.W.prototype.pi=function(){};chrome.cast.media.W.prototype.editTracksInfo=chrome.cast.media.W.prototype.pi;chrome.cast.media.W.prototype.fr=function(){};chrome.cast.media.W.prototype.queueInsertItems=chrome.cast.media.W.prototype.fr;chrome.cast.media.W.prototype.er=function(){};chrome.cast.media.W.prototype.queueAppendItem=chrome.cast.media.W.prototype.er;chrome.cast.media.W.prototype.qr=function(){};chrome.cast.media.W.prototype.queueUpdateItems=chrome.cast.media.W.prototype.qr;
chrome.cast.media.W.prototype.kr=function(){};chrome.cast.media.W.prototype.queuePrev=chrome.cast.media.W.prototype.kr;chrome.cast.media.W.prototype.jr=function(){};chrome.cast.media.W.prototype.queueNext=chrome.cast.media.W.prototype.jr;chrome.cast.media.W.prototype.gr=function(a){Kn(this,a)};chrome.cast.media.W.prototype.queueJumpToItem=chrome.cast.media.W.prototype.gr;chrome.cast.media.W.prototype.pr=function(){};chrome.cast.media.W.prototype.queueSetRepeatMode=chrome.cast.media.W.prototype.pr;
chrome.cast.media.W.prototype.mr=function(){};chrome.cast.media.W.prototype.queueRemoveItems=chrome.cast.media.W.prototype.mr;chrome.cast.media.W.prototype.lr=function(a){Kn(this,a)};chrome.cast.media.W.prototype.queueRemoveItem=chrome.cast.media.W.prototype.lr;chrome.cast.media.W.prototype.nr=function(){};chrome.cast.media.W.prototype.queueReorderItems=chrome.cast.media.W.prototype.nr;
chrome.cast.media.W.prototype.ir=function(a,c,b,d){a=Kn(this,a);0>a||(0>c?d&&d(new chrome.cast.Error(chrome.cast.dd.INVALID_PARAMETER)):a==c&&b&&b())};chrome.cast.media.W.prototype.queueMoveItemToNewIndex=chrome.cast.media.W.prototype.ir;chrome.cast.media.W.prototype.Yr=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.W.prototype.supportsCommand=chrome.cast.media.W.prototype.Yr;chrome.cast.media.W.prototype.lp=function(){return this.currentTime};
chrome.cast.media.W.prototype.getEstimatedTime=chrome.cast.media.W.prototype.lp;chrome.cast.media.W.prototype.ei=function(){};chrome.cast.media.W.prototype.addUpdateListener=chrome.cast.media.W.prototype.ei;chrome.cast.media.W.prototype.fi=function(){};chrome.cast.media.W.prototype.addUpdateListenerWithContext=chrome.cast.media.W.prototype.fi;chrome.cast.media.W.prototype.rj=function(){};chrome.cast.media.W.prototype.removeUpdateListener=chrome.cast.media.W.prototype.rj;
chrome.cast.media.W.prototype.sj=function(){};chrome.cast.media.W.prototype.removeUpdateListenerWithContext=chrome.cast.media.W.prototype.sj;var Kn=function(a,c){return Rb(a.items,function(b){return b.itemId==c})};var Ln=function(a,c,b){this.sessionId=a;this.namespaceName=c;this.message=b};var Mn=function(a,c){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=c||null};chrome.cast.aa=function(a,c,b,d,e){this.sessionId=a;this.appId=c;this.displayName=b;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.jk.CONNECTED;this.transportId=""};w("chrome.cast.Session",chrome.cast.aa);chrome.cast.aa.prototype.Or=function(a,c,b){this.xm(null,a,c,b)};chrome.cast.aa.prototype.setReceiverVolumeLevel=chrome.cast.aa.prototype.Or;
chrome.cast.aa.prototype.xm=function(a,c,b,d){c=new Mn(new chrome.cast.Volume(c,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,c,b,d)};chrome.cast.aa.prototype.setReceiverVolumeLevelWithContext=chrome.cast.aa.prototype.xm;chrome.cast.aa.prototype.Nr=function(a,c,b){this.wm(null,a,c,b)};chrome.cast.aa.prototype.setReceiverMuted=chrome.cast.aa.prototype.Nr;
chrome.cast.aa.prototype.wm=function(a,c,b,d){a=new Mn(new chrome.cast.Volume(null,c),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,d)};chrome.cast.aa.prototype.setReceiverMutedWithContext=chrome.cast.aa.prototype.wm;chrome.cast.aa.prototype.leave=function(a,c){null.leaveSession(this.sessionId,a,c)};chrome.cast.aa.prototype.leave=chrome.cast.aa.prototype.leave;chrome.cast.aa.prototype.stop=function(){};chrome.cast.aa.prototype.stop=chrome.cast.aa.prototype.stop;
chrome.cast.aa.prototype.Vr=function(){};chrome.cast.aa.prototype.stopWithContext=chrome.cast.aa.prototype.Vr;chrome.cast.aa.prototype.sendMessage=function(){};chrome.cast.aa.prototype.sendMessage=chrome.cast.aa.prototype.sendMessage;chrome.cast.aa.prototype.Dr=function(){};chrome.cast.aa.prototype.sendMessageWithContext=chrome.cast.aa.prototype.Dr;chrome.cast.aa.prototype.ei=function(){};chrome.cast.aa.prototype.addUpdateListener=chrome.cast.aa.prototype.ei;chrome.cast.aa.prototype.fi=function(){};
chrome.cast.aa.prototype.addUpdateListenerWithContext=chrome.cast.aa.prototype.fi;chrome.cast.aa.prototype.rj=function(){};chrome.cast.aa.prototype.removeUpdateListener=chrome.cast.aa.prototype.rj;chrome.cast.aa.prototype.sj=function(){};chrome.cast.aa.prototype.removeUpdateListenerWithContext=chrome.cast.aa.prototype.sj;chrome.cast.aa.prototype.Fo=function(){};chrome.cast.aa.prototype.addMessageListener=chrome.cast.aa.prototype.Fo;chrome.cast.aa.prototype.Go=function(){};
chrome.cast.aa.prototype.addMessageListenerWithContext=chrome.cast.aa.prototype.Go;chrome.cast.aa.prototype.Do=function(){};chrome.cast.aa.prototype.addMediaListener=chrome.cast.aa.prototype.Do;chrome.cast.aa.prototype.Eo=function(){};chrome.cast.aa.prototype.addMediaListenerWithContext=chrome.cast.aa.prototype.Eo;chrome.cast.aa.prototype.vr=function(){};chrome.cast.aa.prototype.removeMediaListener=chrome.cast.aa.prototype.vr;chrome.cast.aa.prototype.wr=function(){};
chrome.cast.aa.prototype.removeMediaListenerWithContext=chrome.cast.aa.prototype.wr;chrome.cast.aa.prototype.xr=function(){};chrome.cast.aa.prototype.removeMessageListener=chrome.cast.aa.prototype.xr;chrome.cast.aa.prototype.yr=function(){};chrome.cast.aa.prototype.removeMessageListenerWithContext=chrome.cast.aa.prototype.yr;chrome.cast.aa.prototype.Mp=function(a){a.sessionId=this.sessionId};chrome.cast.aa.prototype.loadMedia=chrome.cast.aa.prototype.Mp;
chrome.cast.aa.prototype.hr=function(a){a.sessionId=this.sessionId};chrome.cast.aa.prototype.queueLoad=chrome.cast.aa.prototype.hr;var Pn=function(a,c){if(!c.applications||1!=c.applications.length)return null;var b=c.applications[0];a=Nn(a);a=new chrome.cast.aa(b.sessionId,b.appId,b.displayName,b.appImages,a);a.senderApps=b.senderApps;a.namespaces=b.namespaces||[];a.transportId=b.transportId;a.statusText=b.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||On(a)))return null;a.receiver.volume=c.volume;Ka(c.isActiveInput)&&(a.receiver.isActiveInput=c.isActiveInput);return a},Qn=function(a){var c=[];if(!a)return c;
a&1&&c.push(chrome.cast.Id.VIDEO_OUT);a&2&&c.push(chrome.cast.Id.VIDEO_IN);a&4&&c.push(chrome.cast.Id.AUDIO_OUT);a&8&&c.push(chrome.cast.Id.AUDIO_IN);a&32&&c.push(chrome.cast.Id.MULTIZONE_GROUP);return c},Nn=function(a){var c=sm(rm(),a.getId());return new chrome.cast.Uh(c,a.f.friendlyName,Qn(a.b))},Rn=function(a,c){if(a.statusText!=c.statusText)return!0;var b=a.namespaces||[],d=c.namespaces||[];if(b.length!=d.length)return!0;for(var e={Sf:0};e.Sf<b.length;e={Sf:e.Sf},e.Sf++)if(!d.some(function(f){return function(g){return g.name==
b[f.Sf].name}}(e)))return!0;return a.receiver.volume.level!==c.receiver.volume.level||a.receiver.volume.muted!==c.receiver.volume.muted?!0:!1},Sn=function(a){Va(a)?a.forEach(Sn):Ya(a)&&Object.keys(a).forEach(function(c){null===a[c]?delete a[c]:(Ya(a[c])||Va(a[c]))&&Sn(a[c])})},Tn=function(a){return a.namespaces.some(function(c){return c.name==Ml})},On=function(a){return null!==a&&"MultizoneLeader"==a.appId},Un=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var Vn=function(a,c,b){this.type=a;this.message=c;this.sequenceNumber=Ia(b)?b:-1;this.timeoutMillis=0;this.clientId=""};var Wn=function(a,c){this.h=a;this.b=c;this.g=[];this.f=new en},Yn=function(a,c){return(a=Xn(a.b,c))?a.routeId:null};Wn.prototype.listen=function(a,c){this.g[a]=c};var $n=function(a,c,b,d){ob(Zn,"Sending to "+b);ob(Zn,JSON.stringify(d));d.clientId=b;a.h.g.Td(c,d)},ao=function(a,c,b){var d=Xn(a.b,c);d&&d.b?$n(a,d.routeId,c,b):a.connect(c).then(function(e){e?(e=Yn(a,c))?$n(a,e,c,b):Zn.G("No route for "+c):Zn.G("No connected client "+c)},null)};
Wn.prototype.connect=function(a){var c=Xn(this.b,a);if(null!=c&&c.b)return Promise.resolve(!0);c=Yn(this,a);if(!c)return Zn.G("No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(c,null))return a.vb.b;a=new Db;fn(this.f,new bo(c,a));return a.b};var Zn=hb("mr.cast.ApiMessenger"),bo=function(a,c){dn.call(this,a,3E4);this.vb=c};q(bo,dn);bo.prototype.b=function(){this.vb.resolve(!1)};var co=function(a,c,b){this.g=a;this.b=c;this.f=b},eo=function(a){var c="cast-dial:"+a.g,b=new URLSearchParams;a.b&&b.set("dialPostData",a.b);a.f&&b.set("clientId",a.f);(a=b.toString())&&(c+="?"+a);return c};var fo=function(a,c,b,d,e,f,g,k,m,p){this.j=a;this.b=c||null;this.f=b||null;this.g=d||null;this.h=Ia(e)?e:null;this.u=f||null;this.D=g||null;this.o=k||!1;this.m=m||null;this.w=p||null},go=function(a,c){return(a=a.match(c+"=([^/]*)"))?a[1]:null},io=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Mb(Nb(a,function(c){c=go(c,"__castAppId__");if(!c)return null;c=c.match(ho);if(!c||0==c.length)return null;var b=[];3==c.length&&c[2]&&(b=c[2].split(","));return{appId:c[1],capabilities:b}}),
function(c){return null!=c})},jo=function(a){return Nb(a.j,function(c){return c.appId})},ko=function(a){return a.f?a.f:chrome.cast.ad.TAB_AND_ORIGIN_SCOPED},lo=function(a){var c=a.j.map(function(b){var d="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.g&&e.set("defaultActionPolicy",a.g);null!=a.h&&e.set("launchTimeout",String(a.h));a.o&&e.set("invisibleSender",
"true");a.m&&(e.set("broadcastNamespace",a.m),e.set("broadcastId",String(Math.random())));a.w&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.w)));return d+"?"+e.toString()});a.u&&c.push(eo(new co(a.u,a.D,a.b)));return c},no=function(a,c){a=jo(a);var b=mo(c);return Pb(a,function(d){return Ub(b,d)})},oo=function(a){try{var c=new URL(a)}catch(v){return null}if("https:"==c.protocol)if("https:"!=c.protocol||"google.com"!=c.host||"/cast"!=c.pathname)a=null;else{var b=c.hash;if((a=io(b))&&
0!=a.length){c=go(b,"__castClientId__");var d=go(b,"__castAutoJoinPolicy__"),e=go(b,"__castDefaultActionPolicy__");var f=go(b,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var g=go(b,"__dialAppName__"),k=go(b,"__dialPostData__");var m=go(b,"__castInvisibleSender__");m=null===m?null:"true"==m;var p=go(b,"__castBroadcastNamespace__");b=(b=go(b,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(b)):null;a=new fo(a,c,d,e,f,g,k,m,p,b)}else a=null}else if("cast:"==
c.protocol){a=c.pathname;d=c.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=c.searchParams;c=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");b=Number(k.get("launchTimeout"));if(isNaN(b)||0>=b)b=null;f="true"==k.get("invisibleSender");g=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new fo([a],c,d,e,b,void 0,void 0,f,g,k)}else a=null;return a},mo=function(a){return(a=oo(a))?jo(a):null},po=
function(a){return(a=oo(a))?a.b:null},ho=/(^\w+)(?:\(([\w, ]*)\))?$/;var qo={kv:0,Xu:1},ro={Py:0,Kn:1,nx:2},so={pw:0,TIMEOUT:1,FAILED:2},to={Ku:0,Uw:1,SEEK:2,Rv:3,gy:4,zs:5},uo=function(a){Cb("MediaRouter.Cast.Session.Ended",a,ro)},vo=function(a){Cb("MediaRouter.Cast.Controller.ActionType",a,to)},wo=function(a){Cb("MediaRouter.Cast.Session.Fail",a,so)};var xo=function(a,c,b){this.O=hb("mr.MediaRouteController."+a);this.h=new mojo.Binding(mojo.MediaController,this,c);this.g=b;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.u=!1;this.h.setConnectionErrorHandler(this.w.bind(this));this.g.ptr.setConnectionErrorHandler(this.w.bind(this))};xo.prototype.w=function(){this.Ya();this.Pi()};
xo.prototype.Ya=function(){this.u||(this.u=!0,this.Oi(),this.h&&(this.h.close(),this.h=null),this.g&&(this.g.ptr.reset(),this.g=null))};var yo=function(a){if(a.g)a.g.onMediaStatusUpdated(a.b)};h=xo.prototype;h.Oi=function(){};h.Pi=function(){};h.play=function(){};h.pause=function(){};h.Se=function(){};h.setVolume=function(){};h.seek=function(){};h.ki=function(a){a.close();throw Error("Not implemented");};xo.prototype.connectHangoutsMediaRouteController=xo.prototype.ki;xo.prototype.seek=xo.prototype.seek;
xo.prototype.setVolume=xo.prototype.setVolume;xo.prototype.setMute=xo.prototype.Se;xo.prototype.pause=xo.prototype.pause;xo.prototype.play=xo.prototype.play;var zo=function(a){var c=new URL(a);a={};a.scheme=c.protocol.replace(":","");a.host=c.hostname;c=c.port?Number.parseInt(c.port,10):0;switch(a.scheme){case "http":a.port=c||80;break;case "https":a.port=c||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Ao=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Bo=function(a,c,b,d){this.type=a;this.mediaSessionId=c;this.requestId=0;this.sessionId=b;this.currentTime=d},Do=function(a,c,b,d,e){xo.call(this,"CastRouteController",a,c);this.session=b;this.f=d;this.j=e;this.o=new Date;this.m=new Set;Co(this);vo(0)};q(Do,xo);
var Co=function(a){var c=Eo(a);c&&Fo(a,c);c&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.nk.FIXED;a.b.can_set_volume=a.b.can_mute;yo(a)};h=Do.prototype;h.Pi=function(){Go(this.f.b,this.session.sessionId)};
h.play=function(){var a=Eo(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Ho(this.f,this.session,new Bo("PLAY",a.mediaSessionId,this.session.sessionId));Io(this,1)};h.pause=function(){var a=Eo(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Ho(this.f,this.session,new Bo("PAUSE",a.mediaSessionId,this.session.sessionId));Io(this,1)};
h.seek=function(a){var c=Eo(this);a=a?a.microseconds/1E6:0;var b;if(b=this.b.can_seek&&c&&0<=a)b=this.b.duration,b=a<=(b?b.microseconds/1E6:0);b&&Ho(this.f,this.session,new Bo("SEEK",c.mediaSessionId,this.session.sessionId,a));Io(this,2)};h.Se=function(a){this.b.can_mute&&a!==this.b.is_muted&&Jo(this.f,this.session,new chrome.cast.Volume(null,a));Io(this,3)};h.setVolume=function(a){this.b.can_set_volume&&0<=a&&1>=a&&Jo(this.f,this.session,new chrome.cast.Volume(a));Io(this,4)};
var Eo=function(a){return a.session.media.find(function(c){return!c.idleReason})||null},Fo=function(a,c){a.j&&c.media&&c.media.metadata&&c.media.metadata.title&&(a.b.title=c.media.metadata.title.substring(0,256));a.b.can_play_pause=c.supportedMediaCommands.includes(chrome.cast.media.le.PAUSE);a.b.can_seek=c.supportedMediaCommands.includes(chrome.cast.media.le.SEEK);var b=c.playerState;a.b.play_state=b===chrome.cast.media.PlayerState.PLAYING?mojo.MediaStatus.PlayState.PLAYING:b===chrome.cast.media.PlayerState.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=c.currentTime?Ao(c.playerState===chrome.cast.media.PlayerState.PLAYING?c.currentTime+(new Date-a.o)/1E3:c.currentTime):Ao(0);a.b.duration=c.media&&c.media.duration?Ao(c.media.duration):Ao(0)},Io=function(a,c){0==a.m.size&&vo(5);a.m.has(c)||(vo(c),a.m.add(c))};Do.prototype.setVolume=Do.prototype.setVolume;Do.prototype.setMute=Do.prototype.Se;Do.prototype.seek=Do.prototype.seek;Do.prototype.pause=Do.prototype.pause;
Do.prototype.play=Do.prototype.play;var Ko=function(a){this.f=a;this.l=hb("mr.cast.SessionLauncher")},Lo=function(a,c,b){Cb("MediaRouter.Cast.Session.Type",0,qo);return sn(a.f,c,b).then(a.b.bind(a,b),function(d){d&&tn==d?wo(1):wo(0);throw d;})};Ko.prototype.b=function(a,c){ob(this.l,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==c.type)throw wo(2),Error(c.reason);a=Pn(a,c.status);this.l.info("Launched session: "+a.sessionId);return a};var Mo=function(a){this.b=a;this.l=hb("mr.cast.ReceiverStatusQuerier")},No=function(a,c){return(new df(t(a.f,a,c),3500,5)).start().then(null,function(b){a.l.info("Failed to get receiver status from "+c.getId());throw b;})};Mo.prototype.f=function(a){this.l.info("Query receiver status: "+a.getId());return this.b.sendRequest(new cn,a,Kl)};var Oo=function(a,c,b,d,e,f){this.g=a;this.w=c;this.j=b;this.b=d;this.m=e;this.h=f;this.f=new Wn(f,b);this.C=new Mo(this.g);this.F=new Ko(this.g)};Oo.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.D.bind(this));this.f.listen("app_message",this.o.bind(this));this.f.listen("leave_session",this.u.bind(this))};
var Ro=function(a,c,b,d){Po(a.b,c).slice().forEach(function(e){e!=d&&Qo(a,e,b)})},Qo=function(a,c,b){b.clientId=c;ao(a.f,c,b)},So=function(a,c,b,d){b={receiver:Nn(b),action:d};Qo(a,c,new Vn("receiver_action",b))};
Oo.prototype.D=function(a){var c=a.message,b=c.sessionId;if(b){var d=To(this.b,b);if(d)if(b=Uo(this.b,b))if(b=this.w.qa(b))switch(c.type){case "STOP":Vo(this,a,b);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":Wo(this,a,b,d);break;case "SET_VOLUME":Xo(this,a,b);break;default:Yo.G("Unknown request")}else Zo(this,
a,chrome.cast.dd.INVALID_PARAMETER,"No receiver");else Zo(this,a,chrome.cast.dd.INVALID_PARAMETER,"No sink ID");else Zo(this,a,chrome.cast.dd.INVALID_PARAMETER,"Unknown session ID")}else Zo(this,a,chrome.cast.dd.INVALID_PARAMETER,"No session ID")};
var Zo=function(a,c,b,d){b=new chrome.cast.Error(b,d);$o(a,c,b)},$o=function(a,c,b){ao(a.f,c.clientId,new Vn("error",b,c.sequenceNumber))},Vo=function(a,c,b){var d=c.message;Bb("MediaRouter.Cast.Session.End");var e=d.sessionId,f=ap(a.b,e);f&&(f.j=!0);f=function(){Wm(a,e,c)};a.g.sendRequest(d,b,Kl,c.timeoutMillis,c.clientId).then(f,f)},Wo=function(a,c,b,d){var e=c.message,f=e.type;f in bn&&(e.type=bn[f]);a.g.sendRequest(e,b,Ml,c.timeoutMillis,c.clientId,d.transportId).then(function(g){bp(a,d,g);ao(a.f,
c.clientId,new Vn("v2_message",g,c.sequenceNumber))},function(g){$o(a,c,g)})},Xo=function(a,c,b){var d=c.message;delete d.sessionId;a.g.sendRequest(d,b,Kl,c.timeoutMillis,c.clientId).then(function(){ao(a.f,c.clientId,new Vn("v2_message",null,c.sequenceNumber))},function(e){$o(a,c,e)})};
Oo.prototype.o=function(a){var c=this,b=a.message,d=b.sessionId;if(d){var e=Uo(this.b,d);e?(e=this.w.qa(e))?(d=To(this.b,d),Sb(d.namespaces,function(f){return f.name==b.namespaceName})?qn(this.m,e,b.namespaceName,b.message,a.clientId,d.transportId).then(function(){ao(c.f,a.clientId,new Vn("app_message",null,a.sequenceNumber))},function(){Zo(c,a,chrome.cast.dd.CHANNEL_ERROR,"Channel to receiver not available")}):Zo(this,a,chrome.cast.dd.INVALID_PARAMETER,"Invalid namespace")):Yo.G("No receiver from sinkId"):
Yo.G("No sinkId from sessionId")}else Yo.G("No sessionId")};
Oo.prototype.u=function(a){var c=this;Yo.info("Leave session");var b=ap(this.b,a.message);if(b){var d=a.clientId,e=Xn(this.j,d);if(e){var f=[],g=[],k=e.tabId,m=e.origin,p=e.autoJoinPolicy;b.f.forEach(function(v){var A=Xn(c.j,v);p==chrome.cast.ad.TAB_AND_ORIGIN_SCOPED&&k==A.tabId&&m==A.origin||p==chrome.cast.ad.ORIGIN_SCOPED&&m==A.origin?(A.f=!0,f.push(v)):g.push(v)});ao(this.f,d,new Vn("leave_session",null,a.sequenceNumber));f.forEach(function(v){(v=Xn(c.j,v))&&cp(c.h,v.routeId,!0,!0)});b.f=g}else Yo.G("No client record")}else Yo.G("No session")};
var dp=function(a,c,b){Tn(c)&&a.g.sendRequest(new cn,b,Ml,void 0,void 0,c.transportId).catch(Qa)},Pm=function(a,c,b){var d=c.getId();Yo.info("Query status for "+d);No(a.C,c).then(function(e){ep(a,d,e);b&&(e=fp(a.b,d))&&dp(a,e,c)},Qa)},gp=function(a,c){if("*"==c.destinationId)return!0;c=c.destinationId;if(c==a.m.w||null!=Xn(a.j,c))return!0;Yo.info("Invalid destination "+c);return!1},kp=function(a,c,b){ob(Yo,function(){return"Cast message: "+JSON.stringify(b)});if(gp(a,b))if(b.namespace_==Ll||b.namespace_==
Nl)(c=Vm(a.b,c))&&c.b.forEach(function(f){var g=a.h,k=g.f.get(f);k&&k.qf&&g.g.Fh(f,b)});else{var d=JSON.parse(b.data),e=hp(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":ep(a,c,d);break;case "MEDIA_STATUS":ip(a,c,b,e)}}else jp(a.m,c,b.destinationId,b.sourceId,!1)},hp=function(a,c){a=gn(a.g.b,c.requestId);if(!a)return null;var b=a.vb;switch(c.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete c.requestId;b.reject(new chrome.cast.Error(chrome.cast.dd.SESSION_ERROR,
c.reason||c.type,c));break;default:b.resolve(c)}return a},lp=function(a,c,b){ob(Yo,function(){return"App message: "+JSON.stringify(b)});if(c=fp(a.b,c)){var d;"*"==b.destinationId?d=Po(a.b,c.sessionId):d=[b.destinationId];var e=new Ln(c.sessionId,b.namespace_,b.data);d.forEach(function(f){ao(a.f,f,new Vn("app_message",e))})}else Yo.G("No session for incoming app message")},mp=function(a,c){a.forEach(function(b){b.sessionId=c;var d=b.supportedMediaCommands,e=[];d&1&&e.push(chrome.cast.media.le.PAUSE);
d&2&&e.push(chrome.cast.media.le.SEEK);d&4&&e.push(chrome.cast.media.le.STREAM_VOLUME);d&8&&e.push(chrome.cast.media.le.STREAM_MUTE);b.supportedMediaCommands=e});return a},bp=function(a,c,b){c=c.sessionId;b.sessionId=c;b=mp(b.status,c);np(a.b,c,b);(a=ap(a.b,c))&&a.controller&&(a=a.controller,a.o=new Date,(b=Eo(a))?Fo(a,b):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),yo(a))},op=function(a,c){if(c=fp(a.b,c)){c=c.sessionId;var b=ap(a.b,c);b&&b.j||Wm(a,c)}},Wm=function(a,c,b){b&&Qo(a,b.clientId,
b);(b=ap(a.b,c))&&b.b.slice().forEach(function(d){cp(a.h,d,!0)});pp(a.b,c);qp(a.h)},ep=function(a,c,b){ob(Yo,"Receiver status for "+c);var d=b.status;if(d)if(b=a.w.qa(c)){d=Pn(b,d);var e=Vm(a.b,c);e?d?d.sessionId==e.session.sessionId?(c=e.session,Rn(c,d)&&(ob(Yo,"Updating session "+d.sessionId),e.g&&(c.statusText=d.statusText),c.namespaces=d.namespaces,c.receiver.volume=d.receiver.volume,rp(a.h,e),Ro(a,c.sessionId,new Vn("update_session",c)),e.controller&&Co(e.controller))):(op(a,c),uo(1),sp(a.h,
null,b,null,d)):(op(a,c),uo(1)):d&&sp(a.h,null,b,null,d)}else Bb("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),Yo.G("Got message from receiver "+c+", but sink is no longer available.")},ip=function(a,c,b,d){if(c=fp(a.b,c))if(b=JSON.parse(b.data))bp(a,c,b),Ro(a,b.sessionId,new Vn("v2_message",b),d)},tp=function(a,c){var b=Qn(c.b);return(c=Sb(a.j,function(d){return Qb(d.capabilities,function(e){return Ub(b,e)})}))?c.appId:jo(a)[0]},up=function(a,c,b){var d=oo(c);if(!d)return Promise.reject(Error("Invalid source "+
c));var e=tp(d,b),f=new sb("MediaRouter.Cast.Session.Launch");return Lo(a.F,new chrome.cast.ik(e,void 0,null==d.h?chrome.cast.timeout.requestSession:d.h),b).then(function(g){Yo.info("Launched session "+g.sessionId+" for appId "+e);f.end("Success");return g},function(g){Yo.error("Failed to session for appId "+e);f.end("Failure");throw g;})};
Oo.prototype.createMediaRouteController=function(a,c,b){a=vp(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=wp(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Do(c,b,d,this,a.g);dp(this,d,e);return null};
var Ho=function(a,c,b){var d=wp(a,c.sessionId);d&&a.g.sendRequest(b,d,Ml,0,"",c.transportId).catch(function(e){Yo.G("Failed to send a media control request: "+e)})},Jo=function(a,c,b){b=new Mn(b);(c=wp(a,c.sessionId))&&a.g.sendRequest(b,c,Kl).catch(function(d){Yo.G("Failed to send a volume control request: "+d)})},wp=function(a,c){return(c=Uo(a.b,c))?a.w.qa(c):null},Yo=hb("mr.cast.ApiHandler");var xp=function(a){return"0F5096E8"==a||"85CDB22F"==a};var yp=function(a,c,b,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];var k=this;this.j=a;this.w=c;this.aj=b;this.f=d;this.h=f;this.b=!1;this.g=function(m){for(var p=[],v=0;v<arguments.length;++v)p[v-0]=arguments[v];return k.Zo.apply(k,n(p))}};h=yp.prototype;h.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.g].concat(n(this.h))))};h.removeListener=function(){this.b&&(this.f.removeListener(this.g),this.b=!1)};
h.Sg=function(a){for(var c=0;c<arguments.length;++c);return!0};h.Zo=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];var d=this;Yi(this.j);if(!this.Sg.apply(this,n(c)))return!1;Pi(this.aj).then(function(e){return e.handleEvent.apply(e,[d.f].concat(n(c)))});return this.mi()};h.Fa=function(){return"mr.EventListener."+this.w};h.jb=function(){return[this.b]};h.ib=function(){Vl(this)&&this.addListener()};h.mi=function(){};var zp=null,Ap=null,Bp=function(){zp||(zp=new yp(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Ap||(Ap=new yp(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[zp,Ap]};var Cp=function(){},Dp=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var c=a.substring(31);if(!c)return null;var b=c.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!b)return null;c=new Cp;c.f=a;a=l(b);a.next();c.b=a.next().value;c.h=a.next().value;c.j=a.next().value;c.g=a.next().value;return c};var Ep=function(a,c,b,d,e,f){this.id=a;this.presentationId=c;this.sinkId=b;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.qf=e;this.isOffscreenPresentation=!1},Fp=function(a,c,b,d,e,f){c=d&&bj(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+c+"-"+b+"/"+d;return new Ep(c,
a,b,d,e,f)};var Gp=function(a,c,b,d){b=Fp(b,"cast",c.getId(),a,d,"");b.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(b.controllerType=d&&Zi(a)&&c.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return b},Hp=function(a,c){var b=c.nb.lc;b&&(c.description=mj(b),a.displayName="",a.statusText="mirror_desktop"==b.f?"":b.g||"")};var Ip=function(a,c,b,d){return{namespace_:a,data:Ja(c)?c:JSON.stringify(c),sourceId:b,destinationId:d}};var Jp=function(a){this.type="CLOSE";this.reasonCode=a};var Kp=function(a){return(a=a.exec(Wd))?a[1]:""},Lp=function(){if(Xe)return Kp(/Firefox\/([0-9.]+)/);if(Ae||Be||ze)return Te;if(af)return te()||Zd("iPad")||Zd("iPod")?Kp(/CriOS\/([0-9.]+)/):Kp(/Chrome\/([0-9.]+)/);if(bf&&!(te()||Zd("iPad")||Zd("iPod")))return Kp(/Version\/([0-9.]+)/);if(Ye||Ze){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Wd);if(a)return a[1]+"."+a[2]}else if($e)return(a=Kp(/Android\s+([0-9.]+)/))?a:Kp(/Version\/([0-9.]+)/);return""}(),Mp=function(a){return 0<=vd(Lp,a)};var Op=function(a){this.type="CONNECT";this.origin={};this.userAgent=Wd;var c=this.userAgent.indexOf("(")+1;c=this.userAgent.substr(c,this.userAgent.indexOf(")",c)-1-c+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Lp,platform:Np(),systemVersion:c,connectionType:1};this.connType=a?0:2},Np=function(){switch(wi()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Pp=function(a){if(!chrome.runtime.lastError)return null;var c="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&ob(a,c);return Error(c)};var Qp=function(){this.b=new Gm};Qp.prototype.init=function(){Yl(this)};var Rp=function(a,c,b,d,e){if(!Jm(a.b,[c.channelId,b,d].join("#"))){var f=Ip(Jl,new Op(e),b,d);chrome.cast.channel.send(c,f,a.f.bind(a));a.b.set([c.channelId,b,d].join("#"),e)}};Qp.prototype.f=function(){Pp(Sp)};
var Sm=function(a,c){a.b.xb().forEach(function(b){b.split("#")[0]==c.channelId.toString()&&a.b.remove(b)})},Om=function(a,c,b){a.b.forEach(function(d,e){var f=e.split("#");f[0]==c.channelId.toString()&&(Rp(a,b,f[1],f[2],d),a.b.remove(e))})};Qp.prototype.Fa=function(){return"cast.VirtualConnectionManager"};Qp.prototype.jb=function(){var a=Lm(this.b);return[new Tp(a)]};Qp.prototype.ib=function(){var a=Vl(this);if(a)for(var c in a.b)this.b.set(c,a.b[c])};Ra(Qp);
var Sp=hb("mr.cast.VirtualConnectionManager"),Tp=function(a){this.b=a};var Up=function(a,c){this.j=c;this.w=a;this.f=new Gm;this.b=new Gm;this.g=Qp.Ia();this.qa=null;this.h=new Gm};q(Up,Li);Up.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.o.apply(this,n(b)):a==chrome.cast.channel.onError&&this.m.apply(this,n(b))};Up.prototype.init=function(){this.g.init();Yl(this);Vi("mr.cast.ChannelService",this);Bp().forEach(function(a){return a.addListener()})};
var qn=function(a,c,b,d,e,f){e=e||a.w;f=f||"receiver-0";var g=Ym(a,c);return g?Vp(a,g,b,d,e,f):Promise.reject("Channel not found for "+c.getId())},jp=function(a,c,b,d,e){if(c=a.f.get(c))a=a.g,Jm(a.b,[c.channelId,b,d].join("#"))&&(a.b.remove([c.channelId,b,d].join("#")),b=Ip(Jl,new Jp(e?5:0),b,d),chrome.cast.channel.send(c,b,a.f.bind(a)))};
Up.prototype.o=function(a,c){var b=this.b.get(a.channelId);if(b){var d=this.qa(b);if(d){if(Pl.hasOwnProperty(c.namespace_)){var e=JSON.parse(c.data);switch(e.type){case "CLOSE":this.g.b.remove([a.channelId,c.destinationId,c.sourceId].join("#"));return;case "RPC":break;default:ob(Nm,function(){return"Got message "+(e.type||e.responseType)+" "+("from "+d.getId())})}}else ob(Nm,"Got message in "+c.namespace_+" from "+d.getId());Wp(this.j,d,c)}else Nm.G("Got message for unknown receiver (receiverId="+
b+").")}else Nm.G("Got message for unknown channel (channelId="+a.channelId+").")};var Xp=function(a,c){var b=a.b.get(c.channelId);b&&(a.b.remove(c.channelId),a.f.remove(b))};Up.prototype.m=function(a,c){Nm.G(function(){return"Channel error: "+JSON.stringify(a)+(c?", "+JSON.stringify(c):"")});Xp(this,a)};
var Ym=function(a,c){c=c.getId();(a=a.f.get(c))||Nm.info("Channel not found for receiver: "+c);return a},Vp=function(a,c,b,d,e,f){Rp(a.g,c,e,f,0==f.indexOf("receiver-0"));Sn(d);var g=Ip(b,d,e,f);"object"===typeof d&&"RPC"==d.type||ob(Nm,function(){return"Channel is sending message: "+JSON.stringify(g)});return new Promise(function(k,m){chrome.cast.channel.send(c,g,function(p){p?p.errorState?(m(Error("Failed to send message")),Xp(a,p)):k(!0):(p=Pp(Nm||void 0),m(p))})})};Up.prototype.Fa=function(){return"cast.ChannelService"};
Up.prototype.jb=function(){return[new Yp(Lm(this.f),Lm(this.b),Lm(this.h))]};Up.prototype.ib=function(){var a=Vl(this);a&&(Fm(this.f,a.f),Fm(this.b,a.b),Fm(this.h,a.g))};var Nm=hb("mr.cast.ChannelService"),Yp=function(a,c,b){this.f=a;this.b=c;this.g=b};var Zp=function(a,c,b,d,e,f){this.routeId=a;this.clientId=c;this.appIds=b;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},$p=function(){this.b=[]};$p.prototype.init=function(){Yl(this)};$p.prototype.Aa=function(){return this.b.length};var Xn=function(a,c){return Sb(a.b,function(b){return b.clientId==c})},aq=function(a,c){return Sb(a.b,function(b){return b.routeId==c})},bq=function(a,c){a.b=Mb(a.b,function(b){return b.clientId!=c})};$p.prototype.Fa=function(){return"cast.ClientRecords"};
$p.prototype.jb=function(){return[new cq(this.b)]};$p.prototype.ib=function(){var a=Vl(this);a&&(this.b=a.b)};var cq=function(a){this.b=a};var dq=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var eq=function(a,c){this.h=a;this.f=c;this.g=new Cn;this.b=new Gm};eq.prototype.init=function(){Yl(this)};var fq=function(a,c){var b=a.b.get(c);b&&(b.pj--,0<b.pj||(Cm(a.f.b.Jb(!1),function(d){switch(ym(d,c)){case "available":d.bc[c]="available_rescan";break;case "unavailable":d.bc[c]="unavailable_rescan"}}),a.b.remove(c)))};h=eq.prototype;
h.Fl=function(a){var c=this;Cm(this.b.Jb(!0),function(b){a:{switch(ym(a,b)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+b;c.g.contains(e)||(c.g.add(e),d=function(){c.g.remove(e)},(new df(c.Qo.bind(c,a,b),5500,3)).start().then(c.Gm.bind(c,a,b),function(){c.l.error("Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");c.Gm(a,b,"unknown")}).then(d,d))}})};
h.Gm=function(a,c,b){b!=ym(a,c)&&(this.l.info(c+" on "+a.getId()+" is "+b),a.bc[c]=b,Qm(this.f.h,a))};
h.Qo=function(a,c){var b=this,d=new dq;d.appId=[c];var e=new sb("MediaRouter.Cast.App.Availability");return this.h.sendRequest(d,a,Kl,5E3).then(function(f){e.end("Success");ob(b.l,function(){return"App availability response "+JSON.stringify(f)});for(var g in f.availability){if("APP_AVAILABLE"==f.availability[g])return"available";if("APP_UNAVAILABLE"==f.availability[g])return"unavailable"}return"unknown"},function(f){e.end("Failure");b.l.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
c);throw f;})};h.Fa=function(){return"cast.AppDiscoveryService"};h.jb=function(){return[new gq(Lm(this.b))]};h.ib=function(){var a=Vl(this);a&&Fm(this.b,a.b)};h.l=hb("mr.cast.AppDiscoveryService");var gq=function(a){this.b=a};var hq=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var iq=function(a,c){this.f=[];this.b=[];this.sinkId=a;this.session=c;this.w=this.h=null;this.offTheRecord=this.j=!1;this.controller=null;this.g=!0},jq=function(){this.l=hb("mr.cast.SessionRecords");this.b=[]};jq.prototype.init=function(){Yl(this)};
var pp=function(a,c){a.l.info("Removing session "+c);Go(a,c);a.b=Mb(a.b,function(b){return b.session.sessionId!=c})},Po=function(a,c){return(a=ap(a,c))?a.f:[]},fp=function(a,c){return(a=Vm(a,c))?a.session:null},kq=function(a,c){return Sb(a.b,function(b){return Ub(b.f,c)})},vp=function(a,c){return Sb(a.b,function(b){return Ub(b.b,c)})},lq=function(a,c){return Sb(a.b,function(b){return null!=Sb(b.b,function(d){return Dp(d).b==c})})},Vm=function(a,c){return Sb(a.b,function(b){return b.sinkId==c||b.h==
c})},ap=function(a,c){return Sb(a.b,function(b){return b.session.sessionId==c})},Uo=function(a,c){return(a=ap(a,c))?a.sinkId:null},To=function(a,c){return(a=ap(a,c))?a.session:null},np=function(a,c,b){var d=To(a,c);d&&(a=Mb(b,function(e){return e.playerState!=chrome.cast.media.PlayerState.IDLE}),a.forEach(function(e){if(!e.media){var f=Sb(d.media,function(g){return g.mediaSessionId==e.mediaSessionId});f&&(e.media=f.media)}}),d.media=a)};jq.prototype.Fa=function(){return"cast.SessionRecords"};
jq.prototype.jb=function(){return[new mq(this.b)]};jq.prototype.ib=function(){var a=Vl(this);if(a)for(var c=0;c<a.b.length;c++){var b=a.b[c],d=new iq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.g=b.g;this.b.push(d)}};
var Go=function(a,c){(a=ap(a,c))&&a.controller&&(a.controller.Ya(),a.controller=null)},mq=function(a){var c=[];a=l(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var d=new iq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.offTheRecord=b.offTheRecord;d.g=b.g;c.push(d)}this.b=c};var nq=function(a,c,b){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=c||"";if(b)this.stack=b;else if(Error.captureStackTrace)Error.captureStackTrace(this,nq);else if(c=Error().stack)this.stack=c;this.errorCode=a};q(nq,Error);var oq=function(a,c){this.sinks=a;this.origins=c||null},pq=new oq([]);var qq=function(a){this.D="sender-"+re();this.f=new Gm;this.o=null;Yl(this);this.g=a;this.m=new $p;this.h=new jq;this.u=new Up(this.D,this);this.b=new Mm(this.u,this);this.C=new nn(this.u,this.D);this.w=null;this.j=new Oo(this.C,this.b,this.m,this.h,this.u,this);this.F=new Gn(this.b,this.C)};h=qq.prototype;h.getName=function(){return"cast"};
h.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.l.info("Query enabled: "+a);this.C.init();this.h.init();this.j.init();this.u.init();this.b.init();a&&(this.w=new eq(this.C,this.b),this.w.init())};h.rd=function(){return this.f.ma()};
h.ng=function(a){var c=this;if(null!=rq(a))return new oq([]);var b=new Cn;sq(a).forEach(function(d){$m(c.b,d).map(function(e){return e.f}).forEach(function(e){b.add(e)})});return new oq(b.ma(),-1!=a.indexOf("0F5096E8")?cj:null)};
h.startObservingMediaSinks=function(a){var c=this,b=rq(a);b?(this.l.info("Received broadcast request "+a),Cm(this.b.b.Jb(!1),function(d){c.C.sendMessage(b,d,Ol).catch(function(e){c.l.error("Broadcast failed "+e.message)})})):this.w&&sq(a).forEach(function(d){var e=c.w,f=e.b.get(d);f?f.pj++:e.b.set(d,{pj:1});e.l.info("Scanning sinks for app availability");Cm(e.f.b.Jb(!1),e.Fl,e)})};h.stopObservingMediaSinks=function(a){var c=this;null!=rq(a)||this.w&&sq(a).forEach(function(b){fq(c.w,b)})};
h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.qa=function(a){return(a=this.b.qa(a))?a.f:null};
var tq=function(a,c,b){a.l.error("Error launching.",b);cp(a,c.id,!1,!0,"error");b=new gi(hq,"warning");ki(b,c.id);li(b,c.sinkId);a.g.Ke(b)},wq=function(a,c,b,d,e,f,g,k){rm().f=new om(b.uc,b.Rb());var m=Gp(c,b,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.f.set(m.id,m);a.g.Hf(a,m);qp(a);(e=oo(c))&&e.b&&uq(a,e,m.id,g,k);aj(c)||bj(c)?(m.nb={tabId:k,sessionId:"",Nf:b.Rb()||"",Zd:b.uc||"",Tr:b.f.friendlyName||""},bj(c)&&(m.isOffscreenPresentation=!0),a.g.Qi(a,m,d,function(p){return qi(vq(a,c,b,d,f,g,k,p))}).b.then(function(){var p=
vp(a.h,m.id);p.g=!1;Hp(p.session,m);p.controller&&(p.controller.j=!1,Co(p.controller))},function(p){tq(a,m,p)})):vq(a,c,b,d,f,g,k,m).then(null,function(p){tq(a,m,p)});return Promise.resolve(m)},vq=function(a,c,b,d,e,f,g,k){return up(a.j,xq(c,b,e),b).then(function(m){sp(a,c,b,d,m,f,g,k);return k})};
qq.prototype.createRoute=function(a,c,b,d,e,f,g){var k=this,m=this.b.qa(c);if(!m)return pi(Error("No sink with ID "+c));var p=po(a);if(p){setTimeout(function(){So(k.j,p,m,chrome.cast.Vf.CAST)},0);var v=function(){return wq(k,a,m,b,d,e,f,g)},A=Xn(this.m,p);if(A)return qi(this.terminateRoute(A.routeId).then(v,v));if(f&&g&&(c=yq(this,a,f,g,d,e,c)))return c}return qi(wq(this,a,m,b,d,e,f,g))};
var cp=function(a,c,b,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.l.info("Remove route "+c);var f=aq(a.m,c);if(f){b=b||f.f;var g=f.clientId;a.l.info("Remove client "+g);for(var k=a.h,m=0;m<k.b.length;m++)ac(k.b[m].f,g);bq(a.m,g)}if(g=vp(a.h,c))ac(g.b,c),zq(a,g.b);if(k=a.f.get(c))if(k.qf&&g&&(jp(a.u,k.sinkId,f?f.clientId:a.D,g.session.transportId,b),k.forDisplay&&f&&(a.o={nf:f,rm:g})),a.f.remove(c),a.g.vg(k),qp(a),d)a.g.onPresentationConnectionClosed(c,e,"Remove route");else a.g.onPresentationConnectionStateChanged(c,
"terminated")},rp=function(a,c){c.b.forEach(function(b){if(b=a.f.get(b)){var d=c.session;if(b.forDisplay){var e=xp(d.appId);e&&!b.isLocal?(b.description=d.statusText||"",d.displayName="",d.statusText=""):e||(b.description=d.statusText||d.displayName);c.controller&&Co(c.controller)}a.g.Je(b)}})},Aq=function(a,c){Pb(c,function(b){b=a.f.get(b,null);if(!b||!b.mediaSource)return!1;var d=oo(b.mediaSource);d=d?d.o:!1;return b.isLocal&&!d})&&y(c,function(b){if(b=a.f.get(b,null))b.isLocal=!0})},zq=function(a,
c){var b=[],d=[],e=null;c.forEach(function(f){if(f=a.f.get(f)){f.forDisplay=!1;var g=oo(f.mediaSource);g&&Sb(jo(g),Un)||(f.qf?(g=g?ko(g):null,e||g==chrome.cast.ad.CUSTOM_CONTROLLER_SCOPED||(b.push(f),e=f.sinkId)):e&&e!=f.sinkId?b.push(f):d.push(f))}});y(0<b.length?b:d,function(f){f.forDisplay=!0})},uq=function(a,c,b,d,e){var f=c.b;if(f&&!Xn(a.m,f)){a.l.info("Add client "+f);var g=jo(c);a.m.b.push(new Zp(b,f,g,ko(c),d||null,Ia(e)?e:null))}},sp=function(a,c,b,d,e,f,g,k){var m=Vm(a.h,b.getId());if(!m){var p=
a.h;m=b.getId();p.l.info("Adding new session: "+m+", "+e.sessionId);var v=ap(p,e.sessionId);v?(On(e)?(v.w=e,v.h=m):On(v.session)&&(v.w=v.session,v.h=v.sinkId,v.session=e,v.sinkId=m),m=v):(m=new iq(m,e),p.b.push(m))}k&&k.isLocal&&k.nb&&(m.g=!1);var A=null!=c;if(!A&&Un(e.appId))return null;null==c?(v=new fo([{appId:e.appId,capabilities:e.capabilities}]),c=lo(v)[0]):v=oo(c);if(p=k){if(!a.f.get(p.id))return a.l.G("Route "+p.id+" not added"),p}else p=Gp(c,b,d||e.sessionId,A),a.f.set(p.id,p);d=p.id;a.l.info("Add route "+
d);c=null;v&&(c=v.b,uq(a,v,d,f,g));Ub(m.b,d)||m.b.push(d);p.qf&&(f=a.u,g=c||a.D,d=e.transportId,v=!(v&&v.o),(A=Ym(f,b))&&Rp(f.g,A,g,d,v));m.offTheRecord=p.offTheRecord;f=m.b;Aq(a,f);zq(a,f);f=p;g=e.sessionId;xp(e.appId)?f.isLocal&&g&&f.nb?f.nb.sessionId=g:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.g.Je(p):a.g.Hf(a,p);qp(a);if(k=c)Ub(m.f,c)?k=!1:(m.f.push(c),k=!0);k&&(a=a.j,ao(a.f,c,new Vn("new_session",e)),dp(a,e,b));return p};
qq.prototype.terminateRoute=function(a){var c=this,b=this.f.get(a);if(!b)return Promise.reject(new nq(3,"Route in Cast provider not found for routeId  "+a));var d=vp(this.h,a);if(!d)return cp(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.qa(b.sinkId);if(!f)return Wm(this.j,e),Promise.resolve();(a=aq(this.m,a))&&So(this.j,a.clientId,f,chrome.cast.Vf.STOP);uo(0);return new Promise(function(g){var k=function(){op(c.j,f.getId());g()};c.C.sendRequest(new kn(e),f,Kl).then(k,k)})};
var Bq=function(a,c){var b=null;Dm(a.f.Jb(!1),function(f){if(!f.qf)return!1;var g=a.b.qa(f.sinkId);if(!g||!no(c,xq(f.mediaSource,g)))return!1;b=f;return!0});if(!b||!b.mediaSource)return null;var d=po(b.mediaSource);if(!d)return null;var e=Xn(a.m,d);return e?(d=kq(a.h,d))?{nf:e,rm:d}:null:null},yq=function(a,c,b,d,e,f,g){var k=null;Dm(a.f.Jb(!1),function(p){var v=p.nb;return v&&null!=v.tabId&&v.tabId==d&&Zi(p.mediaSource)?(k=p,!0):!1});if(!k)return null;var m=function(){return a.createRoute(c,g||k.sinkId,
"",e,f,b,null==d?void 0:d)};return qi(a.terminateRoute(k.id).then(m,m))};h=qq.prototype;h.connectRouteByRouteId=function(a,c,b,d,e){if(!oo(a))return pi(Error("Unsupported presentation URL"));if(!c)return pi(Error("No routeId"));c=Dp(c);c=ap(this.h,c.b);if(!c)return pi(Error("No matching route"));var f=this.b.qa(c.sinkId);return f?(a=sp(this,a,f,b,c.session,d,e))?oi(a):pi(Error("Failed to create route")):pi(Error("No sink"))};
h.joinRoute=function(a,c,b,d,e,f){var g=oo(a);if(!g)return pi(Error("Unsupported presentation URL"));if(c==chrome.cast.Kj){a:{var k=Bq(this,g);if(!k){if(!this.o||this.o.nf.origin!=e||this.o.nf.tabId!=f){k=null;break a}k=this.o}switch(ko(g)){case chrome.cast.ad.PAGE_SCOPED:k=null;break a;case chrome.cast.ad.ORIGIN_SCOPED:if(e!=k.nf.origin){k=null;break a}break;case chrome.cast.ad.TAB_AND_ORIGIN_SCOPED:if(e!=k.nf.origin||f!=k.nf.tabId){k=null;break a}}k=ap(this.h,k.rm.session.sessionId)}if(!k&&(g.g?
g.g:chrome.cast.Yg.CREATE_SESSION)!=chrome.cast.Yg.CAST_THIS_TAB&&(d=yq(this,a,e,f,b,d)))return d}else k=Cq(this,c);if(!k)return pi(Error("No matching route"));if(k.offTheRecord!=b)return pi(Error("Off the record mismatch"));d=this.b.qa(k.sinkId);if(!d)return pi(Error("No sink"));a=sp(this,a,d,c,k.session,e,f);a.offTheRecord=b;return oi(a)};h.detachRoute=function(a){cp(this,a,!1,!0)};
h.uf=function(a){var c=this.b.qa(a);if(!c)throw Error("Cannot mirror with no sink.");var b=new tj;c=c.b;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;uj(b);Object.freeze(b);this.l.info(function(){return"Settings for "+a+": "+sj(b)});if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return b};h.Ge=function(){return"cast_streaming"};h.Gh=function(a){var c=this.f.get(a);c&&c.nb&&c.nb.lc&&(a=vp(this.h,a))&&(Hp(a.session,c),a.controller&&Co(a.controller))};
h.sendRouteMessage=function(a,c,b){var d=this;if(!b)return new Promise(function(k,m){"string"!==typeof c&&m(Error("Cannot send non-string messages via ApiHandler."));m=d.j.f;ob(Zn,"Received: "+c);var p=JSON.parse(c),v=p.clientId;"client_connect"==p.type?(ob(Zn,"App "+v),(p=Xn(m.b,v))?(p.b=!0,(m=gn(m.f,p.routeId))&&m.vb.resolve(!0)):Zn.G("Client not found "+v)):Yn(m,v)?(m=m.g[p.type])&&m(p):Zn.G("No route for "+v);k()});var e=vp(this.h,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.qa(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var g=(a=aq(this.m,a))?a.clientId:this.D;return new Promise(function(k){qn(d.u,f,b.namespace,c,g,e.session.transportId).then(k,k)})};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};h.eg=function(a,c){var b=this.b.qa(c);if(!b)return!1;if(!this.w)return!0;a=xq(a,b);return(a=mo(a))&&0!=a.length?Pb(a,function(d){return Ql(ym(b,d))}):!1};
h.mf=function(a,c,b){var d=sq(a);return d&&0!=d.length?c==chrome.cast.Kj?!0:b&&b.mediaSource?(a=mo(b.mediaSource),Pb(a,function(e){return Ub(d,e)})):void 0==c||Cq(this,c)?!0:!1:!1};
var xq=function(a,c,b){return oo(a)?a:aj(a)||bj(a)?(a={appId:0==(c.b&1)?"85CDB22F":"0F5096E8",capabilities:Qn(c.b)},lo(new fo([a],void 0,void 0,void 0,b))[0]):a},sq=function(a){var c=[],b=oo(a);if(b)c=jo(b);else if(aj(a)||bj(a))$i(a)||c.push("85CDB22F"),c.push("0F5096E8");return c},rq=function(a){var c=oo(a);if(!c)return null;a=sq(a);var b=c.m||"";c=c.w;return b&&c?new hn(a,b,JSON.stringify(c)):null},Cq=function(a,c){return 0==c.indexOf(chrome.cast.ek)?ap(a.h,c.substr(chrome.cast.ek.length)):lq(a.h,
c)},Wp=function(a,c,b){var d=a.F;if(Hn(d)&&Pl.hasOwnProperty(b.namespace_)){var e=c.Rb();if(e){var f=JSON.parse(b.data);if("RECEIVER_STATUS"===f.type){var g=f.status&&f.status.applications&&f.status.applications[0],k=f=null;g&&(g.appId&&(f=g.appId),g.sessionId&&(k=g.sessionId));g=d.f.get(e);d.f.set(e,new Gl(e,f,k));g&&g.appId===f||In(d)}}}a=a.j;c=c.getId();Pl.hasOwnProperty(b.namespace_)?kp(a,c,b):lp(a,c,b)},Qm=function(a,c){a.w&&a.w.Fl(c);Xm(a.F);a.g.Vc()};h=qq.prototype;h.Fa=function(){return"cast.Provider"};
h.jb=function(){return[new Dq(this.D,Lm(this.f),this.o)]};h.ib=function(){var a=Vl(this);a&&(this.D=a.g,Fm(this.f,a.f),this.o=a.b)};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(a,c,b){return(a=this.j.createMediaRouteController(a,c,b))?Promise.reject(a):Promise.resolve()};h.provideSinks=function(a){Um(this.b,a)};var qp=function(a){var c=a.rd().some(function(b){return b.isLocal});a.g.Jf(a.Fa(),c)};qq.prototype.l=hb("mr.CastProvider");
var Dq=function(a,c,b){this.g=a;this.f=c;this.b=b};var Eq=function(){this.b=[]};Eq.prototype.listen=function(a,c,b){this.b.push({type:a,Lc:c,target:b})};var Fq=function(a,c,b){var d=a.b.findIndex(function(e){return"internal_message"==e.type&&e.Lc==c&&e.target==b});-1!=d&&a.b.splice(d,1)},Gq=function(a,c){a.b.forEach(function(b){b.type==c.type&&Promise.resolve().then(function(){return b.Lc.call(b.target,c)})})};var Hq=function(a,c,b,d){c="["+c+"]: "+b+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(c):ob(a,c)};var Iq=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},Jq=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};q(Jq,Error);var Lq=function(a){if(void 0===c){Kq||(Kq=new ff(10,2E3));var c=Kq}this.f=a;this.b=c;this.l=hb("mr.dial.Client")};
Lq.prototype.launchApp=function(a,c){var b=this;return this.b.send(Mq(this,a),"POST",c,{timeoutMillis:15E3}).then(function(d){return Nq(b,"launchApp","POST",d)})};
var Pq=function(a,c){return Oq(a,c).then(function(b){return b.resource?b.resource:(a.l.G("stopApp: Resource path for not available for app "+c+": using fallback path."),"run")},function(){a.l.G("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(b){return a.b.send(Mq(a,c)+"/"+b,"DELETE")}).then(function(b){return Nq(a,"stopApp","DELETE",b)})},Oq=function(a,c){return a.b.send(Mq(a,c),"GET",void 0,{Il:3}).then(function(b){Hq(a.l,"GetAppInfo","GET",b);if(!(200<=b.status&&
299>=b.status)){if(404==b.status)throw new Jq;throw Error("Response error: "+b.status);}b=b.responseText;b=(new DOMParser).parseFromString(b,"text/xml");b=b.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:b;if(!b)throw a.l.info("Invalid or empty response"),Error("Invalid or empty response");var d=b.getElementsByTagName("service");if(!d||1!=d.length)throw a.l.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");b=new Iq;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}b.state=g}else"name"==g.nodeName?b.name=g.textContent:"link"==g.localName?b.resource=g.getAttribute("href"):"options"==g.nodeName?b.allowStop="false"!=g.getAttribute("allowStop"):b.extraData[g.nodeName]=g.innerHTML}if("unknown"==b.name)throw a.l.info("GET response missing name value"),Error("GET response missing name value");
if(b.name!=c)throw a.l.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==b.state)throw a.l.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(b.state))&&d[1])b.state="installable",b.b=d[1];else if("running"!=b.state&&"stopped"!=b.state)throw a.l.info("GET response has invalid state value"),Error("GET response has invalid state value");return b})},Mq=function(a,c){a=a.f.Jd;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
c},Nq=function(a,c,b,d){return new Promise(function(e,f){Hq(a.l,c,b,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},Kq=null;var Qq=function(a,c){this.Bc=a;this.appName=c};var Rq=function(a){this.b=new Map;this.f=a};Rq.prototype.init=function(){Yl(this)};Rq.prototype.clear=function(){this.b.clear()};Rq.prototype.add=function(a){if(!this.b.get(a.Bc.id)){this.b.set(a.Bc.id,a);var c=this.f;Sq(c);c.h.Hf(c,a.Bc)}};var Tq=function(a,c){a=l(a.b);for(var b=a.next();!b.done;b=a.next())if(b=l(b.value),b.next(),b=b.next().value,b.Bc.sinkId==c)return b;return null},Vq=function(a,c){var b=a.b.get(c);b&&(a.b.delete(c),Uq(a.f,b))};
Rq.prototype.rd=function(){return Array.from(this.b.values(),function(a){return a.Bc})};Rq.prototype.Fa=function(){return"dial.ActivityRecords"};Rq.prototype.jb=function(){return[Array.from(this.b)]};Rq.prototype.ib=function(){var a=Vl(this);a&&(this.b=new Map(a))};var Wq={St:0,Mx:1,nw:2,Rt:3},Xq=function(a){Cb("MediaRouter.Dial.Create.Route",a,Wq)};var Yq=function(a){this.g=a;this.l=hb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={cg:0,sg:0};this.h=0};Yq.prototype.init=function(){Yl(this)};
var ar=function(a,c){a.l.info("addSinks returned "+c.length+" sinks");ob(a.l,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.keys());c.forEach(function(f){var g=f.sink_id,k=f.extra_data.dial_media_sink,m=Zq.test(k.model_name);f=new um(f.name,g);f.fc=k.ip_address.address_bytes?k.ip_address.address_bytes.join("."):k.ip_address.address.join(".");f.Jd=k.app_url.url;f.uc=k.model_name;f.re=!m;$q(a,f);b.delete(f.getId())});var d=[];b.forEach(function(f){var g=a.b.get(f);d.push(g);
a.b.delete(f)});0<d.length&&a.g.Ni(d);var e=a.b.size;a.f={cg:e,sg:e}},$q=function(a,c){ob(a.l,"mayAddSink, id = "+c.getId());var b=a.b.get(c.getId());b?b.update(c)&&(ob(a.l,"Updated sink "+b.getId()),a.g.yh(b)):(ob(a.l,function(){return"Adding new sink "+c.getId()+": "+("name = "+c.vc.friendlyName+(c.fc?", ip = "+c.fc:"")+(c.uc?", model = "+c.uc:"")+", apps = "+JSON.stringify(c.bc))}),a.b.set(c.getId(),c),a.g.Mi(c))};Yq.prototype.qa=function(a){return this.b.get(a)||null};
var cr=function(a,c){var b=[];a.b.forEach(function(d){"available"==vm(d,c)&&b.push(d.vc)});return new oq(b,br[c])};Yq.prototype.Fe=function(){return this.f};Yq.prototype.Fa=function(){return"dial.DialSinkDiscoveryService"};Yq.prototype.jb=function(){return[new dr(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.h}]};
Yq.prototype.ib=function(){var a=Vl(this);if(a){for(var c=l(a.sinks),b=c.next();!b.done;b=c.next())b=b.value,this.b.set(b[0],wm(b[1]));this.f=a.deviceCounts}if(a=Wl(this))this.h=a.deviceCountMetricsRecordTime};
var br={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},Zq=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
dr=function(a,c){this.sinks=a;this.deviceCounts=c};var er=function(a){return Promise.all(a.map(function(c){return c.then(function(b){return{Pd:!0,value:b}},function(b){return{Pd:!1,reason:b}})}))};var fr=function(a,c){this.l=hb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.w=c;this.j=new Map;this.m=new Map;this.g=null;this.h=!1};fr.prototype.init=function(){Yl(this)};fr.prototype.start=function(){this.l.info("Starting periodic scanning.");this.h||(this.h=!0,gr(this))};fr.prototype.stop=function(){this.l.info("Stopping periodic scanning.");this.h&&(this.h=!1,this.g&&(clearTimeout(this.g),this.g=null),this.j.clear())};
var gr=function(a){a.l.info("Start app status scan.");var c=[];Array.from(a.f.b.values()).forEach(function(b){c.push.apply(c,hr(a,b))});Array.from(a.w.b.values()).forEach(function(b){c.push(ir(a,b))});er(c).then(function(){a.h&&!a.g&&(ob(a.l,"Scan complete; scheduling for next scan."),a.g=setTimeout(function(){ob(a.l,"Start app status scan (timer-based)");a.g=null;gr(a)},6E4))})},hr=function(a,c){if(!c.re)return[];for(var b=[],d=l(a.b),e=d.next();!e.done;e=d.next())b.push(a.o(e.value,c));return b};
fr.prototype.o=function(a,c){var b=this;if("unknown"!=vm(c,a)&&36E5>Date.now()-(c.vh[a]||0)||!c.re)return Promise.resolve();ob(this.l,"Querying "+c.getId()+" for "+a+" to update app status");return jr(this,c,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}kr(b,c,a,d)},function(d){d instanceof
Jq?kr(b,c,a,"unavailable"):(b.l.G("Failed to process app availability; "+c.getId()+" does not support app availability"),c.re=!1)})};
var ir=function(a,c){var b=a.f.qa(c.Bc.sinkId);if(!b)return a.l.G("Activity refers to nonexistent sink: "+c.Bc.id),Promise.resolve();if(!b.re)return Promise.resolve();var d=c.appName;ob(a.l,"Querying "+b.getId()+" for "+d+" to update activity");return jr(a,b,d).then(function(e){"running"!=e.state&&lr(a,b,d)},function(){return lr(a,b,d)})},nr=function(a,c){var b=a.m.get(c.getId());b||(b=new Lq(c),ob(a.l,"Created DIAL client for "+c.getId()),a.m.set(c.getId(),b));return b},jr=function(a,c,b){var d=
or(c,b),e=a.j.get(d);if(e)return e;e=Oq(nr(a,c),b);a.j.set(d,e);c=function(){a.j.delete(d)};e.then(c,c);return e},or=function(a,c){return a.getId()+":"+c},kr=function(a,c,b,d){ob(a.l,"Got app status "+d+" from "+c.getId()+" for "+b);var e=vm(c,b);c.bc[b]=d;c.vh[b]=Date.now();d!=e&&a.f.g.yh(c)},lr=function(a,c,b){(c=Tq(a.w,c.getId()))&&c.appName==b&&Vq(a.w,c.Bc.id)},pr=function(a,c){return Array.from(a.f.b.values()).some(function(b){return"unknown"==vm(b,c)})};fr.prototype.Fa=function(){return"dial.AppDiscoveryService"};
fr.prototype.jb=function(){return[Array.from(this.b)]};fr.prototype.ib=function(){var a=Vl(this);this.b=new Set(a||[])};var qr=function(a,c){this.appName=a;this.launchParameter=void 0===c?"":c},tr=function(a){try{var c=new URL(a)}catch(b){return rr.info("Invalid URL: "+a),null}switch(c.protocol){case "dial:":a:if(a=c.pathname,a.match(/^\w+$/)){if(c=c.searchParams.get("postData")||void 0)try{c=jm(c)}catch(b){rr.G("Invalid base64 encoded postData:"+c);a=null;break a}a=new qr(a,c)}else rr.G("Invalid app name: "+a),a=null;return a;case "https:":return sr(c);default:return ob(rr,"Unhandled protocol: "+c.protocol),null}},
sr=function(a){var c=a.hash;if(!c)return null;a=(a=ur.exec(c))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(c=(c=vr.exec(c))?c[1]:void 0)try{c=jm(c)}catch(b){return rr.G("Invalid base64 encoded postData:"+c),null}return new qr(a,c)},rr=hb("mr.dial.PresentationUrl"),ur=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,vr=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var wr=function(a,c){this.h=a;this.f=c||new Yq(this);this.g=new Rq(this);this.b=null;this.l=hb("mr.DialProvider")};h=wr.prototype;h.getName=function(){return"dial"};h.Fe=function(){return this.f.Fe()};h.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.l.info("Dial sink query enabled: "+a+"...");this.g.init();this.f.init();a?(this.b=this.b||new fr(this.f,this.g),this.b.init()):this.b=null;Sq(this)};
h.ng=function(a){if(!this.b)return pq;ob(this.l,"GetAvailableSinks for "+a);return(a=tr(a))?cr(this.f,a.appName):pq};h.startObservingMediaSinks=function(a){if(this.b){var c=tr(a);if(c){a=this.b;c=c.appName;if(!a.b.has(c)||pr(a,c))a.b.add(c),0!=a.f.b.size&&(a.h?Array.from(a.f.b.values()).forEach(a.o.bind(a,c)):a.start());Sq(this)}}};h.stopObservingMediaSinks=function(a){this.b&&(a=tr(a))&&(this.b.b.delete(a.appName),xr(this))};h.startObservingMediaRoutes=function(){Sq(this)};
h.stopObservingMediaRoutes=function(){xr(this)};var xr=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.g.b.size)&&a.b.stop()},Sq=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.g.b.size)&&a.b.start()};h=wr.prototype;h.qa=function(a){return(a=this.f.qa(a))?a.vc:null};h.rd=function(){return this.g.rd()};
h.createRoute=function(a,c,b,d){var e=this,f=this.f.qa(c);if(!f)return Xq(0),pi(Error("Unkown sink: "+c));rm().f=new om(f.uc,f.Rb());var g=tr(a);if(!g)return pi(Error("No app name set."));var k=g.appName,m=new Lq(f);return qi(Oq(m,k).then(function(p){if("running"==p.state)return Pq(m,k)}).then(function(){return m.launchApp(k,g.launchParameter)}).then(function(){return yr(e,c,a,k,b,d)}).catch(function(p){Xq(3);throw p;}))};h.joinRoute=function(){return pi(Error("Not supported"))};
h.connectRouteByRouteId=function(){return pi(Error("Not supported"))};h.detachRoute=function(){};var yr=function(a,c,b,d,e,f){Xq(1);c=Fp(e,a.getName(),c,b,!0,d);c.offTheRecord=f;a.g.add(new Qq(c,d));return c};wr.prototype.Mi=function(a){this.h.onSinkAvailabilityUpdated(this,1);this.b&&(Sq(this),hr(this.b,a));this.h.Vc();rm().b=new om(a.uc,a.Rb())};
wr.prototype.Ni=function(a){var c=this;if(0==this.f.b.size)this.h.onSinkAvailabilityUpdated(this,0);xr(this);a.forEach(function(b){var d=c.g;b=b.getId();if(b=Tq(d,b))d.b.delete(b.Bc.id),Uq(d.f,b)});this.h.Vc()};wr.prototype.yh=function(){this.h.Vc()};var Uq=function(a,c){c=c.Bc;if(c.isLocal)a.h.onPresentationConnectionStateChanged(c.id,"terminated");xr(a);a.h.vg(c)};h=wr.prototype;
h.terminateRoute=function(a){var c=this.g.b.get(a)||null;if(!c)return Promise.reject(new nq(3,"Route in DIAL provider not found for routeId "+a));Vq(this.g,a);return(a=this.f.qa(c.Bc.sinkId))?Pq(new Lq(a),c.appName):Promise.reject(new nq(3,"Sink in DIAL provider not found for sinkId "+c.Bc.sinkId))};h.uf=function(){throw Error("Not implemented.");};h.Ge=function(){return null};h.Gh=function(){};h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};
h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.eg=function(a,c){c=this.f.qa(c);return!c||aj(a)?!1:(a=tr(a))?"available"==vm(c,a.appName):!1};h.mf=function(){return!1};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(){return eb()};h.provideSinks=function(a){ar(this.f,a)};var zr=function(a){this.m=new Yq(this);this.g=new Gm;this.f=a;this.w=this.j=0;this.h=new Cn;this.b=new wr(this,this.m)};h=zr.prototype;h.Fa=function(){return"cast.DialProviderWrapper"};h.jb=function(){return[new Ar(Lm(this.g),this.j,this.w,this.h.ma())]};h.ib=function(){var a=Vl(this);a&&(Fm(this.g,a.f),this.j=a.sequenceNumber,this.w=a.g,Bn(this.h,a.b))};h.getName=function(){return this.b.getName()};h.initialize=function(a){this.b.initialize(a);Yl(this)};h.rd=function(){return this.b.rd()};
h.ng=function(a){return(a=Br(a))?this.b.ng(a):pq};h.startObservingMediaSinks=function(a){(a=Br(a))&&this.b.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){(a=Br(a))&&this.b.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){(a=Br(a))&&this.b.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){(a=Br(a))&&this.b.stopObservingMediaRoutes(a)};h.qa=function(a){return this.b.qa(a)};
var Er=function(a,c,b,d,e){var f=Br(c);if(!f)return Promise.reject(Error("Invalid source"));var g=tr(f),k=a.m.qa(b);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var m=g.appName;if(!m)return Promise.reject(Error("No app name given"));var p=Cr(c);return p?Oq(new Lq(k),m).then(function(v){var A=yr(a.b,b,c,m,e,d);v={routeId:A.id,sinkId:k.getId(),appName:m,wk:v,launchParameter:g.launchParameter,session:null,clientId:null};a.g.set(A.id,v);var H=Dr(a,v.sinkId),E=new Vn("receiver_action",
{receiver:H,action:chrome.cast.Vf.CAST});E.clientId=p;a.f.Td(v.routeId,E);E=chrome.cast.aa;var R=String(a.w);a.w=(a.w+1)%9007199254740992;H=new E(R,"",v.appName,[],H);v.session=H;v.clientId=p;H=new Vn("new_session",H);H.clientId=p;a.f.Td(v.routeId,H);return A}):Promise.reject(Error("No client ID"))};zr.prototype.createRoute=function(a,c,b,d,e,f,g){return a.startsWith("cast-dial:")||Fr.test(a)?qi(Er(this,a,c,d,b)):this.b.createRoute(a,c,b,d,e,f,g)};
zr.prototype.terminateRoute=function(a){var c=this.g.get(a);if(c&&c.session&&c.clientId){var b={receiver:Dr(this,c.sinkId),action:chrome.cast.Vf.STOP};b=new Vn("receiver_action",b);b.clientId=c.clientId;this.f.Td(c.routeId,b);this.f.onPresentationConnectionStateChanged(c.routeId,"terminated")}return this.b.terminateRoute(a)};
zr.prototype.sendRouteMessage=function(a,c,b){var d=JSON.parse(c);switch(d.type){case "client_connect":return c=d.clientId,(a=this.g.get(a))?(b=Dr(this,a.sinkId),b.receiverType=chrome.cast.Zg.DIAL,b=new Vn("custom_dial_launch",new chrome.cast.Qj(b,a.wk.state,a.wk.extraData)),b.clientId=c,c=this.j,this.j=(this.j+1)%9007199254740992,b.sequenceNumber=c,this.h.add(b.sequenceNumber),this.f.Td(a.routeId,b),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),a;case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return this.h.remove(d.sequenceNumber),
c=d.message,(a=this.g.get(a))?c&&!c.doLaunch?a=Promise.resolve():(b=this.m.qa(a.sinkId))?(b=new Lq(b),d=a.launchParameter,d=(c?c.launchParameter:null)||d,a=b.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return this.terminateRoute(a),Promise.resolve()}return this.b.sendRouteMessage(a,c,b)};
zr.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var Dr=function(a,c){a=a.m.qa(c);c=sm(rm(),c);c=new chrome.cast.Uh(c,a.vc.friendlyName);c.ipAddress=a.Rb();c.receiverType=chrome.cast.Zg.DIAL;return c};h=zr.prototype;h.uf=function(a){return this.b.uf(a)};h.Ge=function(a){return this.b.Ge(a)};h.Gh=function(){};h.eg=function(a,c){return a.startsWith("cast-dial:")||Fr.test(a)||this.b.eg(a,c)};
h.mf=function(a,c,b){return this.b.mf(a,c,b)};h.connectRouteByRouteId=function(a,c,b,d,e){return this.b.connectRouteByRouteId(a,c,b,d,e)};h.joinRoute=function(a,c,b,d,e,f){return this.b.joinRoute(a,c,b,d,e,f)};h.detachRoute=function(a){this.g.remove(a);this.b.detachRoute(a)};h.Vc=function(){this.f.Vc()};h.onSinkAvailabilityUpdated=function(a,c){this.f.onSinkAvailabilityUpdated(a,c)};h.Hf=function(a,c){this.f.Hf(this,c)};h.vg=function(a){this.f.vg(a)};h.Je=function(a){this.f.Je(a)};h.Ci=function(){};
h.getMirroringServiceHostForTab=function(){};h.getMirroringServiceHostForDesktop=function(){};h.getMirroringServiceHostForOffscreenTab=function(){};h.Td=function(a,c){this.f.Td(a,c)};h.onPresentationConnectionStateChanged=function(a,c){this.f.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.f.onPresentationConnectionClosed(a,c,b)};h.wi=function(a){return this.f.wi(a)};h.yi=function(){return this.f.yi()};h.Ke=function(a){this.f.Ke(a)};
h.Fh=function(a,c){this.f.Fh(a,c)};h.Hh=function(a){this.f.Hh(a)};h.Mi=function(a){this.b.Mi(a)};h.Ni=function(a){this.b.Ni(a)};h.yh=function(a){this.b.yh(a)};h.Qi=function(){};h.yl=function(){};h.searchSinks=function(a,c){return this.b.searchSinks(a,c)};h.provideSinks=function(a){this.b.provideSinks(a)};h.createMediaRouteController=function(){return eb()};h.Jf=function(a,c){return this.f.Jf(a,c)};h.Fe=function(){return this.b.Fe()};
var Br=function(a){try{var c=new URL(a)}catch(e){return null}if("dial:"==c.protocol)return a;if("cast-dial:"==c.protocol){var b=c;a="cast-dial:"!=b.protocol?null:new co(b.pathname,b.searchParams.get("dialPostData"),b.searchParams.get("clientId"));b=a.g;var d=a.b}else if("https:"==c.protocol){a=oo(a);if(!a)return null;b=a.u;d=a.D}b?(a=d||"",b=new URL("dial:"+b),a&&b.searchParams.set("postData",a),b=b.toString()):b=null;return b},Cr=function(a){try{var c=new URL(a)}catch(b){return null}return"cast-dial:"==
c.protocol?c.searchParams.get("clientId"):"https:"==c.protocol?po(a):null},Ar=function(a,c,b,d){this.f=a;this.sequenceNumber=c;this.g=b;this.b=d},Fr=/__dialAppName__/;var Gr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Hr=function(a,c){if(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].indexOf("="),e=null;if(0<=d){var f=a[b].substring(0,d);e=a[b].substring(d+1)}else f=a[b];c(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},Ir=function(a,c,b){b=null!=b?"="+encodeURIComponent(String(b)):"";if(c+=b){b=a.indexOf("#");0>b&&(b=a.length);var d=a.indexOf("?");if(0>d||d>b){d=b;var e=""}else e=
a.substring(d+1,b);a=[a.substr(0,d),e,a.substr(b)];b=a[1];a[1]=c?b?b+"&"+c:c:b;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},Jr=/#|$/,Kr=function(a,c){var b=a.search(Jr);a:{var d=0;for(var e=c.length;0<=(d=a.indexOf(c,d))&&d<b;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>b)e=b;d+=c.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},Lr=function(a,c){var b=a.length-1;0<=b&&
a.indexOf("/",b)==b&&(a=a.substr(0,a.length-1));hd(c,"/")&&(c=c.substr(1));return qe(a,"/",c)};var Mr=function(a){this.oc=this.w=this.g="";this.La=null;this.h=this.b="";this.j=!1;var c;a instanceof Mr?(this.j=Ia(void 0)?void 0:a.j,Nr(this,a.g),this.w=a.w,this.oc=a.oc,Or(this,a.yb()),this.b=a.b,Pr(this,a.f.clone()),this.h=a.h):a&&(c=String(a).match(Gr))?(this.j=!1,Nr(this,c[1]||"",!0),this.w=Qr(c[2]||""),this.oc=Qr(c[3]||"",!0),Or(this,c[4]),this.b=Qr(c[5]||"",!0),Pr(this,c[6]||"",!0),this.h=Qr(c[7]||"")):(this.j=!1,this.f=new Rr(null,this.j))};
Mr.prototype.toString=function(){var a=[],c=this.g;c&&a.push(Sr(c,Tr,!0),":");var b=this.oc;if(b||"file"==c)a.push("//"),(c=this.w)&&a.push(Sr(c,Tr,!0),"@"),a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.yb(),null!=b&&a.push(":",String(b));if(b=this.b)this.oc&&"/"!=b.charAt(0)&&a.push("/"),a.push(Sr(b,"/"==b.charAt(0)?Ur:Vr,!0));(b=this.f.toString())&&a.push("?",b);(b=this.h)&&a.push("#",Sr(b,Wr));return a.join("")};
Mr.prototype.resolve=function(a){var c=this.clone(),b=!!a.g;b?Nr(c,a.g):b=!!a.w;b?c.w=a.w:b=!!a.oc;b?c.oc=a.oc:b=null!=a.La;var d=a.b;if(b)Or(c,a.yb());else if(b=!!a.b){if("/"!=d.charAt(0))if(this.oc&&!this.b)d="/"+d;else{var e=c.b.lastIndexOf("/");-1!=e&&(d=c.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=hd(e,"/");e=e.split("/");for(var f=[],g=0;g<e.length;){var k=e[g++];"."==k?d&&g==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&g==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}b?c.b=d:b=""!==a.f.toString();b?Pr(c,a.f.clone()):b=!!a.h;b&&(c.h=a.h);return c};Mr.prototype.clone=function(){return new Mr(this)};var Nr=function(a,c,b){a.g=b?Qr(c,!0):c;a.g&&(a.g=a.g.replace(/:$/,""))};Mr.prototype.yb=function(){return this.La};
var Or=function(a,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);a.La=c}else a.La=null},Pr=function(a,c,b){c instanceof Rr?(a.f=c,Xr(a.f,a.j)):(b||(c=Sr(c,Yr)),a.f=new Rr(c,a.j))},Qr=function(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Sr=function(a,c,b){return Ja(a)?(a=encodeURI(a).replace(c,Zr),b&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Zr=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
Tr=/[#\/\?@]/g,Vr=/[#\?:]/g,Ur=/[#\?]/g,Yr=/[#\?@]/g,Wr=/#/g,Rr=function(a,c){this.f=this.b=null;this.g=a||null;this.h=!!c},$r=function(a){a.b||(a.b=new Gm,a.f=0,a.g&&Hr(a.g,function(c,b){a.add(decodeURIComponent(c.replace(/\+/g," ")),b)}))},bs=function(a){var c=wn(a);if("undefined"==typeof c)throw Error("Keys are undefined");var b=new Rr(null,void 0);a=vn(a);for(var d=0;d<c.length;d++){var e=c[d],f=a[d];Va(f)?as(b,e,f):b.add(e,f)}return b};h=Rr.prototype;h.Aa=function(){$r(this);return this.f};
h.add=function(a,c){$r(this);this.g=null;a=cs(this,a);var b=this.b.get(a);b||this.b.set(a,b=[]);b.push(c);this.f+=1;return this};h.remove=function(a){$r(this);a=cs(this,a);return Jm(this.b,a)?(this.g=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};h.clear=function(){this.b=this.g=null;this.f=0};h.Nb=function(){$r(this);return 0==this.f};var ds=function(a,c){$r(a);c=cs(a,c);return Jm(a.b,c)};h=Rr.prototype;h.pf=function(a){var c=this.ma();return Ub(c,a)};
h.forEach=function(a,c){$r(this);this.b.forEach(function(b,d){y(b,function(e){a.call(c,e,d,this)},this)},this)};h.xb=function(){$r(this);for(var a=this.b.ma(),c=this.b.xb(),b=[],d=0;d<c.length;d++)for(var e=a[d],f=0;f<e.length;f++)b.push(c[d]);return b};h.ma=function(a){$r(this);var c=[];if(Ja(a))ds(this,a)&&(c=dc(c,this.b.get(cs(this,a))));else{a=this.b.ma();for(var b=0;b<a.length;b++)c=dc(c,a[b])}return c};
h.set=function(a,c){$r(this);this.g=null;a=cs(this,a);ds(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[c]);this.f+=1;return this};h.get=function(a,c){if(!a)return c;a=this.ma(a);return 0<a.length?String(a[0]):c};var as=function(a,c,b){a.remove(c);0<b.length&&(a.g=null,a.b.set(cs(a,c),z(b)),a.f+=b.length)};
Rr.prototype.toString=function(){if(this.g)return this.g;if(!this.b)return"";for(var a=[],c=this.b.xb(),b=0;b<c.length;b++){var d=c[b],e=encodeURIComponent(String(d));d=this.ma(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.g=a.join("&")};Rr.prototype.clone=function(){var a=new Rr;a.g=this.g;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var cs=function(a,c){c=String(c);a.h&&(c=c.toLowerCase());return c},Xr=function(a,c){c&&!a.h&&($r(a),a.g=null,a.b.forEach(function(b,d){var e=d.toLowerCase();d!=e&&(this.remove(d),as(this,e,b))},a));a.h=c};Rr.prototype.extend=function(a){for(var c=0;c<arguments.length;c++)yn(arguments[c],function(b,d){this.add(d,b)},this)};var es=function(a,c){this.input=a;this.domain=c};var fs=function(a){this.b=a;this.l=hb("mr.ExternalMessageHandler")};
fs.prototype.onMessage=function(a,c,b){var d=this;this.l.info("Received a message from "+c.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new es(a.meetingName,a.domain)).then(function(f){var g="PresentationId"+c.id+gs++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",f,g).then(function(k){b(new pf(e,"route",k.id))}).catch(function(k){b(new pf(e,"error",k))})},function(){b(new pf(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){b(new pf(e,"stopped"))}):"subscribe_log_data"==a.type?(jb.push(function(f){chrome.runtime.sendMessage(c.id,new pf(e,"log_message",f))}),b(new pf(e,"subscribed"))):(b(new pf(e,"error",Error("Unhandled message type"))),this.l.error("Unhandled message type "+a.type))};var gs=0;var hs=function(){this.b=[];this.f=[]};h=hs.prototype;h.enqueue=function(a){if(1E3<=this.Aa()){if(this.Nb())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};h.Aa=function(){return this.b.length+this.f.length};h.Nb=function(){return 0==this.Aa()};h.ma=function(){var a=this.b.slice();a.reverse();a.push.apply(a,n(this.f));return a};h.clear=function(){this.b=[];this.f=[]};var is=function(){this.b=new hs;this.f=Date.now()},ks=function(){null==js&&(js=new is);return js};is.prototype.init=function(){ib=1;var a=hb("browser"),c=window.onerror;window.onerror=function(d,e,f,g,k){c&&c(d,e,f,g,k);a.error("Error: "+d+" ("+e+" @ Line: "+f+")",k)};jb.push(this.h.bind(this));var b=window.localStorage["debug.logs"];b&&(ib=qb(b.toUpperCase()));(b=window.localStorage["debug.console"])&&"false"!=b.toLowerCase()&&jb.push(this.g.bind(this))};
is.prototype.h=function(a){this.b.enqueue(ls(this,a,!1));a=a.zc;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};is.prototype.g=function(a){var c=[ls(this,a,!0)];a.zc&&c.push(a.zc);switch(a.level){case 3:console.error.apply(console,n(c));break;case 2:console.warn.apply(console,n(c));break;case 1:console.log.apply(console,n(c));break;default:console.debug.apply(console,n(c))}};
var ls=function(a,c,b){var d=["["];if(b)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(c.time);var e=function(f){return 10>f?"0"+f:f};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",pb[c.level],"][",c.O,"] ",c.message);if(!b&&null!=c.zc)if(d.push("\n"),c.zc instanceof Error)d.push(c.zc.message);else try{d.push(JSON.stringify(c.zc))}catch(f){d.push(c.zc.toString())}d.push("\n");
return d.join("")},ms=function(){var a=ks();return 0==a.b.Aa()?"NA":a.b.ma().join("")},ns=function(){var a=ks();Yl(a)};is.prototype.Fa=function(){return"LogManager"};is.prototype.jb=function(){return[this.b.ma()]};is.prototype.ib=function(){var a=this.b.ma();this.b.clear();for(var c=l(Vl(this)||[]),b=c.next();!b.done;b=c.next())this.b.enqueue(b.value);a=l(a);for(b=a.next();!b.done;b=a.next())this.b.enqueue(b.value)};var js=null;var os=function(a){this.b=a;this.l=hb("mr.InternalMessageHandler")};
os.prototype.onMessage=function(a,c,b){var d=this;if("retrieve_log_data"!=a.type)b(new pf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:ms(),device:tm()};c=[];var f=of(e.device.ip).then(function(k){k.b&&(e.device.version=k.b)});c.push(f);var g=this.b.u;g&&(a=ps(this,g,a.source).then(function(k){k&&(e.castStreamingLogs=k)},function(){d.l.error("Log upload failed for service: "+g)}),c.push(a));e.dialDeviceCounts=qs(this);c.push(rs(this,e));a=this.b.getMediaSinkServiceStatus().then(function(k){e.mediaSinkServiceStatus=
k.status},function(){d.l.error("Fail to get media sink service status")});c.push(a);e.dialogType=this.b.H;er(c).then(function(){b(e)})}};var rs=function(a,c){return Pi("mr.cast.SinkDiscoveryService").then(function(b){b=b.Fe();c.castDeviceCounts=b.sg+"."+b.cg},function(){a.l.error("Failed to get device counts for castDeviceCounts.")})},qs=function(a){a=ss(a.b,"dial");if(!a)return"";a=a.Fe();return a.sg+"."+a.cg},ps=function(a,c,b){return ts(a.b,c).then(function(d){return d.bj(b)})};var us={ACCEPTED:0,Ft:1,TIMEOUT:2},vs={SUCCESS:0,Xt:1},ws={mo:0,Kn:1,Xy:2,yu:3,xu:4,Kv:5,TIMEOUT:6,cx:7},xs={vu:0,oy:1},ys={Ew:0,rv:1,USER:2,qu:3},zs=function(a){Cb("MediaRouter.Cloud.Knock.Result",a,us)},As=function(a){Cb("MediaRouter.Cloud.Session.Start",a,vs)},Bs=function(a){Cb("MediaRouter.Cloud.Session.Type",a,xs)},Cs=function(a){Cb("MediaRouter.Cloud.Device.UserRole",a,ys)};var Ds=function(a,c){this.b=a;this.f=c},Es=new Ds("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Fs=new Ds("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Gs=new Ds("https://www.googleapis.com/calendar/v3",""),Hs=new Ds("https://www.googleapis.com/hangouts/v1",""),Is=new Ds("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Js=function(a,c,b,d,e,f){b=void 0===b?null:b;a||null==b&&(b="default");this.rl=a;this.Ka=c;this.oc=b;this.Cf=void 0===d?null:d;this.Mc=void 0===e?null:e;this.Re=void 0===f?null:f};Js.prototype.f=function(){var a="";this.Mc?a=this.Mc:this.Cf&&(a=this.Cf);return a};Js.prototype.xd=function(){return this.rl};Js.prototype.getId=function(){return this.Ka};Js.prototype.merge=function(a){!this.Re&&a.Re&&(this.Re=a.Re);!this.Mc&&a.Mc&&(this.Mc=a.Mc);this.Mc&&a.Mc&&this.Re&&(this.Mc=a.Mc)};var Ks=function(a,c){this.f=a;this.g=c;this.l=hb("mr.cloud.calendar.CalendarService")},Os=function(a){return Ls(a,a.g.b).then(function(c){a.l.info(Ms(c.length)+" events discovered before filtering.");return Ns(a,c)},function(c){a.l.G("Error getting Hangouts from calendar.",c);return[]})},Ms=function(a){return 20<a?"20+":a.toString()},Ls=function(a,c){var b=Date.now();return Ps(a,c,new Date(b),new Date(b+9E5)).then(function(d){return d.filter(a.b)})};
Ks.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var Ps=function(a,c,b,d){c=Qs(Gs.b,["calendars",c,"events"],{timeMin:b.toJSON(),timeMax:d.toJSON(),singleEvents:!0});ob(a.l,"Retrieving Hangouts from Calendar: "+c);return Rs(a.f,c,"GET").then(function(e){return e.items?e.items:[]})},Ns=function(a,c){var b=[];c.filter(function(d){return d.hangoutLink}).forEach(function(d){var e=new Mr(d.hangoutLink);if("meet.google.com"==e.oc)b.push(new Js(!0,e.b.substring(1),void 0,void 0,d.summary));else if(e=e.b.substring(12).split("/"),2==e.length){var f=l(e);
e=f.next().value;f=f.next().value;if(-1!=e.indexOf(".")){var g=f;var k=e}b.push(new Js(!1,f+"@"+e,k,g,d.summary,void 0))}else a.l.G("Invalid hangout link from calendar event: "+d.hangoutLink)});a.l.info(Ms(b.length)+" events discovered with Hangout links.");return b};var Ss=function(a){this.b=a;this.id=a.id;this.l=hb("mr.cloud.devices.WeaveDevice")};Ss.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,c="available"==this.getState().appStatus,b=Ts(this,864E5);ob(this.l,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+c+", checked in: "+b);return a&&c&&b}a=Ts(this,9E5);this.l.info("Availability for legacy receiver app: "+a);return a};
var Ts=function(a,c){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-c)};Ss.prototype.f=function(){return this.getState().settings.receiverName};Ss.prototype.getId=function(){return this.id};Ss.prototype.getState=function(){return this.b.state._cloudCast};var Us=function(){this.l=Lf("mr.cloud.GcmRegistrationSerializer");this.b=Promise.resolve("")};Us.prototype.register=function(a){var c=this,b=function(){return new Promise(function(d,e){chrome.gcm.register(a,function(f){f?(c.l.info("Got GCM registration ID: "+f),d(f)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.b=this.b.then(b,b)};var Vs=function(a){this.email=a;this.imageUrl=null},Ws=function(a){this.type=a},Xs=function(a,c,b,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=c||null;this.flungUrl=b||null;this.presentationId=d||null};q(Xs,Ws);
var Ys=function(a,c,b){this.name=a;this.parameters=c;this.minimalRole=null!=b?b:"user"},Zs={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},$s=new Ys("_knockingStartWebrtcSession",Zs,"viewer"),at=new Ys("_startWebrtcSession",Zs),bt=new Ys("_stopSession",{},"viewer");var ct=function(a,c){this.j=a;this.w=c;this.f=this.g=this.b=null;this.h=!1;this.l=hb("mr.cloud.devices.WeaveDevicesService");Yl(this)};ct.prototype.getDevice=function(a){a=Qs(Es.b,["devices",a]);return Rs(this.j,a,"GET").then(function(c){return new Ss(c)})};
var dt=function(a,c){var b=Qs(Es.b,["devices"],c);return Rs(a.j,b,"GET").then(function(d){var e=(d.devices||[]).filter(function(g){return null!=g.commandDefs&&null!=g.commandDefs._cloudCast}).map(function(g){return new Ss(g)});if(d=d.nextPageToken){var f=Kc(c);f.token=d;return dt(a,f).then(function(g){return e.concat(g)})}return e})};ct.prototype.Fa=function(){return"WeaveDevicesService"};ct.prototype.jb=function(){return[new et(this.b,this.f,this.g)]};
ct.prototype.ib=function(){var a=Vl(this);a&&(this.b=a.Kp,this.f=a.gcmRegistrationId,this.g=a.Jp)};var ft=function(a){return a.f&&null!=a.g&&a.g+864E5>=Date.now()?Promise.resolve(a.f):a.w.register(["919648714761"]).then(function(c){ob(a.l,"Got GCM ID: "+c);a.f=c;a.g=Date.now();a.b=null;return c},function(c){a.l.G("Error",c);a.f=null;a.g=null;a.b=null;throw c;})};
ct.prototype.subscribe=function(a){var c=this;if(this.h)return Promise.resolve();this.h=!0;if(!a||this.b&&!(this.b+864E5<Date.now()))return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var b=Qs(Es.b,["subscriptions","subscribe"],{});return Rs(this.j,b,"POST",a).then(function(){ob(c.l,"Subscribed on: "+Date.now());c.b=Date.now();c.h=!1;return Promise.resolve()},function(d){c.h=!1;throw d;})};
var et=function(a,c,b){this.Kp=a;this.gcmRegistrationId=c;this.Jp=b};var gt=function(a,c,b,d,e,f,g,k){var m=sm(rm(),a);this.ob=new Rl(m,c,g,k,e);this.deviceId=a;this.b=b;this.model=d;this.isAvailable=f};ca.Object.defineProperties(gt.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.ob.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.ob.friendlyName=a}}});var ht=function(a,c,b,d,e){gt.call(this,a,c,"weave","Chrome Streaming Receiver",d,e,"education");this.di=b};q(ht,gt);
var it=function(a){var c=a.oc,b;a.Cf&&a.f()!=a.Cf&&(b=a.Cf);gt.call(this,a.getId(),a.f(),"mesi","Hangout",c,!1,a.xd()?"meeting":"hangout",b);this.xd=a.xd();this.Og=a.Re||""};q(it,gt);var jt=function(a,c,b){gt.call(this,a,c,"slarti","Cast Receiver for Education","default",b,"education")};q(jt,gt);var kt=function(a,c,b){this.w=a;this.h=c;this.b=new Map;this.g=new Map;this.f=null;this.j=b};kt.prototype.Ud=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),lt(this);return Array.from(this.b.values())};kt.prototype.qa=function(a){return this.b.get(a)||null};
var lt=function(a){a.w().then(function(c){mt(a,c)})},mt=function(a,c){var b=new Map(a.b),d=new Map,e=new Map,f=[],g=[];c.forEach(function(k){var m=k.id;d.set(m,k);e.set(m,k.deviceId);b.has(m)?b.has(m)&&JSON.stringify(b.get(m))!=JSON.stringify(k)&&g.push(k.ob):f.push(k.ob);b.delete(m)});c=[].concat(n(b.values())).map(function(k){return k.ob});a.g.clear();a.g=e;a.b.clear();a.b=d;nt(a,f,g,c)},nt=function(a,c,b,d){0<c.length&&ot(a.h,c);0<b.length&&pt(a.h,b);0<d.length&&qt(a.h,d)},st=function(a){for(var c=
{},b=l(a.b.entries()),d=b.next();!d.done;d=b.next()){var e=l(d.value);d=e.next().value;e=e.next().value;c[d]=e}b={};d=l(a.g.entries());for(e=d.next();!e.done;e=d.next()){var f=l(e.value);e=f.next().value;f=f.next().value;b[e]=f}return new rt(c,b,a.f)},tt=function(a,c){for(var b in c.sinks){var d=c.sinks[b],e=null;"Hangout"==d.model?e=new it(new Js(d.xd,d.deviceId,d.ob.domain,d.ob.description,d.ob.friendlyName,d.Og)):"Cast Receiver for Education"==d.model?e=new jt(d.deviceId,d.ob.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new ht(d.deviceId,d.ob.friendlyName,d.di,d.ob.domain,d.isAvailable));a.b.set(b,e)}for(b in c.b)a.g.set(b,c.b[b]);c.f&&(a.f=c.f)},rt=function(a,c,b){this.sinks=a;this.b=c;this.f=b};var wt=function(a,c,b){if(!ut){Kf();var d=Jf;d.f=Ff;var e=vt;d.b||(d.b=[]);d.b.push(e);ut=!0}this.g=a;this.h=c;this.b=new kt(this.j.bind(this),b,2E4);this.f=new Map;Yl(this)},vt=function(a){kb({O:a.g,level:rb(a.f.value),time:a.j,message:a.getMessage(),zc:a.b})};wt.prototype.Ud=function(){return this.b.Ud()};wt.prototype.qa=function(a){return this.b.qa(a)};
wt.prototype.j=function(){var a=this;this.l.info("Fetching hangouts");return er([xt(this.h),Os(this.g)]).then(function(c){var b=Array.from(a.f.values());c.forEach(function(e){e.Pd?b=b.concat(e.value):a.l.error("Error discovering Hangouts",e.reason)});var d=b.reduce(function(e,f){var g=e[f.getId()];g?g.merge(f):g=f;e[g.getId()]=g;return e},{});return Object.keys(d).map(function(e){e=d[e];Bb("MediaRouter.Cloud.Hangout.Sink.Discovered");return new it(e)})})};
var zt=function(a,c){return Pi("mr.mirror.hangouts.MeetingsService").then(function(b){return b.pc(c)}).then(function(b){return yt(a,b)},function(){return c.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):yt(a,c.input,c.domain)})},yt=function(a,c,b){b=b||void 0;var d=!b;c=new Js(d,d?c:c+"@"+b,b,c,void 0,void 0);a.f.set(c.getId(),c);c=new it(c);a.b.b.set(c.id,c);return c.ob};wt.prototype.Fa=function(){return"HangoutSinkDiscoveryService"};
wt.prototype.jb=function(){for(var a={},c=l(this.f.entries()),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;a[b]=d}return[{cache:st(this.b),manualHangouts:a}]};wt.prototype.ib=function(){var a=Vl(this);if(a){tt(this.b,a.cache);for(var c in a.manualHangouts){var b=a.manualHangouts[c];this.f.set(c,new Js(b.rl,b.Ka,b.oc,b.Cf,b.Mc,b.Re))}}};wt.prototype.l=hb("mr.cloud.discovery.HangoutSinkDiscoveryService");var ut=!1;var Ct=function(){this.f=!1;this.b=null;this.g=!1;this.l=hb("mr.cloud.identity.IdentityService");Yl(this);At(this);Bt(this)},Dt=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};Ct.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,c){chrome.identity.getAuthToken({interactive:!1},function(b){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==b?c(Error("User is not logged in (no token found)")):a(b)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var Et=function(a){return new Promise(function(c){chrome.identity.removeCachedAuthToken({token:a},function(){c()})})},Bt=function(a){a.getAuthToken().then(function(c){chrome.identity.getProfileUserInfo(function(b){a.f=!!b.email||!!b.id;a.b=b.email||null;c&&!a.f&&(a.g=!0)})},function(c){ob(a.l,"Unable to set sign in and email.",c)})},At=function(a){chrome.identity.onSignInChanged.addListener(function(c,b){Yi(6);a.f=b;a.l.info("Signed in change: "+a.f);a.f?Bt(a):(a.b=null,a.g=!1)})},Ft=function(a){return a.getAuthToken().then(function(c){var b=
window.gapi;if(!b)return a.l.error("gapi not loaded."),!1;a.l.info("Setting gapi auth token");b.auth.setToken({access_token:c});return!0})};Ct.prototype.Fa=function(){return"IdentityService"};Ct.prototype.jb=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.g}]};Ct.prototype.ib=function(){var a=Wl(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.g=a.kioskAuth))};var Gt="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Ht=function(a){var c=a.method,b=a.uri,d=a.baseUrl,e=a.Cc,f=a.am,g=a.headers,k=a.body,m=a.start,p=a.apiKey,v=a.Qg;a=a.hb;this.method=c&&c.toUpperCase()||"GET";(c=b)||(d=[d].concat(n(e||[])).join("/"),d=new Mr(encodeURI(d)),f&&(f=bs(f),Pr(d,f)),c=d);this.uri=c;p&&this.uri.f.add("key",p);this.b=a||null;this.headers=g||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.Qg=Ia(v)?v:1E4;this.start=m||u()},It=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(c){c&&
(a.headers.Authorization="Bearer "+c);c={method:a.method,headers:a.headers};a.body&&(c.body=JSON.stringify(a.body));return new Request(a.uri.toString(),c)})};var Jt={wt:100,sy:101,Aw:200,xt:201,ACCEPTED:202,cw:203,qw:204,xx:205,Kw:206,Qv:207,Pv:300,Mv:301,eu:302,Tx:303,mw:304,Ry:305,vy:307,Rw:308,Om:400,Ey:401,vn:402,du:403,iw:404,Hv:405,fw:406,hx:407,vx:408,st:409,ou:410,nv:411,Zw:412,sx:413,wx:414,Ly:415,ux:416,Pt:417,Ky:422,qv:423,Qt:424,ax:428,yy:429,tx:431,kn:500,jw:501,Es:502,ay:503,ju:504,Eu:505,Qu:507,Wv:511,kx:1223};var Kt=function(a,c){Eb.call(this,c&&c.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.b=c)&&c.status};q(Kt,Eb);var Ot=function(a){if(Lt.has(a.code))return!0;var c=a.b||{};return a.b?Mt.has(c.status)?!0:!!(c.errors||[]).find(function(b){return Nt.has(b)}):!1},Pt=function(a,c){a=new Response(void 0,{status:c||408,statusText:a});return new Kt(a)},Lt=new Set([400,401,403,404,405,406,501]),Mt=new Set(["PERMISSION_DENIED"]),Nt=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var Qt=function(){this.dc=this.dc;this.Za=this.Za};Qt.prototype.dc=!1;Qt.prototype.w=function(){return this.dc};Qt.prototype.Ya=function(){this.dc||(this.dc=!0,this.ha())};Qt.prototype.f=function(a){Rt(this,db(St,a))};var Rt=function(a,c){a.dc?Ia(void 0)?c.call(void 0):c():(a.Za||(a.Za=[]),a.Za.push(Ia(void 0)?t(c,void 0):c))};Qt.prototype.ha=function(){if(this.Za)for(;this.Za.length;)this.Za.shift()()};
var St=function(a){a&&"function"==typeof a.Ya&&a.Ya()},Tt=function(a){for(var c=0,b=arguments.length;c<b;++c){var d=arguments[c];Wa(d)?Tt.apply(null,d):St(d)}};var X=function(a,c){this.type=a;this.g=this.target=c;this.jm=!0};X.prototype.h=function(){this.jm=!1};var Ut=!Ae||9<=Number(Ve),Vt=Ae&&!Ue("9"),Wt=function(){if(!Ha.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ha.addEventListener("test",Qa,c),Ha.removeEventListener("test",Qa,c)}catch(b){}return a}();var Xt=function(a,c){X.call(this,a?a.type:"");this.relatedTarget=this.g=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,c)};x(Xt,X);var Yt=uf({2:"touch",3:"pen",4:"mouse"});
Xt.prototype.init=function(a,c){var b=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.g=c;(c=a.relatedTarget)?Ce&&(ve(c,"nodeName")||(c=null)):"mouseover"==b?c=a.fromElement:"mouseout"==b&&(c=a.toElement);this.relatedTarget=c;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ja(a.pointerType)?a.pointerType:Yt[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.h()};
Xt.prototype.h=function(){Xt.Ca.h.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Vt)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Zt="closure_listenable_"+(1E6*Math.random()|0),$t=function(a){return!(!a||!a[Zt])},au=0;var bu=function(a,c,b,d,e){this.listener=a;this.proxy=null;this.src=c;this.type=b;this.capture=!!d;this.Lc=e;this.key=++au;this.removed=this.hh=!1},cu=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.Lc=null};var du=function(a){this.src=a;this.b={};this.f=0};du.prototype.add=function(a,c,b,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var g=eu(a,c,d,e);-1<g?(c=a[g],b||(c.hh=!1)):(c=new bu(c,this.src,f,!!d,e),c.hh=b,a.push(c));return c};du.prototype.remove=function(a,c,b,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];c=eu(e,c,b,d);return-1<c?(cu(e[c]),$b(e,c),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var fu=function(a,c){var b=c.type;if(!(b in a.b))return!1;var d=ac(a.b[b],c);d&&(cu(c),0==a.b[b].length&&(delete a.b[b],a.f--));return d};du.prototype.removeAll=function(a){a=a&&a.toString();var c=0,b;for(b in this.b)if(!a||b==a){for(var d=this.b[b],e=0;e<d.length;e++)++c,cu(d[e]);delete this.b[b];this.f--}return c};var gu=function(a,c,b,d,e){a=a.b[c.toString()];c=-1;a&&(c=eu(a,b,d,e));return-1<c?a[c]:null};
du.prototype.hasListener=function(a,c){var b=Ia(a),d=b?a.toString():"",e=Ia(c);return Bc(this.b,function(f){for(var g=0;g<f.length;++g)if(!(b&&f[g].type!=d||e&&f[g].capture!=c))return!0;return!1})};var eu=function(a,c,b,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==c&&f.capture==!!b&&f.Lc==d)return e}return-1};var hu="closure_lm_"+(1E6*Math.random()|0),iu={},ju=0,lu=function(a,c,b,d,e){if(d&&d.once)return ku(a,c,b,d,e);if(Va(c)){for(var f=0;f<c.length;f++)lu(a,c[f],b,d,e);return null}b=mu(b);return $t(a)?a.listen(c,b,Ya(d)?!!d.capture:!!d,e):nu(a,c,b,!1,d,e)},nu=function(a,c,b,d,e,f){if(!c)throw Error("Invalid event type");var g=Ya(e)?!!e.capture:!!e,k=ou(a);k||(a[hu]=k=new du(a));b=k.add(c,b,d,g,f);if(b.proxy)return b;d=pu();b.proxy=d;d.src=a;d.listener=b;if(a.addEventListener)Wt||(e=g),void 0===e&&(e=
!1),a.addEventListener(c.toString(),d,e);else if(a.attachEvent)a.attachEvent(qu(c.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");ju++;return b},pu=function(){var a=ru,c=Ut?function(b){return a.call(c.src,c.listener,b)}:function(b){b=a.call(c.src,c.listener,b);if(!b)return b};return c},ku=function(a,c,b,d,e){if(Va(c)){for(var f=0;f<c.length;f++)ku(a,c[f],b,d,e);return null}b=mu(b);return $t(a)?su(a,c,b,Ya(d)?
!!d.capture:!!d,e):nu(a,c,b,!0,d,e)},tu=function(a,c,b,d,e){if(Va(c))for(var f=0;f<c.length;f++)tu(a,c[f],b,d,e);else d=Ya(d)?!!d.capture:!!d,b=mu(b),$t(a)?a.N.remove(String(c),b,d,e):a&&(a=ou(a))&&(c=gu(a,c,b,d,e))&&uu(c)},uu=function(a){if(r(a)||!a||a.removed)return!1;var c=a.src;if($t(c))return fu(c.N,a);var b=a.type,d=a.proxy;c.removeEventListener?c.removeEventListener(b,d,a.capture):c.detachEvent?c.detachEvent(qu(b),d):c.addListener&&c.removeListener&&c.removeListener(d);ju--;(b=ou(c))?(fu(b,
a),0==b.f&&(b.src=null,c[hu]=null)):cu(a);return!0},vu=function(a){if(a)if($t(a))a.qj(void 0);else if(a=ou(a)){var c=0,b;for(b in a.b)for(var d=a.b[b].concat(),e=0;e<d.length;++e)uu(d[e])&&++c}},qu=function(a){return a in iu?iu[a]:iu[a]="on"+a},xu=function(a,c,b,d){var e=!0;if(a=ou(a))if(c=a.b[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var f=c[a];f&&f.capture==b&&!f.removed&&(f=wu(f,d),e=e&&!1!==f)}return e},wu=function(a,c){var b=a.listener,d=a.Lc||a.src;a.hh&&uu(a);return b.call(d,c)},ru=
function(a,c){if(a.removed)return!0;if(!Ut){var b=c||Pa("window.event");c=new Xt(b,this);var d=!0;if(!(0>b.keyCode||void 0!=b.returnValue)){a:{var e=!1;if(0==b.keyCode)try{b.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==b.returnValue)b.returnValue=!0}b=[];for(e=c.g;e;e=e.parentNode)b.push(e);a=a.type;for(e=b.length-1;0<=e;e--){c.g=b[e];var f=xu(b[e],a,!0,c);d=d&&f}for(e=0;e<b.length;e++)c.g=b[e],f=xu(b[e],a,!1,c),d=d&&f}return d}return wu(a,new Xt(c,this))},ou=function(a){a=a[hu];return a instanceof
du?a:null},yu="__closure_events_fn_"+(1E9*Math.random()>>>0),mu=function(a){if(Xa(a))return a;a[yu]||(a[yu]=function(c){return a.handleEvent(c)});return a[yu]};var Y=function(){Qt.call(this);this.N=new du(this);this.Wf=this;this.D=null};x(Y,Qt);Y.prototype[Zt]=!0;h=Y.prototype;h.addEventListener=function(a,c,b,d){lu(this,a,c,b,d)};h.removeEventListener=function(a,c,b,d){tu(this,a,c,b,d)};
h.M=function(a){var c,b=this.D;if(b)for(c=[];b;b=b.D)c.push(b);b=this.Wf;var d=a.type||a;if(Ja(a))a=new X(a,b);else if(a instanceof X)a.target=a.target||b;else{var e=a;a=new X(d,b);Oc(a,e)}e=!0;if(c)for(var f=c.length-1;0<=f;f--){var g=a.g=c[f];e=g.sf(d,!0,a)&&e}g=a.g=b;e=g.sf(d,!0,a)&&e;e=g.sf(d,!1,a)&&e;if(c)for(f=0;f<c.length;f++)g=a.g=c[f],e=g.sf(d,!1,a)&&e;return e};h.ha=function(){Y.Ca.ha.call(this);this.qj();this.D=null};h.listen=function(a,c,b,d){return this.N.add(String(a),c,!1,b,d)};
var su=function(a,c,b,d,e){return a.N.add(String(c),b,!0,d,e)};Y.prototype.qj=function(a){this.N&&this.N.removeAll(a)};Y.prototype.sf=function(a,c,b){a=this.N.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==c){var g=f.listener,k=f.Lc||f.src;f.hh&&fu(this.N,f);d=!1!==g.call(k,b)&&d}}return d&&0!=b.jm};Y.prototype.hasListener=function(a,c){return this.N.hasListener(Ia(a)?String(a):void 0,c)};var zu=function(a,c){this.g=a;this.h=c;this.f=0;this.b=null};zu.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.g();return a};var Au=function(a,c){a.h(c);100>a.f&&(a.f++,c.next=a.b,a.b=c)};var Bu=function(a){Ha.setTimeout(function(){throw a;},0)},Cu,Du=function(){var a=Ha.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Zd("Presto")&&(a=function(){var e=document.createElement("IFRAME");e.style.display="none";ke(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(de(fe));e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;
e=t(function(m){if(("*"==k||m.origin==k)&&m.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!Zd("Trident")&&!Zd("MSIE")){var c=new a,b={},d=b;c.port1.onmessage=function(){if(Ia(b.next)){b=b.next;var e=b.Fk;b.Fk=null;e()}};return function(e){d.next={Fk:e};d=d.next;c.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(e){var f=document.createElement("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){Ha.setTimeout(e,0)}};var Eu=function(){this.f=this.b=null},Gu=new zu(function(){return new Fu},function(a){a.reset()});Eu.prototype.add=function(a,c){var b=Gu.get();b.set(a,c);this.f?this.f.next=b:this.b=b;this.f=b};Eu.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var Fu=function(){this.next=this.scope=this.b=null};Fu.prototype.set=function(a,c){this.b=a;this.scope=c;this.next=null};Fu.prototype.reset=function(){this.next=this.scope=this.b=null};var Lu=function(a,c){Hu||Iu();Ju||(Hu(),Ju=!0);Ku.add(a,c)},Hu,Iu=function(){if(Ha.Promise&&Ha.Promise.resolve){var a=Ha.Promise.resolve(void 0);Hu=function(){a.then(Mu)}}else Hu=function(){var c=Mu;!Xa(Ha.setImmediate)||Ha.Window&&Ha.Window.prototype&&!Zd("Edge")&&Ha.Window.prototype.setImmediate==Ha.setImmediate?(Cu||(Cu=Du()),Cu(c)):Ha.setImmediate(c)}},Ju=!1,Ku=new Eu,Mu=function(){for(var a;a=Ku.remove();){try{a.b.call(a.scope)}catch(c){Bu(c)}Au(Gu,a)}Ju=!1};var Nu=function(a){a.prototype.$goog_Thenable=!0},Ou=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(c){return!1}};var Ru=function(a,c){this.b=0;this.m=void 0;this.h=this.f=this.g=null;this.j=this.w=!1;if(a!=Qa)try{var b=this;a.call(c,function(d){Pu(b,2,d)},function(d){if(!(d instanceof Qu))try{if(d instanceof Error)throw d;throw Error("Promise rejected.");}catch(e){}Pu(b,3,d)})}catch(d){Pu(this,3,d)}},Su=function(){this.next=this.context=this.f=this.h=this.b=null;this.g=!1};Su.prototype.reset=function(){this.context=this.f=this.h=this.b=null;this.g=!1};
var Tu=new zu(function(){return new Su},function(a){a.reset()}),Uu=function(a,c,b){var d=Tu.get();d.h=a;d.f=c;d.context=b;return d},Vu=function(a){if(a instanceof Ru)return a;var c=new Ru(Qa);Pu(c,2,a);return c},Wu=function(a){return new Ru(function(c,b){b(a)})},Yu=function(a,c,b){Xu(a,c,b,null)||Lu(db(c,a))},Zu=function(a){return new Ru(function(c,b){a.length||c(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Yu(e,c,b)})},$u=function(a){return new Ru(function(c,b){var d=a.length,e=[];if(d)for(var f=
function(p,v){d--;e[p]=v;0==d&&c(e)},g=function(p){b(p)},k=0,m;k<a.length;k++)m=a[k],Yu(m,db(f,k),g);else c(e)})},av=function(a){return new Ru(function(c){var b=a.length,d=[];if(b)for(var e=function(k,m,p){b--;d[k]=m?{Pd:!0,value:p}:{Pd:!1,reason:p};0==b&&c(d)},f=0,g;f<a.length;f++)g=a[f],Yu(g,db(e,f,!0),db(e,f,!1));else c(d)})},cv=function(){var a,c,b=new Ru(function(d,e){a=d;c=e});return new bv(b,a,c)};Ru.prototype.then=function(a,c,b){return dv(this,Xa(a)?a:null,Xa(c)?c:null,b)};Nu(Ru);
var fv=function(a,c,b){c=Uu(c,c,b);c.g=!0;ev(a,c);return a},gv=function(a,c,b){return dv(a,null,c,b)};Ru.prototype.cancel=function(a){0==this.b&&Lu(function(){var c=new Qu(a);hv(this,c)},this)};
var hv=function(a,c){if(0==a.b)if(a.g){var b=a.g;if(b.f){for(var d=0,e=null,f=null,g=b.f;g&&(g.g||(d++,g.b==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==b.b&&1==d?hv(b,c):(f?(d=f,d.next==b.h&&(b.h=d),d.next=d.next.next):iv(b),jv(b,e,3,c)))}a.g=null}else Pu(a,3,c)},ev=function(a,c){a.f||2!=a.b&&3!=a.b||kv(a);a.h?a.h.next=c:a.f=c;a.h=c},dv=function(a,c,b,d){var e=Uu(null,null,null);e.b=new Ru(function(f,g){e.h=c?function(k){try{var m=c.call(d,k);f(m)}catch(p){g(p)}}:f;e.f=b?function(k){try{var m=b.call(d,
k);!Ia(m)&&k instanceof Qu?g(k):f(m)}catch(p){g(p)}}:g});e.b.g=a;ev(a,e);return e.b};Ru.prototype.u=function(a){this.b=0;Pu(this,2,a)};Ru.prototype.D=function(a){this.b=0;Pu(this,3,a)};
var Pu=function(a,c,b){0==a.b&&(a===b&&(c=3,b=new TypeError("Promise cannot resolve to itself")),a.b=1,Xu(b,a.u,a.D,a)||(a.m=b,a.b=c,a.g=null,kv(a),3!=c||b instanceof Qu||lv(a,b)))},Xu=function(a,c,b,d){if(a instanceof Ru)return ev(a,Uu(c||Qa,b||null,d)),!0;if(Ou(a))return a.then(c,b,d),!0;if(Ya(a))try{var e=a.then;if(Xa(e))return mv(a,e,c,b,d),!0}catch(f){return b.call(d,f),!0}return!1},mv=function(a,c,b,d,e){var f=!1,g=function(m){f||(f=!0,b.call(e,m))},k=function(m){f||(f=!0,d.call(e,m))};try{c.call(a,
g,k)}catch(m){k(m)}},kv=function(a){a.w||(a.w=!0,Lu(a.o,a))},iv=function(a){var c=null;a.f&&(c=a.f,a.f=c.next,c.next=null);a.f||(a.h=null);return c};Ru.prototype.o=function(){for(var a;a=iv(this);)jv(this,a,this.b,this.m);this.w=!1};
var jv=function(a,c,b,d){if(3==b&&c.f&&!c.g)for(;a&&a.j;a=a.g)a.j=!1;if(c.b)c.b.g=null,nv(c,b,d);else try{c.g?c.h.call(c.context):nv(c,b,d)}catch(e){ov.call(null,e)}Au(Tu,c)},nv=function(a,c,b){2==c?a.h.call(a.context,b):a.f&&a.f.call(a.context,b)},lv=function(a,c){a.j=!0;Lu(function(){a.j&&ov.call(null,c)})},ov=Bu,Qu=function(a){Eb.call(this,a)};x(Qu,Eb);Qu.prototype.name="cancel";var bv=function(a,c,b){this.X=a;this.resolve=c;this.reject=b};var pv=function(a,c){Y.call(this);this.h=a||1;this.g=c||Ha;this.j=t(this.o,this);this.m=u()};x(pv,Y);pv.prototype.enabled=!1;pv.prototype.b=null;var qv=function(a,c){a.h=c;a.b&&a.enabled?(a.stop(),a.start()):a.b&&a.stop()};pv.prototype.o=function(){if(this.enabled){var a=u()-this.m;0<a&&a<.8*this.h?this.b=this.g.setTimeout(this.j,this.h-a):(this.b&&(this.g.clearTimeout(this.b),this.b=null),this.M("tick"),this.enabled&&(this.stop(),this.start()))}};
pv.prototype.start=function(){this.enabled=!0;this.b||(this.b=this.g.setTimeout(this.j,this.h),this.m=u())};pv.prototype.stop=function(){this.enabled=!1;this.b&&(this.g.clearTimeout(this.b),this.b=null)};pv.prototype.ha=function(){pv.Ca.ha.call(this);this.stop();delete this.g};
var rv=function(a,c,b){if(Xa(a))b&&(a=t(a,b));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:Ha.setTimeout(a,c||0)},sv=function(a){Ha.clearTimeout(a)},tv=function(a){var c=null;return gv(new Ru(function(b,d){c=rv(function(){b(void 0)},a);-1==c&&d(Error("Failed to schedule timer."))}),function(b){sv(c);throw b;})};var uv=function(){var a=void 0===a?!0:a;this.l=Lf("mr.cloud.slarti.Fetcher");this.b=0;this.f=a};uv.prototype.execute=function(a){var c=this,b="Fetch call "+ ++this.b,d=new df(function(){return vv(c,b,a,function(e){return d.abort(e)})},1E3,this.f?5:1);return d.start()};
var vv=function(a,c,b,d){var e=b.uri.toString().replace(/\?.*/,"?<redacted>"),f=b.method+" "+e;C(a.l,c+": "+f);e=[It(b).then(function(g){return Promise.resolve(fetch(g))})];b.Qg&&e.push(tv(b.Qg).then(function(){throw Pt("API call timed out",504);}));return Promise.race(e).then(function(g){if(!g.ok)return g.json().then(function(m){return m},function(){return null}).then(function(m){var p;m&&m instanceof Object&&m.error&&(p=m.error);throw new Kt(g,p);});var k=(u()-b.start)/1E3;C(a.l,c+" succeeded: "+
f+" duration = "+k+"s");return(k=g.headers.get("content-type"))&&k.includes("application/json")?g.json():k&&(k.includes("image")||k.includes("application/octet-stream"))?g.blob():g.text()},function(g){var k="";if(g instanceof Kt)k=", ("+g.status+"): "+g.message,Ot(g)&&d(g);else{try{k=", "+JSON.stringify(g,null,2)}catch(m){}g instanceof Error&&"Failed to fetch"==g.message&&(g=Pt(g.message))}Nf(a.l,c+" failed: "+k);throw g;})};var wv=function(a,c){this.b=Fs.b;this.hb=a;this.f=c};var xv=function(a,c){wv.call(this,a,c)};q(xv,wv);xv.prototype.register=function(a){a=new Ht({method:"POST",baseUrl:this.b,Cc:["user:register"],hb:this.hb,body:{gcmId:a}});return this.f.execute(a)};xv.prototype.unregister=function(a){a=new Ht({method:"POST",baseUrl:this.b,Cc:["user:unregister"],hb:this.hb,body:{gcmId:a}});return this.f.execute(a)};var yv=function(a,c,b){this.l=hb("mr.cloud.slarti.GcmRegistration");this.g=a;this.f=c;this.h=b;this.b=null},Av=function(a){if(!a.b){var c=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=a.h.register(["307539924703"]).then(function(b){if(b==c)ob(a.l,"Slarti GCM ID unchanged: "+b);else return ob(a.l,"Got new Slarti GCM ID: "+b),(c?zv(a,c):Promise.resolve()).then(function(){return a.g.register(b).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=b})})},function(b){a.l.G("Error registering for GCM notifications",
b);c&&zv(a,c).catch(function(d){a.l.G("Failed to unregister GCM ID with Slarti",d)});throw b;});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},zv=function(a,c){return a.g.unregister(c).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(b){a.l.G("Failed to unregister GCM ID with Slarti",b)})};var Bv=null,Cv=function(){yp.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.l=hb("mr.cloud.slarti.GcmEventListener")};q(Cv,yp);Cv.prototype.Sg=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var c=JSON.parse(a.data.data);a=c.type;c=c.id;if(a)return this.l.info("Received Slarti GCM notification: "+a+" ("+c+")"),!0}return!1};var Dv=function(){null==Bv&&(Bv=new Cv);return Bv};var Ev=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];d=a;b=l(b);for(var e=b.next();!e.done;e=b.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var Fv=function(){yp.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.l=hb("mr.WeaveGcmEventListener")};q(Fv,yp);Fv.prototype.Sg=function(a){if(!a||"919648714761"!=a.from)return!1;a=Ev(a,"data","notification");if(!a)return this.l.error("Notification json not found"),!1;try{var c=JSON.parse(a);return!!c&&Array.isArray(c.events)&&0<c.events.length}catch(b){return this.l.error("Invalid json: "+a),!1}};
var Hv=function(){Gv||(Gv=new Fv);return Gv},Gv=null;var Iv=function(a){this.b=a;this.l=hb("mr.cloud.messaging.WeaveGcmMessageHandler")};Iv.prototype.onMessage=function(a){var c=this;a=JSON.parse(a.data.notification);var b=rm();a.events.forEach(function(d){if(d.deviceId){var e=sm(b,d.deviceId);switch(d.type){case "deviceCreated":Jv(c,d);break;case "deviceUpdated":Kv(c,d,e);break;case "deviceDeleted":Lv(c.b,{sinkId:e});break;default:ob(c.l,function(){return"[unhandled event] "+JSON.stringify(d)})}}else c.l.error("Device ID not provided")})};
var Jv=function(a,c){var b=Ev(c,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof b?a.l.error("Receiver name not a string: "+b):(c=new ht(c.deviceId,b,"owner","default",!0),a=a.b,a.b.b.set(c.id,c),a.b.f=Date.now(),ot(a.f,[c.ob]))},Kv=function(a,c,b){c=Ev(c,"statePatch","_cloudCast","appStatus");if("string"!=typeof c)a.l.error("App status not a string: "+c);else if(a=a.b,c="available"==c,b=a.b.qa(b))b.isAvailable=c||!1,a.b.f=Date.now(),pt(a.f,[b.ob])};var Mv=function(a,c){this.g=a;this.f=c;this.b=new kt(this.aq.bind(this),c,2E4);this.h=new Iv(this);Hv().addListener();Yl(this);Vi("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};q(Mv,Li);h=Mv.prototype;h.Ud=function(){var a=this;ft(this.g).then(function(c){a.g.subscribe(c)},function(){});return this.b.Ud().filter(function(c){return c.isAvailable})};h.qa=function(a){return this.b.qa(a)};
h.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.h.onMessage.apply(this.h,n(b));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};
h.aq=function(){return dt(this.g,{descriptionSubstring:"Chrome Streaming Receiver"}).then(function(a){return a.map(function(c){Bb("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=c.isAvailable()&&!(c.b.invitations&&0!=c.b.invitations.length);return new ht(c.getId(),c.f(),c.b.personalizedInfo.maxRole,"default",b)})})};h.Fa=function(){return"WeaveSinkDiscoveryService"};h.jb=function(){return[{cache:st(this.b)}]};h.ib=function(){var a=Vl(this);a&&tt(this.b,a.cache)};
var Lv=function(a,c){if(c=a.b.qa(c.sinkId))a.b.b.delete(c.id),a.b.f=Date.now(),qt(a.f,[c.ob])};var Nv=Ha.JSON.parse,Ov=Ha.JSON.stringify;var Pv=function(a,c,b,d,e,f,g,k,m){this.b=null;this.C=!1;this.D=cv();this.g=[];this.u=a?encodeURIComponent(String(a)):null;this.F=null;!d&&c&&(this.F=c);this.J=b||null;this.h=!d;this.j=null!=e?e:null;this.o=f||null;this.R=!!g;this.N=k||null;this.m=null!=m?m:null};x(Pv,Qt);var Qv=gd(Uc(new Tc(Qc,"https://apis.google.com/js/client.js")));
Pv.prototype.init=function(){var a=t(function(b){this.b=b;var d=Pa("auth",b);Pa("client.request",b)&&d?this.H():b.load("client",t(this.H,this))},this),c=Rv("gapi");c?a(c.gapi):Sv(this,a);return this.D.X};
var Rv=function(a){for(var c=window,b=Pa(a,c);!b&&c!=window.top&&Tv(c.parent,a);)c=c.parent,b=Pa(a,c);return b?c:null},Tv=function(a,c){try{return!!a&&null!=a.location.href&&ve(a,c)}catch(b){return!1}},Sv=function(a,c){var b=Rv("gapi_onload");if(b){var d=b.gapi_onload;b.gapi_onload=function(){d();c(b.gapi)}}else{window.gapi_onload=function(){c(window.gapi)};var e=document.createElement("SCRIPT");me(e,Qv);a.N&&Xf(e,Ov(a.N));document.getElementsByTagName("head")[0].appendChild(e)}};
Pv.prototype.H=function(){for(var a=0;a<this.g.length;a++)this.g[a].vb.resolve(Uv(this,this.g[a].requestData));this.C=!0;this.D.resolve(this.b)};Pv.prototype.sendRequest=function(a){if(this.C)return Uv(this,a);var c=cv();this.g.push({requestData:a,vb:c});return c.X};
var Uv=function(a,c){var b=Pa("config.get",a.b);if(!a.h){var d=b("googleapis.config/auth/useFirstPartyAuth");var e=b("googleapis.config/auth/useOriginToken")}var f;null!=a.j&&(f=b("client/cors"));var g;null!=a.m&&(g=b("client/xd4"));try{var k=Pa("config.update",a.b);a.h||(k("googleapis.config/auth/useFirstPartyAuth",!1),k("googleapis.config/auth/useOriginToken",!1));null!=a.j&&k("client/cors",a.j);null!=a.m&&k("client/xd4",a.m);var m=Vv(a);c.headers&&Oc(m,c.headers);var p={headers:m,root:a.J,path:c.path,
method:c.method,body:c.body},v=c.params||{};a.u&&!a.o?Oc(v,{key:a.u}):a.o&&Oc(v,{key:null});Ic(v)||(p.params=v);var A=Vu(Pa("client.request",a.b)(p));c.callback&&A.then(function(H){c.callback.apply(null,[H.result,H])},function(H){c.callback.apply(null,[H.result,H])});return A}finally{b=Pa("config.update",a.b),a.h||(b("googleapis.config/auth/useFirstPartyAuth",d),b("googleapis.config/auth/useOriginToken",e)),null!=a.j&&b("client/cors",f),null!=a.m&&b("client/xd4",g)}},Vv=function(a){if(a.h){if(a.o)return{Authorization:"Bearer "+
a.o};var c=Pa("auth.getAuthHeaderValueForFirstParty",a.b);return{Authorization:a.R?c([]):c(),"X-Goog-AuthUser":a.F}}return{}};var Wv=function(a){this.b=a},Qs=function(a,c,b){var d="";c.forEach(function(e){d+="/"+encodeURIComponent(e)});a=new Mr(a+d);b&&(b=bs(b),Pr(a,b));return a},Rs=function(a,c,b,d){return a.b.getAuthToken().then(function(e){var f=Xv(e);return Yv(f,c,b,d).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return Zv(a,e,c,b,d);throw g;})})},Zv=function(a,c,b,d,e){return Et(c).then(function(){return Rs(a,b,d,e)})},Yv=function(a,c,b,d){return new Promise(function(e,f){a.sendRequest($v(c,b,function(g){g&&!g.error?
e(g):g&&401==g.error.code?f("INVALID_ACCESS_ERROR"):f(g&&g.error?g.error.errors?g.error.errors[0]:g:Error(g))},d))})},Xv=function(a){a=new Pv(void 0,void 0,void 0,!1,!1,a);a.init();return a},$v=function(a,c,b,d){a={callback:b,method:c,path:a.toString()};d&&(a.body=d);return a};var aw={pt:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},ot:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},bw=aw;bw=aw;var cw={AED:[2,"dh","\u062f.\u0625."],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var dw={Nj:".",Qh:",",ck:"%",Wh:"0",wn:"+",Xj:"-",Rj:"E",dk:"\u2030",Rh:"\u221e",rn:"NaN",Um:"#,##0.###",Rx:"#E0",Qw:"#,##0%",Ct:"\u00a4#,##0.00",Oj:"USD"},ew=dw;ew=dw;var gw=function(){this.D=40;this.f=1;this.g=3;this.F=this.w=0;this.J=!1;this.C=this.o="";this.h=ew.Xj;this.u="";this.b=1;this.m=!1;this.j=[];this.N=this.H=!1;var a=ew.Um;a.replace(/ /g,"\u00a0");var c=[0];this.o=fw(this,a,c);for(var b=c[0],d=-1,e=0,f=0,g=0,k=-1,m=a.length,p=!0;c[0]<m&&p;c[0]++)switch(a.charAt(c[0])){case "#":0<f?g++:e++;0<=k&&0>d&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.j.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+g;break;case "E":if(this.N)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.N=!0;this.F=0;c[0]+1<m&&"+"==a.charAt(c[0]+1)&&(c[0]++,this.J=!0);for(;c[0]+1<m&&"0"==a.charAt(c[0]+1);)c[0]++,this.F++;if(1>e+f||1>this.F)throw Error('Malformed exponential pattern "'+a+'"');p=!1;break;default:c[0]--,p=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,g=e-f,e=f-1,f=1);if(0>d&&0<g||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');g=e+f+g;this.g=0<=d?g-d:0;0<=d&&(this.w=e+f-d,0>this.w&&(this.w=0));this.f=(0<=d?d:g)-e;this.N&&(this.D=e+this.f,0==this.g&&0==this.f&&(this.f=1));this.j.push(Math.max(0,k));this.H=0==d||d==g;b=c[0]-b;this.C=fw(this,a,c);c[0]<a.length&&";"==a.charAt(c[0])?(c[0]++,1!=this.b&&(this.m=!0),this.h=fw(this,a,c),c[0]+=b,this.u=fw(this,a,c)):(this.h+=this.o,this.u+=this.C)};
gw.prototype.parse=function(a,c){c=c||[0];a=a.replace(/ |\u202f/g,"\u00a0");var b=a.indexOf(this.o,c[0])==c[0],d=a.indexOf(this.h,c[0])==c[0];b&&d&&(this.o.length>this.h.length?d=!1:this.o.length<this.h.length&&(b=!1));b?c[0]+=this.o.length:d&&(c[0]+=this.h.length);if(a.indexOf(ew.Rh,c[0])==c[0]){c[0]+=ew.Rh.length;var e=Infinity}else{e=a;var f=!1,g=!1,k=!1,m=-1,p=1,v=ew.Nj,A=ew.Qh,H=ew.Rj;A=A.replace(/\u202f/g,"\u00a0");for(var E="";c[0]<e.length;c[0]++){var R=e.charAt(c[0]),da=hw(R);if(0<=da&&9>=
da)E+=da,k=!0;else if(R==v.charAt(0)){if(f||g)break;E+=".";f=!0}else if(R==A.charAt(0)&&("\u00a0"!=A.charAt(0)||c[0]+1<e.length&&0<=hw(e.charAt(c[0]+1)))){if(f||g)break}else if(R==H.charAt(0)){if(g)break;E+="E";g=!0;m=c[0]}else if("+"==R||"-"==R){if(k&&m!=c[0]-1)break;E+=R}else if(1==this.b&&R==ew.ck.charAt(0)){if(1!=p)break;p=100;if(k){c[0]++;break}}else if(1==this.b&&R==ew.dk.charAt(0)){if(1!=p)break;p=1E3;if(k){c[0]++;break}}else break}1!=this.b&&(p=this.b);e=parseFloat(E)/p}if(b){if(a.indexOf(this.C,
c[0])!=c[0])return NaN;c[0]+=this.C.length}else if(d){if(a.indexOf(this.u,c[0])!=c[0])return NaN;c[0]+=this.u.length}return d?-e:e};
gw.prototype.format=function(a){if(isNaN(a))return ew.rn;var c=[];var b=iw;a=jw(a,-b.ap);c.push(b.prefix);var d=0>a||0==a&&0>1/a;c.push(d?this.h:this.o);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.N)if(0==a)kw(this,a,this.f,c),lw(this,0,c);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=jw(a,-e);var f=this.f;1<this.D&&this.D>this.f?(f=e%this.D,0>f&&(f=this.D+f),a=jw(a,f),e-=f,f=1):1>this.f?(e++,a=jw(a,-1)):(e-=this.f-1,a=jw(a,this.f-1));kw(this,a,f,c);lw(this,e,c)}else kw(this,a,this.f,c);
else c.push(ew.Rh);c.push(d?this.u:this.C);c.push(b.Xr);return c.join("")};
var kw=function(a,c,b,d){if(a.w>a.g)throw Error("Min value must be less than max value");d||(d=[]);var e=jw(c,a.g);e=Math.round(e);if(isFinite(e)){c=Math.floor(jw(e,-a.g));var f=Math.floor(e-jw(c,a.g))}else f=0;e=c;c=f;var g=e;f=c;var k=0<a.w||0<f||!1;e=a.w;k&&(e=a.w);var m="";for(c=g;1E20<c;)m="0"+m,c=Math.round(jw(c,-1));m=c+m;var p=ew.Nj;c=ew.Wh.charCodeAt(0);var v=m.length,A=0;if(0<g||0<b){for(g=v;g<b;g++)d.push(String.fromCharCode(c));if(2<=a.j.length)for(b=1;b<a.j.length;b++)A+=a.j[b];b=v-A;
if(0<b){g=a.j;A=v=0;for(var H,E=ew.Qh,R=m.length,da=0;da<R;da++)if(d.push(String.fromCharCode(c+1*Number(m.charAt(da)))),1<R-da)if(H=g[A],da<b){var Ta=b-da;(1===H||0<H&&1===Ta%H)&&d.push(E)}else A<g.length&&(da===b?A+=1:H===da-b-v+1&&(d.push(E),v+=H,A+=1))}else{b=m;m=a.j;g=ew.Qh;H=b.length;E=[];for(v=m.length-1;0<=v&&0<H;v--){A=m[v];for(R=0;R<A&&0<=H-R-1;R++)E.push(String.fromCharCode(c+1*Number(b.charAt(H-R-1))));H-=A;0<H&&E.push(g)}d.push.apply(d,E.reverse())}}else k||d.push(String.fromCharCode(c));
(a.H||k)&&d.push(p);k=String(f);f=k.split("e+");if(2==f.length){if(k=parseFloat(f[0])){p=k;if(isFinite(p)){for(b=0;1<=(p/=10);)b++;p=b}else p=0<p?p:0;p=0-p-1;k=-1>p?k&&isFinite(k)?jw(Math.round(jw(k,-1)),1):k:k&&isFinite(k)?jw(Math.round(jw(k,p)),-p):k}k=String(k);k=k.replace(".","");k+=ne("0",parseInt(f[1],10)-k.length+1)}a.g+1>k.length&&(k="1"+ne("0",a.g-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(g=1;g<a;g++)d.push(String.fromCharCode(c+1*Number(k.charAt(g))))},lw=function(a,
c,b){b.push(ew.Rj);0>c?(c=-c,b.push(ew.Xj)):a.J&&b.push(ew.wn);c=""+c;for(var d=ew.Wh,e=c.length;e<a.F;e++)b.push(d);b.push(c)},hw=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var c=ew.Wh.charCodeAt(0);return c<=a&&a<c+10?a-c:-1},fw=function(a,c,b){for(var d="",e=!1,f=c.length;b[0]<f;b[0]++){var g=c.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==c.charAt(b[0]+1)?(b[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":b[0]+1<f&&"\u00a4"==
c.charAt(b[0]+1)?(b[0]++,d+=ew.Oj):d+=cw[ew.Oj][1];break;case "%":if(!a.m&&1!=a.b)throw Error("Too many percent/permill");if(a.m&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.m=!1;d+=ew.ck;break;case "\u2030":if(!a.m&&1!=a.b)throw Error("Too many percent/permill");if(a.m&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.m=!1;d+=ew.dk;break;default:d+=g}}return d},iw={prefix:"",Xr:"",ap:0},jw=function(a,c){if(!a||!isFinite(a)||0==
c)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+c))};var mw=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},nw=mw;nw=mw;var ow=function(a,c){if(void 0===c){c=a+"";var b=c.indexOf(".");c=Math.min(-1==b?0:c.length-b-1,3)}return 1==(a|0)&&0==c?"one":"other"},pw=ow;pw=ow;var uw=function(){this.h=qw;this.f=this.b=this.j=null;var a=ew,c=bw;if(rw!==a||sw!==c)rw=a,sw=c,tw=new gw;this.w=tw},rw=null,sw=null,tw=null,vw=/'([{}#].*?)'/g,ww=/''/g;uw.prototype.format=function(a){if(this.h){this.j=[];var c=xw(this,this.h);this.f=yw(this,c);this.h=null}if(this.f&&0!=this.f.length)for(this.b=z(this.j),c=[],zw(this,this.f,a,!1,c),a=c.join("");0<this.b.length;)a=a.replace(this.g(this.b),this.b.pop());else a="";return a};
var zw=function(a,c,b,d,e){for(var f=0;f<c.length;f++)switch(c[f].type){case 4:e.push(c[f].value);break;case 3:var g=c[f].value,k=a,m=e,p=b[g];Ia(p)?(k.b.push(p),m.push(k.g(k.b))):m.push("Undefined parameter - "+g);break;case 2:g=c[f].value;k=e;m=g.gh;Ia(b[m])?(m=g[b[m]],Ia(m)||(m=g.other),zw(a,m,b,d,k)):k.push("Undefined parameter - "+m);break;case 0:g=c[f].value;Aw(a,g,b,pw,d,e);break;case 1:g=c[f].value;Aw(a,g,b,nw,d,e);break;default:Hb("Unrecognized block type: "+c[f].type)}},Aw=function(a,c,
b,d,e,f){var g=c.gh,k=c.yk,m=+b[g];isNaN(m)?f.push("Undefined or invalid parameter - "+g):(k=m-k,g=c[b[g]],Ia(g)||(d=d(k),g=c[d],Ia(g)||(g=c.other)),c=[],zw(a,g,b,e,c),b=c.join(""),e?f.push(b):(a=a.w.format(k),f.push(b.replace(/#/g,a))))},xw=function(a,c){var b=a.j,d=t(a.g,a);c=c.replace(ww,function(){b.push("'");return d(b)});return c=c.replace(vw,function(e,f){b.push(f);return d(b)})},Bw=function(a){var c=0,b=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(b.pop(),
0==b.length&&(f={type:1},f.value=a.substring(c,g),d.push(f),c=g+1)):(0==b.length&&(c=a.substring(c,g),""!=c&&d.push({type:0,value:c}),c=g+1),b.push("{"))}c=a.substring(c);""!=c&&d.push({type:0,value:c});return d},Cw=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Dw=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Ew=/^\s*(\w+)\s*,\s*select\s*,/,yw=function(a,c){var b=[];c=Bw(c);for(var d=0;d<c.length;d++){var e={};if(0==c[d].type)e.type=4,e.value=c[d].value;else if(1==c[d].type){var f=c[d].value;switch(Cw.test(f)?
0:Dw.test(f)?1:Ew.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=Fw(a,c[d].value);break;case 0:e.type=0;e.value=Gw(a,c[d].value);break;case 1:e.type=1;e.value=Hw(a,c[d].value);break;case 3:e.type=3;e.value=c[d].value;break;default:Hb("Unknown block type for pattern: "+c[d].value)}}else Hb("Unknown part of the pattern.");b.push(e)}return b},Fw=function(a,c){var b="";c=c.replace(Ew,function(k,m){b=m;return""});var d={};d.gh=b;c=Bw(c);for(var e=0;e<c.length;){var f=c[e].value;e++;if(1==
c[e].type)var g=yw(a,c[e].value);else Hb("Expected block type.");d[f.replace(/\s/g,"")]=g;e++}return d},Gw=function(a,c){var b="",d=0;c=c.replace(Cw,function(m,p,v){b=p;v&&(d=parseInt(v,10));return""});var e={};e.gh=b;e.yk=d;c=Bw(c);for(var f=0;f<c.length;){var g=c[f].value;f++;if(1==c[f].type)var k=yw(a,c[f].value);else Hb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},Hw=function(a,c){var b="";c=c.replace(Dw,function(k,m){b=m;return""});var d={};d.gh=b;d.yk=0;c=Bw(c);
for(var e=0;e<c.length;){var f=c[e].value;e++;if(1==c[e].type)var g=yw(a,c[e].value);else Hb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return d};uw.prototype.g=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Iw=chrome.i18n.getMessage("1522140683318860351"),Jw=chrome.i18n.getMessage("4246483347873264186"),Kw=chrome.i18n.getMessage("5991427458288444010"),hi=chrome.i18n.getMessage("6063910461797960050"),Lw=chrome.i18n.getMessage("7735695102441495789"),Mw=chrome.i18n.getMessage("4575332923598659024"),qw=chrome.i18n.getMessage("2297080986956220930"),Nw=new uw;var Ow=function(a){this.b=a;this.l=hb("mr.cloud.mesi.MesiService")},xt=function(a){var c=Qs(Hs.b,["hangouts","search"]);a.l.info("Retrieving Hangouts from MESI: "+c);return Rs(a.b,c,"POST",Pw).then(function(b){var d=[];b.result&&(d=b.result.map(function(e){var f=e.hangout,g=f.meeting_room_name,k;f.meeting_domain?k=f.meeting_domain:"BUSINESS"==f.type&&f.company_title&&(k=f.company_title.toLowerCase());var m=Nw.format({ORGANIZER:"",PARTICIPANTS:0});if((e=e.participant)&&0<e.length){var p=e[0].display_name;
m=e.reduce(function(v,A){v.add(A.user_id);"ORGANIZER"==A.role&&(p=A.display_name);return v},new Set);m=Nw.format({ORGANIZER:p,PARTICIPANTS:m.size})}return g&&k?new Js(!1,g+"@"+k,k,g,m,f.hangout_id):new Js(!1,f.hangout_id,k,g,m,f.hangout_id)}));return d})},Pw={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Qw=function(a,c){this.f=a;this.b=c},Tw=function(a,c,b,d){switch(c.type){case "REFRESH_AUTH":var e=d.xd,f=d.deviceId,g=d.Og;return Ft(a.f).then(function(){Rw(a.b,new vj("AUTH_READY",{xd:e,ab:f,Og:g}),b.id)});case "STATUS_REQUEST":return Rw(a.b,c,b.id),Promise.resolve();case "STATUS_RESPONSE":return Rw(a.b,c,b.id,!0),c.data.routeDescription||Rw(a.b,c,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return Sw(a.b,b,4,li(new gi(Lw,"warning"),b.sinkId));case "HANGOUT_INVALID":return Sw(a.b,b,3,li(new gi(Mw,
"warning"),b.sinkId));default:return Promise.reject(Error("Unknown type: "+c.type))}};var Uw=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),Vw=function(a,c){wv.call(this,a,c);this.l=Lf("mr.cloud.slarti.CommandsService")};q(Vw,wv);Vw.prototype.get=function(a){a=new Ht({method:"GET",baseUrl:this.b,Cc:["commands",a],hb:this.hb});return this.f.execute(a).then(function(c){return c})};
Vw.prototype.list=function(a){a=new Ht({method:"GET",baseUrl:this.b,Cc:["commands"],am:{deviceId:a},hb:this.hb});return this.f.execute(a).then(function(c){return c.command||[]})};Vw.prototype.send=function(a,c){var b=this;a=new Ht({method:"POST",baseUrl:this.b,Cc:["commands:send"],hb:this.hb,body:{command:c,deviceId:a}});return this.f.execute(a).then(function(d){b.l.info("Sent Slarti command with ID "+d.id);return d})};
Vw.prototype.update=function(a,c){for(var b=[],d={},e=l(Uw.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(Uw.get(f)));d.id=a;a=new Ht({method:"PUT",baseUrl:this.b,Cc:["commands",a],hb:this.hb,body:{command:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var Ww=Ha.JSON.parse;var Xw=function(){};Xw.prototype.b=null;Xw.prototype.getOptions=function(){var a;(a=this.b)||(a={},Yw(this)&&(a[0]=!0,a[1]=!0),a=this.b=a);return a};var Zw,$w=function(){};x($w,Xw);var ax=function(a){return(a=Yw(a))?new ActiveXObject(a):new XMLHttpRequest},Yw=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var c=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<c.length;b++){var d=c[b];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};Zw=new $w;var bx=function(a){Y.call(this);this.headers=new Gm;this.V=a||null;this.g=!1;this.T=this.b=null;this.na=this.J="";this.o=0;this.h="";this.j=this.ga=this.H=this.ca=!1;this.m=0;this.C=null;this.u="";this.R=this.F=!1};x(bx,Y);bx.prototype.l=Lf("goog.net.XhrIo");var cx=/^https?$/i,dx=["POST","PUT"],ex=[],fx=function(a,c,b,d,e,f,g){var k=new bx;ex.push(k);c&&k.listen("complete",c);su(k,"ready",k.ya);f&&(k.m=Math.max(0,f));g&&(k.F=g);k.send(a,b,d,e);return k};
bx.prototype.ya=function(){this.Ya();ac(ex,this)};
bx.prototype.send=function(a,c,b,d){if(this.b)throw Error("[goog.net.XhrIo] Object is active with another request="+this.J+"; newUri="+a);c=c?c.toUpperCase():"GET";this.J=a;this.h="";this.o=0;this.na=c;this.ca=!1;this.g=!0;this.b=this.V?ax(this.V):ax(Zw);this.T=this.V?this.V.getOptions():Zw.getOptions();this.b.onreadystatechange=t(this.oa,this);try{Of(this.l,gx(this,"Opening Xhr")),this.ga=!0,this.b.open(c,String(a),!0),this.ga=!1}catch(f){Of(this.l,gx(this,"Error opening Xhr: "+f.message));hx(this,
f);return}a=b||"";var e=this.headers.clone();d&&yn(d,function(f,g){e.set(g,f)});d=Sb(e.xb(),ix);b=Ha.FormData&&a instanceof Ha.FormData;!Ub(dx,c)||d||b||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(f,g){this.b.setRequestHeader(g,f)},this);this.u&&(this.b.responseType=this.u);"withCredentials"in this.b&&this.b.withCredentials!==this.F&&(this.b.withCredentials=this.F);try{jx(this),0<this.m&&(this.R=kx(this.b),Of(this.l,gx(this,"Will abort after "+this.m+
"ms if incomplete, xhr2 "+this.R)),this.R?(this.b.timeout=this.m,this.b.ontimeout=t(this.va,this)):this.C=rv(this.va,this.m,this)),Of(this.l,gx(this,"Sending request")),this.H=!0,this.b.send(a),this.H=!1}catch(f){Of(this.l,gx(this,"Send error: "+f.message)),hx(this,f)}};var kx=function(a){return Ae&&Ue(9)&&r(a.timeout)&&Ia(a.ontimeout)},ix=function(a){return id("Content-Type",a)};
bx.prototype.va=function(){"undefined"!=typeof Ga&&this.b&&(this.h="Timed out after "+this.m+"ms, aborting",this.o=8,Of(this.l,gx(this,this.h)),this.M("timeout"),this.abort(8))};var hx=function(a,c){a.g=!1;a.b&&(a.j=!0,a.b.abort(),a.j=!1);a.h=c;a.o=5;lx(a);mx(a)},lx=function(a){a.ca||(a.ca=!0,a.M("complete"),a.M("error"))};bx.prototype.abort=function(a){this.b&&this.g&&(Of(this.l,gx(this,"Aborting")),this.g=!1,this.j=!0,this.b.abort(),this.j=!1,this.o=a||7,this.M("complete"),this.M("abort"),mx(this))};
bx.prototype.ha=function(){this.b&&(this.g&&(this.g=!1,this.j=!0,this.b.abort(),this.j=!1),mx(this,!0));bx.Ca.ha.call(this)};bx.prototype.oa=function(){this.w()||(this.ga||this.H||this.j?nx(this):this.za())};bx.prototype.za=function(){nx(this)};
var nx=function(a){if(a.g&&"undefined"!=typeof Ga)if(a.T[1]&&4==ox(a)&&2==a.Ua())Of(a.l,gx(a,"Local request error detected and ignored"));else if(a.H&&4==ox(a))rv(a.oa,0,a);else if(a.M("readystatechange"),4==ox(a)){Of(a.l,gx(a,"Request complete"));a.g=!1;try{if(px(a))a.M("complete"),a.M("success");else{a.o=6;try{var c=2<ox(a)?a.b.statusText:""}catch(b){Of(a.l,"Can not get status: "+b.message),c=""}a.h=c+" ["+a.Ua()+"]";lx(a)}}finally{mx(a)}}},mx=function(a,c){if(a.b){jx(a);var b=a.b,d=a.T[0]?Qa:null;
a.b=null;a.T=null;c||a.M("ready");try{b.onreadystatechange=d}catch(e){Nf(a.l,"Problem encountered resetting onreadystatechange: "+e.message)}}},jx=function(a){a.b&&a.R&&(a.b.ontimeout=null);a.C&&(sv(a.C),a.C=null)},px=function(a){var c=a.Ua();a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}if(!b){if(c=0===c)a=String(a.J).match(Gr)[1]||null,!a&&Ha.self&&Ha.self.location&&(a=Ha.self.location.protocol,a=a.substr(0,a.length-1)),c=!cx.test(a?a.toLowerCase():
"");b=c}return b},ox=function(a){return a.b?a.b.readyState:0};bx.prototype.Ua=function(){try{return 2<ox(this)?this.b.status:-1}catch(a){return-1}};
var qx=function(a){try{return a.b?a.b.responseText:""}catch(c){return Of(a.l,"Can not get responseText: "+c.message),""}},rx=function(a){if(a.b)return Ww(a.b.responseText)},sx=function(a){try{if(!a.b)return null;if("response"in a.b)return a.b.response;switch(a.u){case "":case "text":return a.b.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.b)return a.b.mozResponseArrayBuffer}Nf(a.l,"Response type "+a.u+" is not supported on this browser");return null}catch(c){return Of(a.l,"Can not get response: "+
c.message),null}};bx.prototype.getResponseHeader=function(a){if(this.b&&4==ox(this))return a=this.b.getResponseHeader(a),null===a?void 0:a};var tx=function(a){var c={};a=(a.b&&4==ox(a)?a.b.getAllResponseHeaders()||"":"").split("\r\n");for(var b=0;b<a.length;b++)if(!jd(a[b])){var d=se(a[b],":",1),e=d[0];d=d[1];if(Ja(d)){d=d.trim();var f=c[e]||[];c[e]=f;f.push(d)}}return yc(c,function(g){return g.join(", ")})},gx=function(a,c){return c+" ["+a.na+" "+a.J+" "+a.Ua()+"]"};var ux=function(){this.l=hb("mr.cloud.CredentialService")},xx=function(a){var c=new Db,b=Is.b+"/iceconfig?key="+Is.f;a.l.info("Requesting TURN credentials from "+b);var d=fx(b,function(){px(d)?(a.l.info("Got TURN credentials: "+qx(d)),c.resolve(vx(a,rx(d)))):c.resolve(wx(a))},"POST",void 0,{"Content-Type":"application/json"});return c.b},vx=function(a,c){try{var b=[];c.iceServers.forEach(function(d){d.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:d.credential,username:d.username})})});
return b}catch(d){return a.l.error("Error parsing TURN credentials.",d),[]}},wx=function(a){a.l.error("XHR failed fetching TURN credentials.",null);return[]};var yx=function(a,c,b){this.l=hb("mr.cloud.slarti.MessageHandler");this.g=a;this.h=c;this.b=b;this.f=new Map},zx=function(a){if($i(a.mediaSource))return Promise.resolve({title:"screen"});var c=a.nb&&a.nb.tabId;return null==c?Promise.resolve({title:"",url:""}):new Promise(function(b){chrome.tabs.get(c,function(d){b({title:d&&d.title||"",url:d&&d.url||""})})})},Ax=function(a,c,b,d){var e=d.deviceId,f=c.data;return zx(b).then(function(g){g={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:g,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.g.send(e,g).then(function(k){return new Promise(function(m,p){a.f.set(k.id,{routeId:b.id,sinkId:d.id,resolve:m,reject:p,Dp:"PENDING_APPROVAL"==k.status})})},function(){Sw(a.b,b.id,7,li(ki(ji(new gi(Iw,"warning")),b.id),d.id))})})},Bx=function(a,c){return xx(a.h).then(function(b){Rw(a.b,new vj("TURN_CREDENTIALS",{credentials:b}),c.id)})};var Cx=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Fx=function(a,c,b,d,e){return new Promise(function(f){switch(c){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+c);}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":f(Sw(a.b,d,1,null));return;case "SESSION_START_SUCCESS":As(0);break;case "SESSION_END":break;case "SESSION_FAILURE":As(1);f(Sw(a.b,d,2,li(new gi(Iw,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":Rw(a.b,b.data,d.id,!0);break;case "OFFER":switch(c){case "slarti":f(Ax(a.f,b,d,e));return;case "weave":f(Dx(a.g,b,d,e));return;default:throw Error("Unexpected channel type: "+c);}case "GET_TURN_CREDENTIALS":switch(c){case "slarti":f(Bx(a.f,d));return;case "weave":f(Ex(a.g,d));return;default:throw Error("Unexpected channel type: "+c);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(Tw(a.h,
b,d,e));return;case "new_session":Rw(a.b,b,d.id,!0);break;case "remove_session":Rw(a.b,b,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+b.type);}f()})};var Gx=function(a,c,b){this.state=a;this.type=null!=c?c:null;this.results=null!=b?b:null},Hx=function(a){this.b=a},Kx=function(a,c,b,d){return Ix(a,$s,c,b,d,35E3).then(function(e){return Jx(a,e)})},Mx=function(a,c,b,d){return Ix(a,at,c,b,d,23E3).then(function(e){var f=e.state;return"done"==f?(e=Lx(e),new Gx(f,e.type,new Xs(e.sessionDescription))):new Gx(f)})},Ix=function(a,c,b,d,e,f){var g={_webrtcMessage:JSON.stringify(d.presentationUrl?new Xs(d.description,null,d.presentationUrl,d.presentationId):
new Xs(d.description))};d.settings&&(g._settings=sj(d.settings));d.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(g._user=JSON.stringify(e));return Nx(a,b,c,g,f)},Jx=function(a,c){var b=c.state;switch(b){case "done":return Promise.resolve(Ox(c));case "queued":case "inProgress":return Px(a,c).then(function(d){return Jx(a,d)});default:return Promise.resolve(new Gx(b))}},Px=function(a,c){return new Promise(function(b){var d=setInterval(function(){Qx(a,c.id).then(function(e){"queued"!=
e.state&&"inProgress"!=e.state&&(clearInterval(d),b(e))})},2E3)})},Ox=function(a){a=Lx(a);return"__cloud_webrtc_session_message__"==a.type?new Gx("done","knocking_cloud_webrtc_session_message",new Xs(a.sessionDescription)):new Gx("done",a.type)},Nx=function(a,c,b,d,e){c={deviceId:c,name:"_cloudCast."+b.name,parameters:d,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=Qs(Es.b,["commands"],b);return Rs(a.b,e,"POST",c)},Lx=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Qx=function(a,c){c=Qs(Es.b,["commands",c]);return Rs(a.b,c,"GET")};Hx.$inject=["gapiService"];var Rx=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Dx=function(a,c,b,d){return Sx(a,c,d).then(function(e){a:{var f=b.id;if("done"!=e.state)f=Promise.reject(Error("Offer not executed by receiver. State: "+e.state));else{switch(e.type){case "__cloud_webrtc_session_message__":e=new vj("ANSWER",e.results.sessionDescription);Rw(a.b,e,f);break;case "knocking_cloud_webrtc_session_message":zs(0);e=new vj("KNOCK_ANSWER",e.results.sessionDescription);Rw(a.b,e,f);break;case "knock_denied":zs(1);Tx(a,
Jw,f);break;case "knock_timeout":zs(2);Tx(a,Kw,f);break;default:f=Promise.reject(Error("Invalid message type: "+e.type));break a}f=Promise.resolve()}}return f})},Ex=function(a,c){return xx(a.h).then(function(b){Rw(a.b,new vj("TURN_CREDENTIALS",{credentials:b}),c.id)})},Sx=function(a,c,b){var d=b.deviceId,e=a.g.b;e=e?new Vs(e):void 0;c=c.data;switch(b.di){case "owner":Cs(0);break;case "manager":Cs(1);break;case "user":Cs(2);break;case "viewer":Cs(3)}return"viewer"==b.di?Kx(a.f,d,c,e):Mx(a.f,d,c,e)},
Tx=function(a,c,b){c=new gi(c,"warning");ji(c);a.b.b.Ke(c);Rw(a.b,new vj("STOP"),b)};var Ux=function(){var a=this;this.l=hb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(c){Yi(13);if(a.b){c=l(c);for(var b=c.next();!b.done;b=c.next())if(b=b.value,"media_router.cloudservices.enabled"==b.key){a.b.call(null,b.value);break}}})},Vx=function(a,c){a.b=c},Wx=function(a){var c=a.l;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&c.G("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Yx=function(a){return Xx().catch(function(){return Xx().catch(function(c){a.l.G("Error retrieving cloud on setting.",c);return!1})})},Xx=function(){return Zx("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},Zx=function(a){return new Promise(function(c,b){chrome.storage.sync.get(a,function(d){chrome.runtime.lastError?b(chrome.runtime.lastError):c(d)})})},ay=function(a){return $x().catch(function(){return $x().catch(function(c){a.l.G("Error retrieving cloud enabled setting.",
c);return!1})})},$x=function(){return by().then(function(a){return!!a.value})},by=function(){return new Promise(function(a,c){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(b){chrome.runtime.lastError?c(chrome.runtime.lastError):a(b)})})},cy=function(a){var c=a.l;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&c.G("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},ey=function(a){return dy().catch(function(){return dy().catch(function(c){a.l.G("Error retrieving hangouts notified setting.",
c);return!1})})},dy=function(){return Zx("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var fy=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),gy=function(a,c){wv.call(this,a,c)};q(gy,wv);h=gy.prototype;h.act=function(a,c){a=new Ht({method:"POST",baseUrl:this.b,Cc:["devices:act"],hb:this.hb,body:{gcmId:c,id:a}});return this.f.execute(a).then(function(b){return b})};h.create=function(a){a=new Ht({method:"POST",baseUrl:this.b,Cc:["devices"],hb:this.hb,body:a});return this.f.execute(a).then(function(c){return c})};
h.delete=function(a){a=new Ht({method:"DELETE",baseUrl:this.b,Cc:["devices",a],hb:this.hb});return this.f.execute(a)};h.get=function(a){a=new Ht({method:"GET",baseUrl:this.b,Cc:["devices",a],hb:this.hb});return this.f.execute(a).then(function(c){return c})};
h.list=function(a){var c=a.type,b=a.status;a=a.permission;var d={};c&&(d.type=c);b&&(d.status=b);a&&(d.permission=a);c=new Ht({method:"GET",baseUrl:this.b,Cc:["devices"],am:d,hb:this.hb});return this.f.execute(c).then(function(e){return e.device||[]})};h.update=function(a,c){for(var b=[],d={},e=l(fy.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(fy.get(f)));d.id=a;a=new Ht({method:"PUT",baseUrl:this.b,Cc:["devices",a],hb:this.hb,body:{device:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var hy=function(a,c,b,d,e,f){f=void 0===f?null:f;this.l=hb("mr.cloud.slarti.SinkDiscoveryService");this.w=a;this.g=c;this.f=b;this.j=d;this.h=e;this.b=f||new kt(this.m.bind(this),b,36E5);Dv().addListener();Yl(this);Vi("mr.cloud.slarti.SinkDiscoveryService",this)};q(hy,Li);hy.prototype.Ud=function(){Av(this.h).catch(function(){});return this.b.Ud().filter(function(a){return a.isAvailable})};hy.prototype.qa=function(a){return this.b.qa(a)};
hy.prototype.handleEvent=function(a,c){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");iy(this,c)};
var iy=function(a,c){var b=JSON.parse(c.data.data);a.l.info("Received Slarti GCM notification: "+b.type);ob(a.l,function(){return"Got notification: "+JSON.stringify(b)});switch(b.type){case "DEVICE_ADDED":jy(a,b).then(function(d){"cast-receiver"==d.type&&(d=new jt(d.id,d.displayName,"ONLINE"==d.status),a.b.b.set(d.id,d),ot(a.f,[d.ob]))});break;case "DEVICE_CHANGED":jy(a,b).then(function(d){if("cast-receiver"==d.type){var e=sm(rm(),d.id);if(e=a.b.qa(e))e.displayName=d.displayName,e.isAvailable="ONLINE"==
d.status,pt(a.f,[e.ob])}});break;case "DEVICE_REMOVED":ky(a,ly(b));Promise.resolve();break;case "COMMAND_CHANGED":my(a,b).then(function(d){var e=a.j,f=d.id,g=e.f.get(f);if(g){var k=g.routeId,m=g.sinkId,p=g.resolve,v=g.reject,A=g.Dp;g=!0;try{var H=JSON.parse(d.results||"{}"),E=H.sessionDescription,R=H.errorCode,da=H.errorText;switch(d.status){case "SUCCESS":p(Rw(e.b,new vj("ANSWER",E),k));A&&zs(0);break;case "ERROR":case "TIMEOUT":var Ta="TIMEOUT"==d.status;p=Iw;"KNOCK_DENIED"==R&&(zs(Ta?2:1),p=Ta?
Kw:Jw);Sw(e.b,k,7,li(ki(ji(new gi(p,"warning")),k),m));throw Error("Slarti command "+f+" failed with status: "+(d.status+", errorCode: "+R+", ")+("errorText: "+da));default:g=!1}}catch(zc){v(zc)}finally{g&&e.f.delete(f)}}else e.l.G("Received update to unknown command with "+("name = "+d.name+" and id = "+f))});break;default:Promise.resolve()}};hy.prototype.m=function(){return this.g.list({type:"cast-receiver"}).then(function(a){return a.map(function(c){return new jt(c.id,c.displayName,"ONLINE"==c.status)})})};
hy.prototype.Fa=function(){return"SlartiSinkDiscoveryService"};hy.prototype.jb=function(){return[{cache:st(this.b)}]};hy.prototype.ib=function(){var a=Vl(this);a&&tt(this.b,a.cache)};
var ky=function(a,c){c=sm(rm(),c);var b=a.b.qa(c);b&&(a.b.b.delete(c),qt(a.f,[b.ob]))},ly=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},jy=function(a,c){c=c.deviceInfo;return c.device?Promise.resolve(c.device):a.g.get(c.deviceId)},my=function(a,c){c=c.commandInfo;return c.command?Promise.resolve(c.command):a.w.get(c.commandId)};var ny=function(){this.b=null},oy=function(a,c){if(!a.b||O(a.b,2)<O(c,2))a.b=wl(c)},py=function(a){return a.b?O(a.b,2)+";"+O(a.b,1):null};var qy=function(){this.D=this.w=this.J=this.N=this.F=this.C=this.g=this.u=this.h=this.f=this.j=this.dc=this.ga=this.V=this.H=this.Za=this.ca=this.T=this.R=this.m=this.o=this.b=null},ry=function(){var a=qy.Ia();null==a.w&&(a.w=new ny);return a.w},sy=function(a){null==a.b&&(a.b=new Ct);return a.b},ty=function(a){null==a.o&&(a.o=new Wv(sy(a)));return a.o},uy=function(a){null==a.m&&(a.m=new uv);return a.m},vy=function(a){null==a.R&&(a.R=new Vw(sy(a),uy(a)));return a.R},xy=function(a,c){null==a.H&&(a.H=
new yx(vy(a),wy(a),c));return a.H},yy=function(a){null==a.u&&(a.u=new Hx(ty(a)));return a.u},wy=function(a){null==a.J&&(a.J=new ux(ty(a)));return a.J},zy=function(a){null==a.D&&(a.D=new Us);return a.D};Ra(qy);var Dy=function(a,c){this.g=a;this.w=c;this.j=new Db;this.ia=this.j.b;this.b=Ay(a.id);this.f=new Db;this.h=!1;By(this);Cy(this);this.b.sendMessage(new vj("GET_TURN_CREDENTIALS"))};Dy.prototype.start=function(){var a=this;return this.ia.then(function(c){if(c.b)return Promise.reject(Error("Presentation already started"));c.start();return a.f.b})};Dy.prototype.stop=function(){var a=this;this.h=!1;return this.ia.then(function(c){c.stop();a.ia=Promise.reject(Error("Peer connection has already been stopped"))})};
var By=function(a){a.b.onMessage=function(c){if(c.type)switch(c.type){case "TURN_CREDENTIALS":a.j.resolve(new Aj(a.g.id,c.data.credentials));break;case "ANSWER":a.ia.then(function(b){Ij(b,c.data)});break;case "STOP":a.f.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+c.type);}else a.ia.then(function(b){var d={type:"PRESENTATION_CONNECTION_MESSAGE",data:c};"string"==typeof d?b.h.send(d):b.h.send(JSON.stringify(d))})}},Cy=function(a){a.ia.then(function(c){Ej(c,
function(b){a.b.sendMessage(new vj("OFFER",new xj(b,null,null,a.w,a.g.id)))});Fj(c,function(b){b=wj(b);"STOP"==b.type&&a.stop();a.b.sendMessage(b)});Bj(c,function(){a.h=!0;a.b.sendMessage(new vj("SESSION_START_SUCCESS"));a.f.resolve(a.g)});Dj(c,function(){a.b.sendMessage(new vj("SESSION_END"))});Cj(c,function(b){a.h||a.f.reject(b);a.b.sendMessage(new vj("SESSION_FAILURE"))})})};var Ey=function(a){this.b=a;this.f=new Map;this.F=new Map;this.N=new Map;this.o=[];this.j=this.J=this.D=this.H=this.w=null;this.m=this.h=this.g=!1;this.C=new Map;this.u=new Map;Yl(this)};Ey.prototype.getName=function(){return"cloud"};
Ey.prototype.initialize=function(){var a=this;this.l.info("Initializing Cloud MRP");var c=qy.Ia();null==c.dc&&(null==c.ga&&(c.ga=new ct(ty(c),zy(c))),c.dc=new Mv(c.ga,this));this.o.push(c.dc);if(null==c.Za){var b=vy(c);null==c.T&&(c.T=new gy(sy(c),uy(c)));var d=c.T,e=xy(c,this);null==c.V&&(null==c.ca&&(c.ca=new xv(sy(c),uy(c))),c.V=new yv(c.ca,window.localStorage,zy(c)));c.Za=new hy(b,d,this,e,c.V)}this.o.push(c.Za);null==c.h&&(null==c.f&&(c.f=new Ks(ty(c),sy(c))),b=c.f,null==c.j&&(c.j=new Ow(ty(c))),
c.h=new wt(b,c.j,this));this.w=c.h;this.o.push(this.w);this.H=yy(c);xy(c,this);this.D=sy(c);null==c.F&&(b=xy(c,this),null==c.g&&(c.g=new Rx(yy(c),sy(c),wy(c),this)),d=c.g,null==c.C&&(c.C=new Qw(sy(c),this)),c.F=new Cx(b,d,c.C,this));this.J=c.F;null==c.N&&(c.N=new Ux);this.j=c.N;ay(this.j).then(function(f){a.g=f;a.l.info("Cloud enabled setting: "+a.g)});Yx(this.j).then(function(f){a.h=f;a.l.info("Cloud on setting: "+a.h)});Vx(this.j,function(f){a.g=f;a.l.info("Cloud enabled setting: "+a.g);a.g&&Fy(a)});
ey(this.j).then(function(f){a.m=f;a.l.info("Privacy notified setting: "+a.m)})};Ey.prototype.rd=function(){return Array.from(this.f.values())};
Ey.prototype.ng=function(a){if(!Gy(this,a))return pq;ob(this.l,"GetAvailableSinks for "+a);var c=[];if(this.h||Hy())c=Fy(this);this.u.clear();for(var b={},d=l(this.C.values()),e=d.next();!e.done;b={Ye:b.Ye,Ug:b.Ug},e=d.next())b.Ye=e.value,b.Ug=!1,c.forEach(function(f){return function(g){g.id==f.Ye.id&&(f.Ug=!0,g.ob.friendlyName=f.Ye.ob.friendlyName)}}(b)),b.Ug||this.u.set(b.Ye.id,b.Ye);c=c.concat.apply(c,n(this.u.values()));ob(this.l,function(){return"Available sinks are..."+JSON.stringify(c)});b=
c.map(function(f){return f.ob});this.w&&(b=b.concat(Iy));return new oq(b,-1!=a.indexOf("0F5096E8")?cj:null)};var Fy=function(a){var c=[];a.l.info("Checking cloud discovery services");rm().g=u();a.o.forEach(function(b){b=b.Ud();c=c.concat(b)});return c};h=Ey.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.qa=function(a){return(a=Jy(this,a))?a.ob:null};
h.createRoute=function(a,c,b,d,e,f,g){var k=this;this.l.info("createRoute called");ob(this.l,"urn: "+a+" sinkId:"+c);if(e=this.F.get(c))return ni(this.b.yl(this,e,a,b,g,function(m){m.mediaSource=a;m.nb.tabId=g;return oi(m)}),function(m){k.b.Je(m);return m});e=Jy(this,c);return Ky(this,a,e,c,b,d,g)};
var Ly=function(a,c,b,d,e){c instanceof nq&&2==c.errorCode?Sw(a,b,6,null):(a.l.error("Error on start session",c instanceof Error?c:Error("Expected an Error value, got "+c)),a.f.has(b.id)&&Sw(a,b,e,li(new gi(Iw,"warning"),b.sinkId)));if(c=a.w)c=a.w,c.f.delete(d.deviceId)?(c.b.b.delete(d.id),c=!0):c=!1;c&&qt(a,[d.ob])},Ky=function(a,c,b,d,e,f,g){if(f)return pi(Error("not supported"));f=!1;switch(b.b){case "slarti":case "weave":Bs(1);break;case "mesi":f=!0;if(!a.m){a.m=!0;cy(a.j);var k=li(ii(),d);a.b.Ke(k)}Bs(0)}rm().f=
new om(b.model,null);var m=Fp(e,a.getName(),d,c,!0,"");f&&(m.customControllerPath="cloud_route_details/view.html?routeId="+m.id,m.controllerType=mojo.RouteControllerType&&mojo.RouteControllerType.kHangouts);a.f.set(m.id,m);a.F.set(d,m);a.C.set(m.id,b);a.N.set(m.id,b.b);a.b.Hf(a,m);a.b.Jf(a.Fa(),!0);if(bj(c)&&!f)return a.l.info("starting presentation on route: "+m.id),aaa(m,c).catch(function(p){Ly(a,p,m,b,7);throw p;});a.l.info("starting mirroring on route: "+m.id);m.nb={tabId:g,sessionId:"",Nf:"",
Zd:b.model};bj(c)&&(m.isOffscreenPresentation=!0);return a.b.Qi(a,m,e).catch(function(p){Ly(a,p,m,b,5);throw p;})};Ey.prototype.terminateRoute=function(a){return Sw(this,a,0,null)};
var Sw=function(a,c,b,d){var e="string"==typeof c?a.f.get(c):c;if(!e)return Promise.reject(new nq(3,"Route in cloud provider not found for routeId "+c));a.l.info("terminating route: "+e.id);a.f.delete(e.id);a.F.delete(e.sinkId);c=a.C.get(e.id);a.C.delete(e.id);d&&a.b.Ke(d);Cb("MediaRouter.Cloud.Session.End",b,ws);switch(b){case 1:break;default:switch(c.b){case "weave":Nx(a.H,c.deviceId,bt,{})}}a.b.vg(e);0==a.f.size&&a.b.Jf(a.Fa(),!1);a.b.onPresentationConnectionStateChanged(e.id,"terminated");a.u.has(e.sinkId)&&
(b=a.u.get(e.sinkId),qt(a,[b.ob]),a.u.delete(e.sinkId));return Promise.resolve()};h=Ey.prototype;h.sendRouteMessage=function(a,c){var b=this.N.get(a);if(b){var d=(a=this.f.get(a)||void 0)?Jy(this,a.sinkId):void 0;return Fx(this.J,b,c,a,d)}return Ja(c)?(Rw(this,c,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.uf=function(a){var c=new tj;5>c.minFrameRate&&(c.minFrameRate=5);var b=this.Ge(a);"hangouts"==b||"meetings"==b?(c.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),c.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):c.senderSideLetterboxing=!0;uj(c);Object.freeze(c);this.l.info("Settings for "+a+": "+sj(c));if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return c};
h.Ge=function(a){var c=null;a=Jy(this,a);switch(a.b){case "slarti":case "weave":c="webrtc";break;case "mesi":c=a.xd?"meetings":"hangouts"}return c};h.Gh=function(){};h.eg=function(a,c){ob(this.l,"Checking canRoute: "+a+" for sinkId: "+c);return Gy(this,a)&&!!this.qa(c)};h.mf=function(a,c){return("https://hangouts.google.com/cloudmrp-mirroring"==a||bj(a))&&this.f.has(c)};h.joinRoute=function(a,c){return(a=this.f.get(c))?(this.l.info("joining route: "+a.id),oi(a)):pi(Error("not supported"))};
h.connectRouteByRouteId=function(){return pi(Error("not supported"))};h.detachRoute=function(){};
var ot=function(a,c){a.l.info(c.length+" sinks added");0<c.length&&!a.h&&(Wx(a.j),a.h=!0);c=Jy(a,c[0].id);rm().b=new om(c.model,null);a.b.Vc();a.b.onSinkAvailabilityUpdated(a,2);a.l.info("sinkAvailability changed to AVAILABLE")},qt=function(a,c){a.l.info(c.length+" sinks removed");a.o.some(function(b){return 0<b.Ud().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.l.info("sinkAvailability changed to UNAVAILABLE"));a.b.Vc()},pt=function(a,c){a.l.info(c.length+" sinks updated");a.b.Vc()},Rw=function(a,
c,b,d){(void 0===d?0:d)?a.b.Td(b,c):a.b.Fh(b,c)},Jy=function(a,c){var b=baa(a,c);b||(b=null,(c=a.F.get(c))&&(b=a.C.get(c.id)));return b},baa=function(a,c){var b=null;a.o.some(function(d){b=d.qa(c);return!!b});return b},Hy=function(){var a=rm().g;return 3E5<=Date.now()-a},Gy=function(a,c){var b=aj(c);c=bj(c);if(a.D.g&&!a.D.f&&b)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.g&&a.D.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.D,e=!(a.g||a.f&&a.b&&(-1!=Gt.indexOf(a.b)||-1!=Gt.indexOf(Dt(a))))&&
c;return e?!1:d&&(b||c)};Ey.prototype.searchSinks=function(a,c){var b=this;if(!Gy(this,a))return Promise.reject(Error("err"));a=zt(this.w,c);a.then(function(d){ot(b,[d])});return a};var caa=function(a,c){c=a.f.get(c);if(!c)return Promise.reject(Error("Route not found"));a=a.Ge(c.sinkId);return"hangouts"!=a&&"meetings"!=a?Promise.reject(Error("Unsupported sink channel type")):ts(Mi.get("mr.ProviderManager")||null,a)};h=Ey.prototype;
h.createMediaRouteController=function(a,c,b){return caa(this,a).then(function(d){return d.createMediaRouteController(a,c,b)})};h.provideSinks=function(){};h.Fa=function(){return"CloudProvider"};h.jb=function(){return[void 0,{cloudEnabled:this.g,cloudOn:this.h,notifiedHangoutsPrivacy:this.m}]};h.ib=function(){var a=Wl(this);a&&(a.cloudEnabled&&(this.g=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.m=a.notifiedHangoutsPrivacy))};var aaa=function(a,c){a=new Dy(a,c);return qi(a.start())};
Ey.prototype.l=hb("mr.CloudProvider");var Iy=new Rl("pseudo:cloud","","meeting","","default");var My=function(){yp.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};q(My,yp);My.prototype.Sg=function(a,c){return c.id&&-1!=daa.indexOf(c.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};My.prototype.mi=function(){return!0};var Oy=function(){Ny||(Ny=new My);return Ny},Ny=null,daa=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var Py=function(){yp.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};q(Py,yp);Py.prototype.Sg=function(a,c){return"retrieve_log_data"==a.type&&c.id==chrome.runtime.id&&c.url=="chrome-extension://"+c.id+"/feedback.html"};Py.prototype.mi=function(){return!0};var Ry=function(){Qy||(Qy=new Py);return Qy},Qy=null;function eaa(){var a=Sy;var c=new qq(a);var b=new zr(a);c=[c,b];c.push(new Ey(a));return c};var Ty=function(a,c){this.routeId=a;this.message=c},Uy=function(a){return"string"!=typeof a.message};var Vy=function(a){this.D=a;this.h=this.j=null},Wy=function(a){if(null==a.h)if(null==a.j||Date.now()-a.j>=a.D)a.w();else{var c=Math.max(a.j+a.D-Date.now(),5);a.h=setTimeout(a.w.bind(a),c)}};Vy.prototype.w=function(){null!=this.h&&(clearTimeout(this.h),this.h=null);this.u();this.j=Date.now()};Vy.prototype.u=function(){};var Xy=function(a,c){Vy.call(this,20);this.b=new Map;this.f=new Set;this.o=null;this.m=this.g=0;this.C=!1;this.N=a;this.F=c;this.l=hb("mr.RouteMessageSender")};q(Xy,Vy);Xy.prototype.init=function(a){this.o=a;Yl(this)};Xy.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
Xy.prototype.send=function(a,c){var b=this.b.get(a);b||(b=[],this.b.set(a,b));c=new Ty(a,c);b.push(c);50<b.length&&1==b.length%50&&this.l.G(function(){return"Message queue length is excessively large "+("("+b.length+") for route "+a)});this.g+=Uy(c)?0:c.message.length;Uy(c)&&this.m++;Yy(this);this.f.has(a)&&Wy(this)};
var Zy=function(a,c){if(0!=c.length){c=l(c);for(var b=c.next();!b.done;b=c.next())b=b.value,a.g-=Uy(b)?0:b.message.length,Uy(b)&&a.m--}},Yy=function(a){var c=0<a.m||a.g>a.F;c!=a.C&&(a.C=c,a.N.Jf(a.Fa(),c))};Xy.prototype.u=function(){if(this.o){for(var a=l(this.f),c=a.next();!c.done;c=a.next()){c=c.value;var b=this.b.get(c);b&&0!=b.length&&(this.o(c,b),Zy(this,b),this.b.set(c,[]))}Yy(this)}else this.l.error("sendMessagesCallback not set. Messages not delivered.")};Xy.prototype.Fa=function(){return"mr.RouteMessageSender"};
Xy.prototype.jb=function(){var a=[].concat(n(this.b.entries())).map(function(c){return[c[0],c[1].map(function(b){return b.message})]});return[new faa(a,Array.from(this.f),this.g)]};Xy.prototype.ib=function(){var a=Vl(this);if(a){this.b=new Map;for(var c={},b=l(a.f),d=b.next();!d.done;c={Xg:c.Xg},d=b.next())d=d.value,c.Xg=d[0],d=d[1].map(function(e){return function(f){return new Ty(e.Xg,f)}}(c)),this.b.set(c.Xg,d);this.f=new Set(a.b);this.g=a.g}};var faa=function(a,c,b){this.f=a;this.b=c;this.g=b};var gaa=function(a,c){this.type="internal_message";this.routeId=a;this.message=c};var $y=function(a,c,b){this.b=a;this.h=c;this.g=b;this.onMessage=function(){};b.listen("internal_message",this.f,this)};$y.prototype.sendMessage=function(a,c){return this.h(this.b,a,c)};$y.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};$y.prototype.Ya=function(){this.onMessage=function(){};Fq(this.g,this.f,this)};
var haa=new $y("",function(){return Promise.resolve()},new Eq),iaa=function(a){this.b=a},Ay=function(a){var c=ei,b=c.b.wi(a);return b?new $y(a,b.sendRouteMessage.bind(b),c.b.yi()):haa};var az=function(a,c){this.w=null!=c?a.bind(c):a;this.j=this.m.bind(this);this.h=[];this.b=!1;this.f=null};az.prototype.g=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];this.h=[].concat(n(c));null==this.f?bz(this):this.b=!0};var bz=function(a){a.f=setTimeout(a.j,500);a.w.apply(a,n(a.h))};az.prototype.m=function(){this.f=null;this.b&&(this.b=!1,bz(this))};var cz=function(){this.l=hb("mr.ProviderManager");this.g=[];this.f=new Map;this.m=new Map;this.j=new Set;this.h=new Set;this.D=new Map;this.b=this.u=null;this.R=new Eq;this.T=new az(this.pm,this);this.ca=new az(this.N,this);this.w=new Xy(this,524288);this.F=0;this.o=new Map;this.C=[];var a=new os(this);this.Za=a.onMessage.bind(a);a=new fs(this);this.V=a.onMessage.bind(a);this.H="";this.J=!1;this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};q(cz,Li);
cz.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.Za.apply(this,n(b));else if(a==chrome.runtime.onMessageExternal)this.V.apply(this,n(b));else throw Error("Unhandled event");};
var ts=function(a,c){c=a.D.get(c);return Pi(c).then(function(b){b.initialize(a,a.J);return b})},jaa=function(a,c,b){c.forEach(function(d){if(ss(a,d.getName()))a.l.G("Provider "+d.getName()+" already registered.");else try{d.initialize(b),a.g.push(d),a.o.set(d.getName(),0)}catch(e){a.l.G("Provider "+d.getName()+" failed to initialize.",e)}})};
cz.prototype.initialize=function(a,c,b){this.D.set("webrtc","mr.mirror.webrtc.WebRtcService");this.D.set("cast_streaming","mr.mirror.cast.Service");this.D.set("hangouts","mr.mirror.hangouts.HangoutsService");this.D.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new iaa(this);ei||(ei=d);this.b=a;this.w.init(this.b.onRouteMessagesReceived.bind(this.b));jaa(this,c,b);b&&void 0!==b.use_views_dialog&&(this.H=b.use_views_dialog?"Views":"WebUI");b&&void 0!==b.use_mirroring_service&&(this.J=b.use_mirroring_service);
Yl(this);Vi("mr.ProviderManager",this)};var ez=function(a,c,b){return new Promise(function(d,e){var f=null;a.F++;dz(a);f=window.setTimeout(function(){f=null;c.cancel(new nq(2,"timeout after "+b+" ms."))},b);c.b.then(function(g){a.F--;dz(a);null!=f&&window.clearTimeout(f);d(g)},function(g){a.F--;dz(a);null!=f&&window.clearTimeout(f);e(g instanceof nq?g:g instanceof Error?new nq(0,g.message,g.stack):new nq(0))})})};cz.prototype.onBeforeInvokeHandler=function(){Yi(0)};
var fz=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};h=cz.prototype;
h.createRoute=function(a,c,b,d,e,f,g){var k=this;g=void 0===g?!1:g;var m=kaa(this,a,c);if(!m)return Promise.reject(new nq(7,"No provider supports createRoute with source: "+a+" and sink: "+c));var p=void 0;void 0!==d&&(p=fz(d));f=f&&0<f?f:6E4;a=m.createRoute(a,c,b,g,f,p,e);return ez(this,a,f).then(function(v){return v},function(v){k.l.error("Error creating route.",v);throw v;})};
h.connectRouteByRouteId=function(a,c,b,d,e,f){var g=this.f.get(c);if(!g)return Promise.reject(new nq(7,"No provider supports join "+c));a=g.connectRouteByRouteId(a,c,b,fz(d),e);return ez(this,a,f&&0<f?f:3E4)};h.joinRoute=function(a,c,b,d,e,f){f=void 0===f?!1:f;var g=laa(this,a,c);if(!g)return Promise.reject(new nq(7,"No provider supports join "+c));e=e&&0<e?e:3E4;a=g.joinRoute(a,c,f,e,fz(b),d);return ez(this,a,e)};
h.terminateRoute=function(a){var c=this.f.get(a);return c?gz(this,a).then(function(){return c.terminateRoute(a)}):Promise.reject(new nq(3,"Route not found for routeId "+a))};h.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.g.forEach(function(c){c.startObservingMediaSinks(a)}));hz(this,a)};h.stopObservingMediaSinks=function(a){this.j.delete(a)?iz(this,a):this.l.info("No existing query "+a)};
var iz=function(a,c){a.g.forEach(function(b){b.stopObservingMediaSinks(c)})},hz=function(a,c){if("urn:x-org.chromium.media:source:tab:-1"==c)a.l.G("No sinks for sourceUrn: "+c);else{var b=new Map,d=[];a.g.forEach(function(e){var f=e.ng(c);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(g){b.has(g.id)?a.l.G("Detected duplicate sink "+g.id+" from provider: "+e.getName()):b.set(g.id,g)})});maa(a,c,Array.from(b.values()),d||[])}},maa=function(a,c,b,d){a.l.info("Sending "+b.length+" sinks to MR for "+
c);a.b.onSinksReceived(c,b,d.map(zo))};h=cz.prototype;h.sendRouteMessage=function(a,c,b){var d=this.f.get(a);d?(a=d.sendRouteMessage(a,c,b),a=ez(this,qi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};h.sendRouteBinaryMessage=function(a,c){var b=this.f.get(a);b?(a=b.sendRouteBinaryMessage(a,c),a=ez(this,qi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
h.startListeningForRouteMessages=function(a){var c=this.w;c.f.has(a)||(c.f.add(a),(a=c.b.get(a))&&0<a.length&&Wy(c))};h.stopListeningForRouteMessages=function(a){this.w.stopListeningForRouteMessages(a)};h.detachRoute=function(a){var c=this.f.get(a);c?c.detachRoute(a):this.l.info("Route "+a+" does not exist.")};h.enableMdnsDiscovery=function(){};var kaa=function(a,c,b){return a.g.find(function(d){return d.eg(c,b)})||null},laa=function(a,c,b){return a.g.find(function(d){return d.mf(c,b)})||null};
cz.prototype.N=function(){var a=this;this.j.forEach(function(c){hz(a,c)})};var dz=function(a){a.b.setKeepAlive(0<a.F||0<a.C.length)};h=cz.prototype;h.startObservingMediaRoutes=function(a){this.h.has(a)||(this.h.add(a),this.g.forEach(function(c){c.startObservingMediaRoutes(a)}));this.T.g()};h.stopObservingMediaRoutes=function(a){this.h.delete(a)?this.g.forEach(function(c){c.stopObservingMediaRoutes(a)}):this.l.info("No existing route query "+a)};
h.pm=function(){var a=this;if(0!=this.h.size){var c=[];this.g.forEach(function(b){c=c.concat(b.rd())});this.h.forEach(function(b){var d=[];a.g.forEach(function(e){e.rd().forEach(function(f){!f.qf&&e.mf(b,void 0,f)&&d.push(f.id)})});a.b.onRoutesUpdated(c,b,d)})}};h.Fa=function(){return"ProviderManager"};
h.jb=function(){return[new naa(this.g.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.h),Array.from(this.f,function(a){var c=l(a);a=c.next().value;c=c.next().value;return[a,c.getName()]}),Array.from(this.o),this.u)]};h.ib=function(){var a=Vl(this);if(a){this.j=new Set(a.j);this.h=new Set(a.g);for(var c=l(a.f),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;d=ss(this,d);this.f.set(b,d)}this.o=new Map(a.h);this.u=a.b||null}};h.wi=function(a){return this.f.get(a)};
h.Hf=function(a,c){this.f.set(c.id,a);this.Je(c)};h.vg=function(a){gz(this,a.id);this.f.delete(a.id);var c=this.w,b=a.id;c.f.delete(b);var d=c.b.get(b);d&&(c.b.delete(b),Zy(c,d),Yy(c));this.Je(a)};h.Je=function(){0<this.h.size&&this.T.g()};h.Ci=function(a){var c=this.f.get(a.id);c&&(c.Gh(a.id),0<this.h.size&&this.pm())};h.Td=function(a,c){this.f.has(a)?("string"===typeof c||c instanceof Uint8Array||(c=JSON.stringify(c)),this.w.send(a,c)):this.l.G("Got route message for closed route "+a)};
h.onPresentationConnectionStateChanged=function(a,c){"terminated"==c&&this.w.w();this.b.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.w.w();this.b.onPresentationConnectionClosed(a,c,b)};h.Hh=function(a){this.m.delete(a);var c=this.f.get(a);c&&c.terminateRoute(a)};h.Fh=function(a,c){Gq(this.R,new gaa(a,c))};h.Vc=function(){this.ca.g()};
h.onSinkAvailabilityUpdated=function(a,c){var b=this;if(this.o.get(a.getName())!=c){var d=jz(this);this.o.set(a.getName(),c);a=jz(this);d!=a&&(0==a&&this.N(),this.b.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(e){iz(b,e)}),this.j.clear()))}};var jz=function(a){return Array.from(a.o.values()).reduce(function(c,b){return Math.max(c,b)},0)};cz.prototype.yi=function(){return this.R};cz.prototype.Ke=function(a){this.b.onIssue(a)};
var gz=function(a,c){return a.m.has(c)?ts(a,a.m.get(c)).then(function(b){a.m.delete(c);return b.w()}):Promise.resolve(!1)};cz.prototype.Qi=function(a,c,b,d){var e=this,f=a.Ge(c.sinkId);this.l.info("Starting mirroring using service: "+f);this.m.set(c.id,f);return ri(ts(this,f),function(g){e.u=f;return g.cj(c,c.mediaSource,a.uf(c.sinkId),b,d).catch(function(k){if(k instanceof ti&&3==k.reason)throw new nq(8);throw k;})})};
cz.prototype.yl=function(a,c,b,d,e,f){var g=this,k=this.m.get(c.id);return k?ri(ts(this,k),function(m){g.u=k;return m.dj(c,b,a.uf(c.sinkId),d,e,f)}):pi(Error("Route "+c.id+" is not mirroring"))};cz.prototype.Jf=function(a,c){var b=this.C.indexOf(a),d=0<=b;c&&!d?this.C.push(a):!c&&d&&this.C.splice(b,1);dz(this)};var ss=function(a,c){return a.g.find(function(b){return b.getName()==c})||null};h=cz.prototype;
h.searchSinks=function(a,c,b){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?ss(this,d):null)?d.searchSinks(c,b).then(function(e){return e.id}):Promise.reject(Error("No provider supports "+a))};h.provideSinks=function(a,c){var b=ss(this,a);b?b.provideSinks(c):this.l.error("provideSinks: Provider not found for providerName "+a)};h.updateMediaSinks=function(a){this.j.has(a)||hz(this,a)};
h.createMediaRouteController=function(a,c,b){var d=this,e=this.f.get(a);return e?e.createMediaRouteController(a,c,b).catch(function(f){d.l.error("createMediaRouteController failed: "+f.message);c.close();b.ptr.reset();throw f;}):(a="createMediaRouteController: Provider not found for "+a,this.l.error(a),c.close(),b.ptr.reset(),Promise.reject(Error(a)))};h.onMediaRemoterCreated=function(a,c,b){this.b.onMediaRemoterCreated(a,c,b)};
h.getMediaSinkServiceStatus=function(){return"function"!=typeof this.b.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.b.getMediaSinkServiceStatus()};h.getMirroringServiceHostForTab=function(a,c){this.b.getMirroringServiceHostForTab(a,c)};h.getMirroringServiceHostForDesktop=function(a,c,b){this.b.getMirroringServiceHostForDesktop(a,c,b)};h.getMirroringServiceHostForOffscreenTab=function(a,c,b){this.b.getMirroringServiceHostForOffscreenTab(a,c,b)};
var naa=function(a,c,b,d,e,f){this.j=c;this.g=b;this.f=d;this.h=e;this.b=f};
